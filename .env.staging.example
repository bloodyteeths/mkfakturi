#-------------------------------------------
# InvoiceShelf Staging Environment Configuration
# Domain: staging.facturino.mk
# Purpose: Partner bureau pilot testing environment
#-------------------------------------------

# Application Configuration - Staging
APP_NAME="InvoiceShelf Staging"
APP_ENV=staging
APP_DEBUG=false
APP_URL=https://staging.facturino.mk
APP_TIMEZONE=Europe/Skopje
APP_LOCALE=mk
APP_FALLBACK_LOCALE=en

# Staging Environment Identification
STAGING_MODE=true
STAGING_BANNER=true
STAGING_DEBUG=false

# Staging Domain Configuration
STAGING_APP_DOMAIN=staging.facturino.mk
STAGING_APP_URL=https://staging.facturino.mk
STAGING_APP_NAME="InvoiceShelf Staging"

# Database Configuration - Staging Database
STAGING_DB_CONNECTION=mysql
STAGING_DB_HOST=invoiceshelf_db_staging
STAGING_DB_PORT=3306
STAGING_DB_DATABASE=invoiceshelf_staging
STAGING_DB_USERNAME=invoiceshelf_staging
# Password stored in secrets/staging_db_password.txt

# Cache Configuration - Staging Redis
CACHE_STORE=redis
REDIS_HOST=invoiceshelf_redis_staging
REDIS_PORT=6379
# Password stored in secrets/staging_redis_password.txt

# Session Configuration - Staging Sessions
SESSION_DRIVER=redis
SESSION_LIFETIME=120
SESSION_ENCRYPT=true
SESSION_CONNECTION=session
SESSION_DOMAIN=staging.facturino.mk

# Queue Configuration - Staging Queue
QUEUE_CONNECTION=redis
QUEUE_REDIS_CONNECTION=queue
QUEUE_RETRY_AFTER=90
QUEUE_FAILED_DRIVER=database

# Mail Configuration - Staging Mail (sandbox/testing)
STAGING_MAIL_DRIVER=log
STAGING_MAIL_HOST=localhost
STAGING_MAIL_PORT=1025
STAGING_MAIL_USERNAME=
STAGING_MAIL_ENCRYPTION=
STAGING_MAIL_FROM_ADDRESS=noreply@staging.facturino.mk
STAGING_MAIL_FROM_NAME="InvoiceShelf Staging"

# Security Configuration - Staging
SANCTUM_STATEFUL_DOMAINS=staging.facturino.mk
TRUSTED_PROXIES=*
FORCE_HTTPS=true

# Logging Configuration - Enhanced for staging
LOG_CHANNEL=stack
LOG_LEVEL=debug
LOG_DEPRECATIONS_CHANNEL=single
LOG_SLACK_WEBHOOK_URL=

# Macedonia Specific Configuration
TIMEZONE=Europe/Skopje
PHP_TZ=Europe/Skopje

# OCR Configuration - Staging API Keys
TESSERACT_PATH=/usr/bin/tesseract
TESSERACT_LANGUAGES=eng,mkd
# OCR API key stored in secrets/staging_ocr_api_key.txt

# Bank Integration - Staging/Sandbox Credentials
# Stopanska Bank - Sandbox Environment
STOPANSKA_ENVIRONMENT=sandbox
STOPANSKA_BASE_URL=https://sandbox-api.ob.stb.kibs.mk/xs2a/v1
# Client credentials stored in secrets/staging_stopanska_client_id.txt and staging_stopanska_client_secret.txt

# NLB Bank - Sandbox Environment  
NLB_ENVIRONMENT=sandbox
NLB_BASE_URL=https://developer-ob.nlb.mk/apis/xs2a/v1
# Client credentials stored in secrets/staging_nlb_client_id.txt and staging_nlb_client_secret.txt

# Komercijalna Bank - Sandbox Environment
KOMERCIJALNA_ENVIRONMENT=sandbox
KOMERCIJALNA_BASE_URL=https://sandbox-psd2.kb.mk
# Client credentials stored in secrets/staging_komercijalna_client_id.txt and staging_komercijalna_client_secret.txt

# Payment Gateway Configuration - Paddle Sandbox
PADDLE_ENVIRONMENT=sandbox
PADDLE_VENDOR_ID=
# Paddle credentials stored in secrets/staging_paddle_*.txt files

# XML Signing Configuration - Staging Certificates
MK_XML_ENVIRONMENT=staging
# Certificates stored in secrets/staging_xml_private_key.pem and staging_xml_certificate.pem

# E-faktura Integration - Macedonia Tax Authority Testing
EFAKTURA_ENVIRONMENT=test
EFAKTURA_BASE_URL=https://test-efaktura.ujp.gov.mk
EFAKTURA_PORTAL_URL=https://test-portal.ujp.gov.mk

# Monitoring and Analytics - Staging
TELESCOPE_ENABLED=true
PROMETHEUS_ENABLED=true
SENTRY_DSN=
SENTRY_ENVIRONMENT=staging

# File Storage Configuration - Staging
FILESYSTEM_DISK=local
STAGING_STORAGE_PATH=/data/staging

# Performance Configuration - Staging Optimized
CACHE_PREFIX=staging_invoiceshelf
SESSION_PREFIX=staging_session
REDIS_PREFIX=staging_

# Partner Bureau Configuration
PARTNER_BUREAU_MODE=true
PARTNER_BUREAU_TESTING=true
DEMO_DATA_ENABLED=true

# Rate Limiting - Staging (More Permissive)
THROTTLE_LOGIN_ATTEMPTS=10
THROTTLE_LOGIN_DECAY_MINUTES=5
THROTTLE_API_REQUESTS=150
THROTTLE_API_WINDOW=60

# Backup Configuration - Staging
BACKUP_ENABLED=false
BACKUP_DESTINATION=local
BACKUP_SCHEDULE="0 2 * * *"

# Development/Testing Features
STAGING_TOOLBAR=true
QUERY_DEBUGGING=true
MAIL_PREVIEW=true
FAKE_EMAIL_SENDING=true

# Partner Bureau Demo Configuration
DEMO_COMPANY_COUNT=3
DEMO_INVOICE_COUNT=50
DEMO_CUSTOMER_COUNT=25
DEMO_PARTNER_COUNT=2

# Staging Security Configuration
STAGING_BASIC_AUTH_ENABLED=false
STAGING_IP_WHITELIST=
STAGING_MAINTENANCE_MODE=false

# External Service Configuration - Staging/Test Endpoints
MINIMAX_ENVIRONMENT=test
PANTHEON_ENVIRONMENT=test
CPAY_ENVIRONMENT=test

# Asset Configuration - Staging
MIX_APP_ENV=staging
MIX_APP_URL=https://staging.facturino.mk
MIX_PADDLE_VENDOR_ID=
MIX_PUSHER_APP_KEY=
MIX_PUSHER_APP_CLUSTER=

# Database Optimization - Staging
DB_CONNECTION_TIMEOUT=60
DB_QUERY_TIMEOUT=30
DB_SLOW_QUERY_THRESHOLD=1000

# Memory and Performance - Staging Limits
MEMORY_LIMIT=512M
MAX_EXECUTION_TIME=300
UPLOAD_MAX_FILESIZE=32M
POST_MAX_SIZE=64M

#-------------------------------------------
# Environment Configuration Notes:
#
# 1. All sensitive credentials are stored in Docker secrets
#    Located in: ./secrets/staging_*.txt files
#
# 2. Database and cache are completely separate from production
#    Database: invoiceshelf_staging
#    Redis prefix: staging_
#
# 3. All external services use sandbox/test environments
#    Banks: Sandbox PSD2 APIs
#    Paddle: Sandbox environment
#    E-faktura: Test portal
#
# 4. Enhanced debugging and logging enabled for testing
#    Log level: debug
#    Query debugging: enabled
#    Telescope: enabled
#
# 5. Rate limiting more permissive for partner testing
#    API: 150 requests/minute (vs 100 in production)
#    Login: 10 attempts (vs 5 in production)
#
# 6. Mail configuration uses log driver or local testing
#    No real emails sent from staging environment
#
# 7. Demo data and partner bureau testing features enabled
#    Pre-populated with realistic Macedonia business data
#-------------------------------------------