APP_ENV=local
APP_KEY=base64:kgk/4DW1vEVy7aEvet5FPp5un6PIGe/so8H0mvoUtW0=
APP_DEBUG=true
APP_NAME="InvoiceShelf"
APP_LOG_LEVEL=debug
APP_TIMEZONE=UTC
APP_URL=http://invoiceshelf.test

APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

APP_MAINTENANCE_DRIVER=file
APP_MAINTENANCE_STORE=database

BCRYPT_ROUNDS=12

# Paddle Billing Configuration (NEW Platform - not Paddle Classic)
# For subscription billing and international payments
# Get credentials from: https://vendors.paddle.com/ → Developer Tools → Authentication
# Documentation: https://developer.paddle.com/
PADDLE_SELLER_ID=
PADDLE_API_KEY=
PADDLE_CLIENT_SIDE_TOKEN=
PADDLE_WEBHOOK_SECRET=
PADDLE_RETAIN_KEY=
PADDLE_SANDBOX=true

# Paddle Product IDs (Create these in Paddle Dashboard → Catalog → Products)
# Company Subscription Plans
PADDLE_PRODUCT_FREE=        # Free plan product ID (if using Paddle trial)
PADDLE_PRODUCT_STARTER=     # Starter plan product ID
PADDLE_PRODUCT_STANDARD=    # Standard plan product ID
PADDLE_PRODUCT_BUSINESS=    # Business plan product ID
PADDLE_PRODUCT_MAX=         # Max plan product ID

# Partner (Accountant) Subscription
PADDLE_PRODUCT_PARTNER_PLUS= # Partner Plus (€29/mo) product ID

# Paddle Price IDs (Monthly EUR prices - create in Paddle Dashboard → Catalog → Prices)
# Company Plans - Monthly
PADDLE_PRICE_STARTER_MONTHLY=    # €12/month price ID
PADDLE_PRICE_STANDARD_MONTHLY=   # €29/month price ID
PADDLE_PRICE_BUSINESS_MONTHLY=   # €59/month price ID
PADDLE_PRICE_MAX_MONTHLY=        # €149/month price ID

# Company Plans - Annual (optional - 2 months discount)
PADDLE_PRICE_STARTER_ANNUAL=     # €120/year price ID
PADDLE_PRICE_STANDARD_ANNUAL=    # €290/year price ID
PADDLE_PRICE_BUSINESS_ANNUAL=    # €590/year price ID
PADDLE_PRICE_MAX_ANNUAL=         # €1490/year price ID

# Partner Plus - Monthly
PADDLE_PRICE_PARTNER_PLUS_MONTHLY= # €29/month price ID

# Paddle Checkout Settings
PADDLE_RETURN_URL="${APP_URL}/billing/success"
PADDLE_WEBHOOK_URL="${APP_URL}/api/webhooks/paddle"
CASHIER_CURRENCY=EUR
CASHIER_CURRENCY_LOCALE=mk_MK

# Vite Environment Variables (for frontend)
VITE_PADDLE_CLIENT_TOKEN="${PADDLE_CLIENT_SIDE_TOKEN}"
VITE_PADDLE_SANDBOX="${PADDLE_SANDBOX}"

DB_CONNECTION=sqlite
DB_HOST=
DB_PORT=
DB_DATABASE=
DB_USERNAME=
DB_PASSWORD=

BROADCAST_CONNECTION=log

# ==============================================================================
# CACHE, QUEUE, AND SESSION CONFIGURATION
# ==============================================================================
# Performance optimization: Use Redis when available for best performance
# Fallback to database: Works without Redis, good for low-medium traffic
# Production recommendation: Enable Redis for high-traffic deployments

# Cache Configuration
# Options: file, database, redis
# database = good fallback, redis = best performance
CACHE_STORE=database
# CACHE_STORE=redis

# Queue Configuration
# sync: Process jobs immediately (development only, NOT for production!)
# database: Database queue (RECOMMENDED - no Redis needed, good for low-medium volume)
# redis: Redis queue (best for high volume and performance)
QUEUE_CONNECTION=database
# QUEUE_CONNECTION=redis

# For local development testing only:
# QUEUE_CONNECTION=sync

# Session Configuration
# Options: file, cookie, database, redis
# database = good for single server, redis = best for multiple servers/high traffic
SESSION_DRIVER=database
# SESSION_DRIVER=redis
SESSION_LIFETIME=1440
SESSION_ENCRYPT=false
SESSION_PATH=/
SESSION_DOMAIN=null
# SESSION_STORE=redis (only used when SESSION_DRIVER=redis)
# SESSION_CONNECTION=session (Redis connection name for sessions)

# ==============================================================================
# REDIS CONFIGURATION (OPTIONAL)
# ==============================================================================
# Redis provides improved performance when available but is NOT required
# Application works perfectly with database fallbacks for cache/queue/sessions
#
# When to enable Redis:
# - High traffic production deployments
# - Multiple application servers (load balanced)
# - Need for fast cache/session/queue performance
#
# To enable Redis:
# 1. Ensure Redis server is running
# 2. Set CACHE_STORE=redis, QUEUE_CONNECTION=redis, SESSION_DRIVER=redis
# 3. Configure connection details below

REDIS_CLIENT=predis
REDIS_HOST=127.0.0.1
REDIS_PASSWORD=null
REDIS_PORT=6379
REDIS_DB=0
REDIS_CACHE_DB=1
REDIS_SESSION_DB=2
REDIS_QUEUE_DB=3
REDIS_PREFIX=facturino_
# REDIS_URL=redis://127.0.0.1:6379
# REDIS_USERNAME=

# For Railway/cloud platforms, these are automatically set when you add Redis service
# ==============================================================================
# END REDIS CONFIGURATION
# ==============================================================================
# CLAUDE-CHECKPOINT

MAIL_DRIVER=smtp
MAIL_HOST=
MAIL_PORT=
MAIL_USERNAME=
MAIL_PASSWORD=
MAIL_ENCRYPTION=

MAIL_FROM_NAME=
MAIL_FROM_ADDRESS=

PUSHER_APP_ID=
PUSHER_KEY=
PUSHER_SECRET=

SANCTUM_STATEFUL_DOMAINS=invoiceshelf.test
TRUSTED_PROXIES="*"

CRON_JOB_AUTH_TOKEN=""
LOG_STACK=single

PDF_DRIVER=dompdf
GOTENBERG_HOST=
GOTENBERG_PAPERSIZE=

# OCR Configuration (for OCR-01 receipt processing)
# Option 1: Self-hosted Tesseract (recommended for Hetzner deployment)
TESSERACT_PATH=/usr/bin/tesseract
TESSERACT_LANGUAGES=eng,mkd

# Option 2: OCR.space API (pay-per-use, GDPR compliant EU servers)
OCR_SPACE_API_KEY=

# Fiscal QR decoding
FISCAL_QR_MAX_RETRIES=2
OCR_SPACE_ENDPOINT=https://api.ocr.space/parse/image

# Option 3: Google Cloud Vision (if needed for complex documents)
GOOGLE_CLOUD_PROJECT_ID=
GOOGLE_CLOUD_KEY_FILE=
GOOGLE_CLOUD_VISION_ENDPOINT=

# PSD2 Banking Integration Configuration
# Stopanska Banka AD Skopje - Macedonia's largest bank
# Developer Portal: https://ob.stb.kibs.mk/docs/getting-started
# Rate Limit: 15 requests per minute (4 second intervals)

# Stopanska Bank OAuth2 Credentials (Client Credentials Flow)
STOPANSKA_CLIENT_ID=
STOPANSKA_CLIENT_SECRET=
STOPANSKA_ENVIRONMENT=sandbox

# Stopanska Sandbox Configuration (for development/testing)
STOPANSKA_SANDBOX_BASE_URL=https://sandbox-api.ob.stb.kibs.mk/xs2a/v1
STOPANSKA_SANDBOX_OAUTH_URL=https://sandbox-api.ob.stb.kibs.mk/xs2a/v1/oauth2/token
STOPANSKA_SANDBOX_ACCOUNTS_URL=https://sandbox-api.ob.stb.kibs.mk/xs2a/v1/accounts
STOPANSKA_SANDBOX_TRANSACTIONS_URL=https://sandbox-api.ob.stb.kibs.mk/xs2a/v1/accounts/{account-id}/transactions

# Stopanska Production Configuration (for live deployment)
STOPANSKA_PRODUCTION_BASE_URL=https://api.ob.stb.kibs.mk/xs2a/v1
STOPANSKA_PRODUCTION_OAUTH_URL=https://api.ob.stb.kibs.mk/xs2a/v1/oauth2/token
STOPANSKA_PRODUCTION_ACCOUNTS_URL=https://api.ob.stb.kibs.mk/xs2a/v1/accounts
STOPANSKA_PRODUCTION_TRANSACTIONS_URL=https://api.ob.stb.kibs.mk/xs2a/v1/accounts/{account-id}/transactions

# Stopanska Account Configuration
STOPANSKA_DEFAULT_ACCOUNT_ID=
STOPANSKA_RATE_LIMIT_ENABLED=true
STOPANSKA_MAX_TRANSACTIONS_PER_REQUEST=200

# Test Account Credentials (sandbox only)
STOPANSKA_SANDBOX_TEST_ACCOUNT_IBAN=MK07290000000000001
STOPANSKA_SANDBOX_TEST_ACCOUNT_ID=STB_SANDBOX_001

# NLB Banka (Nova Ljubljanska Banka) - Second largest bank
# Developer Portal: https://developer-ob.nlb.mk/
NLB_CLIENT_ID=
NLB_CLIENT_SECRET=
NLB_ENVIRONMENT=sandbox

# Komercijalna Banka - Third major bank for PSD2 integration
KOMERCIJALNA_CLIENT_ID=
KOMERCIJALNA_CLIENT_SECRET=
KOMERCIJALNA_ENVIRONMENT=sandbox

# AI Financial Assistant
AI_MCP_URL=http://ai-mcp:3001

# ==============================================================================
# CPAY PAYMENT GATEWAY CONFIGURATION (CASYS)
# ==============================================================================
# CPAY is a Macedonian payment gateway for domestic MKD payments
# Provider: CASYS Payment Solutions - https://cpay.com.mk/
# Used for invoice payment processing with credit/debit cards
# Requires merchant account setup with CPAY

# CPAY Merchant Credentials
CPAY_MERCHANT_ID=
CPAY_SECRET_KEY=

# CPAY API Endpoints
CPAY_PAYMENT_URL=https://cpay.com.mk/payment

# CPAY Return URLs (these are set automatically by the application)
# Success URL: {APP_URL}/cpay/success/{invoice_id}
# Cancel URL: {APP_URL}/cpay/cancel/{invoice_id}
# Callback URL: {APP_URL}/webhooks/cpay/callback

# ==============================================================================
# FAKTURINO FEATURE FLAGS (Laravel Pennant)
# ==============================================================================
# All features default to OFF for safety until enabled in production.
# Only flip flags after proper testing in staging environment.

# Accounting Backbone (eloquent-ifrs double-entry ledger integration)
# When ON: Invoice/Payment events post to IFRS ledger automatically
FEATURE_ACCOUNTING_BACKBONE=false

# Migration Wizard (Laravel Excel CSV/XLSX imports with Onivo/Megasoft presets)
# When ON: Import wizard available at /admin/migration
FEATURE_MIGRATION_WIZARD=false

# PSD2 Banking (OAuth + encrypted tokens + MT940 fallback)
# When ON: Bank connection endpoints available, sync jobs active
FEATURE_PSD2_BANKING=false

# Partner Portal (Referral tracking and commission APIs)
# When ON: Partner APIs available with real data
FEATURE_PARTNER_PORTAL=false

# Stock Management V1 (Warehouse & Item tracking)
# When ON: Warehouse and item management features available
FACTURINO_STOCK_V1_ENABLED=false

# Partner Commission Configuration
# Default commission rate for partners (percentage, e.g., 5.0 = 5%)
PARTNER_COMMISSION_RATE=5.0

# ==============================================================================
# STRIPE PAYMENT CONFIGURATION
# ==============================================================================
# Stripe is used for:
# 1. Company subscription billing (Starter, Standard, Business, Max tiers)
# 2. Partner payouts via Stripe Connect (cross-border to Macedonia)
#
# Get credentials from: https://dashboard.stripe.com/apikeys
# Documentation: https://stripe.com/docs

# Stripe API Keys
STRIPE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxx
STRIPE_SECRET=sk_test_xxxxxxxxxxxxxxxxxxxx

# Stripe Webhook Secret (from Dashboard → Developers → Webhooks)
# Webhook URL: https://app.facturino.mk/api/v1/webhooks/stripe
STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxx
STRIPE_WEBHOOK_TOLERANCE=300

# Stripe Price IDs (create in Dashboard → Products → Prices)
# Company Subscription Plans - Monthly (MKD currency)
STRIPE_PRICE_STARTER_MKD_MONTHLY=price_xxxxx
STRIPE_PRICE_STARTER_MKD_YEARLY=price_xxxxx
STRIPE_PRICE_STANDARD_MKD_MONTHLY=price_xxxxx
STRIPE_PRICE_STANDARD_MKD_YEARLY=price_xxxxx
STRIPE_PRICE_BUSINESS_MKD_MONTHLY=price_xxxxx
STRIPE_PRICE_BUSINESS_MKD_YEARLY=price_xxxxx
STRIPE_PRICE_MAX_MKD_MONTHLY=price_xxxxx
STRIPE_PRICE_MAX_MKD_YEARLY=price_xxxxx

# Stripe Connect (for partner payouts)
STRIPE_CONNECT_CLIENT_ID=ca_xxxxxxxxxxxxxxxxxxxx

# Advanced Payments (Paddle + CPAY integrations with webhooks)
# When ON: Payment gateway checkout URLs and webhooks active
FEATURE_ADVANCED_PAYMENTS=false

# MCP AI Tools (TypeScript MCP server with UBL validation, tax explanations)
# When ON: MCP tools accessible, audit logging active
FEATURE_MCP_AI_TOOLS=false

# Monitoring (Prometheus metrics + Telescope debugging interface)
# When ON: /metrics and /telescope endpoints available (admin only)
FEATURE_MONITORING=false

# ==============================================================================
# END FEATURE FLAGS
# ==============================================================================

# ==============================================================================
# MCP AI TOOLS SERVER CONFIGURATION
# ==============================================================================
# Model Context Protocol (MCP) Server for AI-powered financial tools
# TypeScript server providing UBL validation, tax explanations, anomaly detection
# Default: localhost:3100 for local development, adjust for production deployment

# MCP Server Feature Flag Control
# Must match FEATURE_MCP_AI_TOOLS flag above
FEATURE_MCP_AI_TOOLS=false

# MCP Server Connection
MCP_SERVER_TOKEN=
MCP_SERVER_URL=http://localhost:3100

# Laravel Internal URL (for MCP server to call back)
# Used by MCP server to fetch invoice/accounting data via internal API
LARAVEL_INTERNAL_URL=http://localhost:8080

# ==============================================================================
# END MCP CONFIGURATION
# ==============================================================================

# ==============================================================================
# PHASE 3: BANKING & RECONCILIATION
# ==============================================================================

# PSD2 Gateway Service
# Internal service that handles PSD2 OAuth flows and token management
PSD2_GATEWAY_BASE_URL=http://psd2-gateway:8080
PSD2_REDIRECT_URI=${APP_URL}/api/v1/bank/oauth/callback

# Reconciliation Settings
# Auto-match tolerance for transaction reconciliation (in days)
RECONCILIATION_DATE_TOLERANCE=3

# Invoice2Data Microservice (invoice parsing)
INVOICE2DATA_URL=http://invoice2data-service:8000
INVOICE2DATA_TIMEOUT=30

# ==============================================================================
# PHASE 4: EXPORTS & WEBHOOKS
# ==============================================================================

# Export Configuration
# Disk to use for export file storage (local, s3, etc.)
EXPORT_DISK=local
# Number of days to retain export files before automatic cleanup
EXPORT_RETENTION_DAYS=7

# Webhook Event Storage
# Retention period for webhook event logs (in days)
WEBHOOK_RETENTION_DAYS=30

# Recurring Expense Processing
# How often to check for due recurring expenses (in minutes)
RECURRING_EXPENSE_CHECK_INTERVAL=60

# ==============================================================================
# INTELLIGENT IMPORT SYSTEM
# ==============================================================================
# Advanced CSV/XLSX import with intelligent field mapping, multi-language
# support, fuzzy matching, and automatic data type detection
# Default: disabled for safe rollout, enable after testing

# Master Feature Toggle
# When ON: Use intelligent import system with AI-powered field mapping
# When OFF: Use legacy manual mapping interface
INTELLIGENT_IMPORT_ENABLED=false

# Confidence Threshold
# Minimum confidence score (0.0-1.0) required for automatic field mapping
# Lower values = more aggressive auto-mapping, higher risk of mistakes
# Higher values = more conservative, may require manual review
# Recommended: 0.60 (60% confidence)
INTELLIGENT_IMPORT_MIN_CONFIDENCE=0.60

# Fallback to Legacy System
# When ON: If intelligent mapping fails, fall back to legacy manual mapping
# When OFF: Return error if intelligent mapping fails
# Recommended: true for smooth user experience
INTELLIGENT_IMPORT_FALLBACK=true

# Import System Logging
# When ON: Log all import operations, field mappings, and confidence scores
# Useful for debugging and improving mapping accuracy
# Recommended: true for production monitoring
INTELLIGENT_IMPORT_LOGGING=true

# ==============================================================================
# END INTELLIGENT IMPORT CONFIGURATION
# ==============================================================================

# ==============================================================================
# BACKUP CONFIGURATION
# ==============================================================================
# Automated backup system using Spatie Laravel Backup
# Backs up database and critical files daily at 2:00 AM
# Monitors backup health every 6 hours

# Backup Notification Email
# Email address to receive backup status notifications
# Alerts sent for: backup failures, unhealthy backups, cleanup failures
BACKUP_NOTIFICATION_EMAIL=admin@facturino.mk

# Backup Archive Password (optional)
# Set to encrypt backup archives with a password
# Leave empty to disable encryption
BACKUP_ARCHIVE_PASSWORD=

# AWS S3 Configuration for Backups
# Create S3 bucket in eu-central-1 (Frankfurt) for GDPR compliance
# Bucket name: facturino-backups (or your preferred name)
# IAM policy: PutObject, GetObject, DeleteObject, ListBucket on bucket
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=eu-central-1
AWS_BACKUP_BUCKET=facturino-backups
AWS_USE_PATH_STYLE_ENDPOINT=false

# ==============================================================================
# END BACKUP CONFIGURATION
# ==============================================================================
