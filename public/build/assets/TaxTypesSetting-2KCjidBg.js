import{ax as q,u as G,v as F,aN as z,N as K,n as Q,O,G as j,a7 as L,r as o,K as y,o as r,w as t,L as P,a as s,l as m,V as B,q as _,t as f,F as J,aO as W,e as M,j as D,a8 as V,M as Z,c as N,Q as Y}from"./main-Bq1VlIEV.js";import{_ as ee}from"./TaxTypeModal-DG8QBGK8.js";const te={__name:"TaxTypeIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(b){const n=b,g=q();G();const{t:p}=F.useI18n(),h=z(),T=K(),E=Q(),i=O(),C=j();L("utils");async function k(l){await h.fetchTaxType(l),C.openModal({title:p("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:n.loadData&&n.loadData})}function w(l){g.openDialog({title:p("general.are_you_sure"),message:p("settings.tax_types.confirm_delete"),yesLabel:p("general.ok"),noLabel:p("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async c=>{if(c){if((await h.deleteTaxType(l)).data.success)return n.loadData&&n.loadData(),!0;n.loadData&&n.loadData()}})}function I(){E.push({name:"vat.return"})}return(l,c)=>{const u=o("BaseIcon"),$=o("BaseButton"),S=o("BaseDropdownItem"),e=o("BaseDropdown");return r(),y(e,null,{activator:t(()=>[m(T).name==="tax-types.view"?(r(),y($,{key:0,variant:"primary"},{default:t(()=>[s(u,{name:"EllipsisHorizontalIcon",class:"h-5 text-white"})]),_:1})):(r(),y(u,{key:1,name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"}))]),default:t(()=>[m(i).hasAbilities(m(B).EDIT_TAX_TYPE)?(r(),y(S,{key:0,onClick:c[0]||(c[0]=d=>k(b.row.id))},{default:t(()=>[s(u,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),_(" "+f(l.$t("general.edit")),1)]),_:1})):P("",!0),s(S,{onClick:I},{default:t(()=>[s(u,{name:"DocumentTextIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),_(" "+f(l.$t("vat.generate_return")),1)]),_:1}),m(i).hasAbilities(m(B).DELETE_TAX_TYPE)?(r(),y(S,{key:1,onClick:c[1]||(c[1]=d=>w(b.row.id))},{default:t(()=>[s(u,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),_(" "+f(l.$t("general.delete")),1)]),_:1})):P("",!0)]),_:1})}}},ae={key:0},oe={__name:"TaxTypesSetting",setup(b){const{t:n}=F.useI18n();L("utils");const g=J(),p=z(),h=j(),T=O(),E=W(),i=M(null),C=M(g.selectedCompanySettings.tax_per_item),k=D(()=>g.selectedCompanyCurrency),w=D(()=>[{key:"name",label:n("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"calculation_type",label:n("settings.tax_types.calculation_type"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"amount",label:n("settings.tax_types.amount"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),I=D(()=>g.selectedCompanySettings.sales_tax_us_enabled==="YES"&&E.salesTaxUSEnabled),l=D({get:()=>C.value==="YES",set:async e=>{const d=e?"YES":"NO";let x={settings:{tax_per_item:d}};C.value=d,await g.updateCompanySettings({data:x,message:"general.setting_updated"})}});function c(){return T.hasAbilities([B.DELETE_TAX_TYPE,B.EDIT_TAX_TYPE])}async function u({page:e,filter:d,sort:x}){let A={orderByField:x.fieldName||"created_at",orderBy:x.order||"desc",page:e},v=await p.fetchTaxTypes(A);return{data:v.data.data,pagination:{totalPages:v.data.meta.last_page,currentPage:e,totalCount:v.data.meta.total,limit:5}}}async function $(){i.value&&i.value.refresh()}function S(){h.openModal({title:n("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:i.value&&i.value.refresh})}return(e,d)=>{const x=o("BaseIcon"),A=o("BaseButton"),v=o("BaseFormatMoney"),X=o("BaseTable"),R=o("BaseDivider"),U=o("BaseSwitchSection"),H=o("BaseSettingCard");return r(),y(H,{title:e.$t("settings.tax_types.title"),description:e.$t("settings.tax_types.description")},V({default:t(()=>[s(ee),s(X,{ref_key:"table",ref:i,class:"mt-16",data:u,columns:w.value},V({"cell-calculation_type":t(({row:a})=>[_(f(e.$t(`settings.tax_types.${a.data.calculation_type}`)),1)]),"cell-amount":t(({row:a})=>[a.data.calculation_type==="percentage"?(r(),N(Y,{key:0},[_(f(a.data.percent)+" % ",1)],64)):a.data.calculation_type==="fixed"?(r(),y(v,{key:1,amount:a.data.fixed_amount,currency:k.value},null,8,["amount","currency"])):(r(),N(Y,{key:2},[_(" - ")],64))]),_:2},[c()?{name:"cell-actions",fn:t(({row:a})=>[s(te,{row:a.data,table:i.value,"load-data":$},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"]),m(T).currentUser.is_owner?(r(),N("div",ae,[s(R,{class:"mt-8 mb-2"}),s(U,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=a=>l.value=a),disabled:I.value,title:e.$t("settings.tax_types.tax_per_item"),description:e.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"])])):P("",!0)]),_:2},[m(T).hasAbilities(m(B).CREATE_TAX_TYPE)?{name:"action",fn:t(()=>[s(A,{type:"submit",variant:"primary-outline",onClick:S},{left:t(a=>[s(x,{class:Z(a.class),name:"PlusIcon"},null,8,["class"])]),default:t(()=>[_(" "+f(e.$t("settings.tax_types.add_new_tax")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"])}}};export{oe as default};
