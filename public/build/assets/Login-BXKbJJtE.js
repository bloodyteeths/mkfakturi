import{u as D,d as k,v as L,e as w,f,g as $,h as M,i as N,j as _,k as C,c as E,a as i,b as h,w as d,l as e,m as R,r as m,n as j,o as G,p as T,q as y,t as b,s as U}from"./main-C3HD31Qx.js";const A={class:"mt-5 mb-8"},F={class:"mb-4"},H={__name:"Login",setup(P){const B=D(),t=k(),{t:c}=L.useI18n(),v=j(),p=w(!1);let r=w(!1);const I={email:{required:f.withMessage(c("validation.required"),$),email:f.withMessage(c("validation.email_incorrect"),M)},password:{required:f.withMessage(c("validation.required"),$)}},a=N(I,_(()=>t.loginData)),V=_(()=>r.value?"text":"password");async function S(){var n,o;if(U.defaults.withCredentials=!0,a.value.$touch(),a.value.$invalid)return!0;p.value=!0;try{const s=await t.login(t.loginData);if(!s||!s.data){p.value=!1;return}const l=(n=s.data)==null?void 0:n.user,g=l==null?void 0:l.role;B.showNotification({type:"success",message:"Logged in successfully."}),g==="partner"?v.push({name:"partner.dashboard"}):v.push("/admin/dashboard")}catch(s){p.value=!1,console.error("Login error:",s),console.error("Login error response:",s.response),console.error("Login error data:",(o=s.response)==null?void 0:o.data)}}return C(()=>{window.demo_mode&&(t.loginData.email="demo@invoiceshelf.com",t.loginData.password="demo")}),(n,o)=>{const s=m("BaseInput"),l=m("BaseInputGroup"),g=m("BaseIcon"),q=m("router-link"),x=m("BaseButton");return G(),E("form",{id:"loginForm",class:"mt-12 text-left",onSubmit:R(S,["prevent"])},[i(l,{error:e(a).email.$error&&e(a).email.$errors[0].$message,label:n.$t("login.email"),class:"mb-4",required:""},{default:d(()=>[i(s,{modelValue:e(t).loginData.email,"onUpdate:modelValue":o[0]||(o[0]=u=>e(t).loginData.email=u),invalid:e(a).email.$error,focus:"",type:"email",name:"email",onInput:o[1]||(o[1]=u=>e(a).email.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["error","label"]),i(l,{error:e(a).password.$error&&e(a).password.$errors[0].$message,label:n.$t("login.password"),class:"mb-4",required:""},{default:d(()=>[i(s,{modelValue:e(t).loginData.password,"onUpdate:modelValue":o[3]||(o[3]=u=>e(t).loginData.password=u),invalid:e(a).password.$error,type:V.value,name:"password",onInput:o[4]||(o[4]=u=>e(a).password.$touch())},{right:d(()=>[i(g,{name:e(r)?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:o[2]||(o[2]=u=>T(r)?r.value=!e(r):r=!e(r))},null,8,["name"])]),_:1},8,["modelValue","invalid","type"])]),_:1},8,["error","label"]),h("div",A,[h("div",F,[i(q,{to:"forgot-password",class:"text-sm text-primary-400 hover:text-gray-700"},{default:d(()=>[y(b(n.$t("login.forgot_password")),1)]),_:1})])]),i(x,{loading:p.value,type:"submit"},{default:d(()=>[y(b(n.$t("login.login")),1)]),_:1},8,["loading"])],32)}}};export{H as default};
