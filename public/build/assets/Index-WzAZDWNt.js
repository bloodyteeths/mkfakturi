import{v as ue,ax as de,e as B,j as O,P,k as pe,K as f,w as l,r as n,n as me,o as g,a as s,ag as C,q as p,t as r,M as m,aB as $,l as _,b as i,L as D,c as M,Q as ge,R as _e,aA as he}from"./main-rC5xHABW.js";import{u as ke}from"./ticket-C77r0nOx.js";const be={class:"relative table-container"},fe={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},ye={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},ve={class:"block md:hidden mt-4 space-y-4"},Be=["onClick"],Ce={class:"flex items-start justify-between mb-2"},$e={class:"text-base font-semibold text-gray-900 flex-1"},we={class:"text-sm text-gray-600 mb-3 line-clamp-2"},xe={class:"flex items-center justify-between text-xs text-gray-500"},Te={class:"flex items-center space-x-3"},Ie={key:0,class:"flex items-center"},Ve={class:"hidden md:block"},Pe={class:"flex items-center text-gray-600"},De={class:"text-sm text-gray-600"},Se={__name:"Index",setup(Me){const{t:a}=ue.useI18n();me();const c=ke(),F=de(),y=B(!1),h=B(1),w=B([]),u=B({status:"",priority:"",search:""}),R=[{label:a("tickets.open"),value:"open"},{label:a("tickets.in_progress"),value:"in_progress"},{label:a("tickets.resolved"),value:"resolved"},{label:a("tickets.closed"),value:"closed"}],W=[{label:a("tickets.low"),value:"low"},{label:a("tickets.normal"),value:"normal"},{label:a("tickets.high"),value:"high"},{label:a("tickets.urgent"),value:"urgent"}],q=[{key:"select",thClass:"w-12"},{key:"title",label:a("tickets.title"),thClass:"min-w-[300px]"},{key:"status",label:a("tickets.status"),thClass:"w-32"},{key:"priority",label:a("tickets.priority"),thClass:"w-32"},{key:"messages_count",label:a("tickets.replies"),thClass:"w-24 text-center"},{key:"created_at",label:a("general.created_at"),thClass:"w-40"},{key:"actions",label:"",thClass:"w-20"}],L=O(()=>!c.ticketTotalCount&&!c.isFetchingTickets),A=O(()=>Math.ceil(c.ticketTotalCount/25)),K=()=>{y.value=!y.value},Q=()=>{u.value={status:"",priority:"",search:""},k()},X=e=>{u.value.status=e,k()},k=()=>{h.value=1,x()},x=async()=>{var o;const e={page:h.value,limit:25,status:u.value.status||void 0,priority:((o=u.value.priority)==null?void 0:o.value)||void 0,search:u.value.search||void 0};await c.fetchTickets(e)},J=e=>{F.openDialog({title:a("general.are_you_sure"),message:a("tickets.confirm_delete"),yesLabel:a("general.yes"),noLabel:a("general.no")}).then(o=>{o&&c.deleteTicket(e).then(()=>{k()})})},Z=()=>{F.openDialog({title:a("general.are_you_sure"),message:a("tickets.confirm_delete_multiple"),yesLabel:a("general.yes"),noLabel:a("general.no")}).then(e=>{e&&c.deleteMultipleTickets(c.selectedTickets).then(()=>{k()})})},S=e=>{const o={open:"bg-blue-100 text-blue-800",in_progress:"bg-yellow-100 text-yellow-800",resolved:"bg-green-100 text-green-800",closed:"bg-gray-100 text-gray-800"};return o[e]||o.open},E=e=>{const o={low:"bg-gray-100 text-gray-800",normal:"bg-blue-100 text-blue-800",high:"bg-orange-100 text-orange-800",urgent:"bg-red-100 text-red-800"};return o[e]||o.normal},j=e=>a(e?`tickets.${e}`:"tickets.open"),G=e=>a(e?`tickets.${e}`:"tickets.normal"),U=e=>he(e).format("MMM DD, YYYY");return P(w,e=>{c.selectTicket(e)}),P(()=>u.value.search,()=>{k()}),P(h,()=>{x()}),pe(()=>{x()}),(e,o)=>{const N=n("BaseBreadcrumbItem"),ee=n("BaseBreadcrumb"),d=n("BaseIcon"),T=n("BaseButton"),Y=n("router-link"),te=n("BasePageHeader"),H=n("BaseMultiselect"),I=n("BaseInputGroup"),se=n("BaseInput"),le=n("BaseFilterWrapper"),ae=n("BaseEmptyPlaceholder"),b=n("BaseTab"),oe=n("BaseTabGroup"),V=n("BaseDropdownItem"),z=n("BaseDropdown"),ne=n("BaseCheckbox"),re=n("BaseTable"),ie=n("BasePagination"),ce=n("BasePage");return g(),f(ce,null,{default:l(()=>[s(te,{title:e.$t("tickets.title")},{actions:l(()=>[C(s(T,{variant:"primary-outline",onClick:K},{right:l(t=>[y.value?(g(),f(d,{key:1,name:"XMarkIcon",class:m(t.class)},null,8,["class"])):(g(),f(d,{key:0,name:"FunnelIcon",class:m(t.class)},null,8,["class"]))]),default:l(()=>[p(r(e.$t("general.filter"))+" ",1)]),_:1},512),[[$,_(c).ticketTotalCount]]),s(Y,{to:"support/create"},{default:l(()=>[s(T,{variant:"primary",class:"ml-4"},{left:l(t=>[s(d,{name:"PlusIcon",class:m(t.class)},null,8,["class"])]),default:l(()=>[p(" "+r(e.$t("tickets.new_ticket")),1)]),_:1})]),_:1})]),default:l(()=>[s(ee,null,{default:l(()=>[s(N,{title:e.$t("general.home"),to:"dashboard"},null,8,["title"]),s(N,{title:e.$t("tickets.ticket",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),C(s(le,{"row-on-xl":!0,onClear:Q},{default:l(()=>[s(I,{label:e.$t("tickets.status")},{default:l(()=>[s(H,{modelValue:u.value.status,"onUpdate:modelValue":o[0]||(o[0]=t=>u.value.status=t),options:R,searchable:"",placeholder:e.$t("general.select_a_status")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(I,{label:e.$t("tickets.priority")},{default:l(()=>[s(H,{modelValue:u.value.priority,"onUpdate:modelValue":o[1]||(o[1]=t=>u.value.priority=t),options:W,searchable:"",placeholder:e.$t("tickets.select_priority")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(I,{label:e.$t("general.search")},{default:l(()=>[s(se,{modelValue:u.value.search,"onUpdate:modelValue":o[2]||(o[2]=t=>u.value.search=t),placeholder:e.$t("tickets.search_placeholder")},{left:l(t=>[s(d,{name:"MagnifyingGlassIcon",class:m(t.class)},null,8,["class"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},512),[[$,y.value]]),C(s(ae,{title:e.$t("tickets.no_tickets"),description:e.$t("tickets.list_of_tickets")},{actions:l(()=>[s(T,{variant:"primary-outline",onClick:o[3]||(o[3]=t=>e.$router.push("/admin/support/create"))},{left:l(t=>[s(d,{name:"PlusIcon",class:m(t.class)},null,8,["class"])]),default:l(()=>[p(" "+r(e.$t("tickets.create_new_ticket")),1)]),_:1})]),_:1},8,["title","description"]),[[$,L.value]]),C(i("div",be,[i("div",fe,[s(oe,{class:"-mb-5",onChange:X},{default:l(()=>[s(b,{title:e.$t("general.all"),filter:""},null,8,["title"]),s(b,{title:e.$t("tickets.open"),filter:"open"},null,8,["title"]),s(b,{title:e.$t("tickets.in_progress"),filter:"in_progress"},null,8,["title"]),s(b,{title:e.$t("tickets.resolved"),filter:"resolved"},null,8,["title"]),s(b,{title:e.$t("tickets.closed"),filter:"closed"},null,8,["title"])]),_:1}),_(c).selectedTickets.length?(g(),f(z,{key:0,class:"absolute float-right"},{activator:l(()=>[i("span",ye,[p(r(e.$t("general.actions"))+" ",1),s(d,{name:"ChevronDownIcon",class:"h-5"})])]),default:l(()=>[s(V,{onClick:Z},{default:l(()=>[s(d,{name:"TrashIcon",class:"h-5 mr-3 text-gray-600"}),p(" "+r(e.$t("general.delete")),1)]),_:1})]),_:1})):D("",!0)]),i("div",ve,[(g(!0),M(ge,null,_e(_(c).tickets,t=>(g(),M("div",{key:t.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 cursor-pointer",onClick:v=>e.$router.push(`/admin/support/${t.id}`)},[i("div",Ce,[i("h3",$e,r(t.title),1),i("span",{class:m([S(t.status),"ml-2 px-2 py-1 text-xs font-medium rounded-full whitespace-nowrap"])},r(j(t.status)),3)]),i("p",we,r(t.message),1),i("div",xe,[i("div",Te,[i("span",{class:m([E(t.priority),"px-2 py-1 rounded-full font-medium"])},r(G(t.priority)),3),t.messages_count?(g(),M("span",Ie,[s(d,{name:"ChatBubbleLeftIcon",class:"h-4 w-4 mr-1"}),p(" "+r(t.messages_count),1)])):D("",!0)]),i("span",null,r(U(t.created_at)),1)])],8,Be))),128))]),i("div",Ve,[s(re,{ref:"table",data:_(c).tickets,columns:q,class:"mt-3"},{"cell-select":l(({row:t})=>[s(ne,{id:t.id,modelValue:w.value,"onUpdate:modelValue":o[4]||(o[4]=v=>w.value=v),value:t.id},null,8,["id","modelValue","value"])]),"cell-title":l(({row:t})=>[s(Y,{to:`/admin/support/${t.id}`,class:"font-medium text-primary-500 hover:text-primary-600"},{default:l(()=>[p(r(t.title),1)]),_:2},1032,["to"])]),"cell-status":l(({row:t})=>[i("span",{class:m([S(t.status),"px-2 py-1 text-xs font-medium rounded-full"])},r(j(t.status)),3)]),"cell-priority":l(({row:t})=>[i("span",{class:m([E(t.priority),"px-2 py-1 text-xs font-medium rounded-full"])},r(G(t.priority)),3)]),"cell-messages_count":l(({row:t})=>[i("div",Pe,[s(d,{name:"ChatBubbleLeftIcon",class:"h-4 w-4 mr-1"}),p(" "+r(t.messages_count||0),1)])]),"cell-created_at":l(({row:t})=>[i("span",De,r(U(t.created_at)),1)]),"cell-actions":l(({row:t})=>[s(z,null,{activator:l(()=>[s(d,{name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500 cursor-pointer"})]),default:l(()=>[s(V,{onClick:v=>e.$router.push(`/admin/support/${t.id}`)},{default:l(()=>[s(d,{name:"EyeIcon",class:"h-5 mr-3 text-gray-600"}),p(" "+r(e.$t("general.view")),1)]),_:2},1032,["onClick"]),s(V,{onClick:v=>J(t.id)},{default:l(()=>[s(d,{name:"TrashIcon",class:"h-5 mr-3 text-gray-600"}),p(" "+r(e.$t("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data"])]),_(c).ticketTotalCount>0?(g(),f(ie,{key:0,modelValue:h.value,"onUpdate:modelValue":o[5]||(o[5]=t=>h.value=t),"total-pages":A.value,"total-count":_(c).ticketTotalCount,"per-page":25,class:"mt-6"},null,8,["modelValue","total-pages","total-count"])):D("",!0)],512),[[$,!L.value]])]),_:1})}}};export{Se as default};
