import{D as ve,_ as fe,a as pe}from"./EstimateIcon-lRXRuUtn.js";import{_ as ye}from"./CustomerIcon-BCdmRGWT.js";import{a0 as H,r as T,K as B,o,w as k,b as e,a as r,a4 as be,t,a5 as ue,M as E,a6 as xe,s as K,a7 as me,F as ne,O as J,c as d,L as S,l,V,q as j,v as Y,e as I,P as ee,j as M,a8 as le,k as z,a9 as de,aa as oe,Q as F,R as U,ab as _e,ac as he,ad as X,ae as ce,af as we,a1 as Z,m as $e,ag as ke,ah as De,ai as Ce,aj as se,ak as Ie,al as Se,H as ae,am as Te,an as Ae,ao as Be,u as ge,n as re,ap as Ee,aq as Me,ar as G,as as je,at as Ve,au as Ne,av as Pe,aw as Le,N as Re}from"./main-DpDYmbyp.js";import{_ as Oe}from"./LineChart-B6kqP0e8.js";import{_ as Fe}from"./InvoiceIndexDropdown-DgC3BpEs.js";import{_ as Ue}from"./EstimateIndexDropdown-B6ntL0oE.js";const qe={},We={class:"flex items-center"};function He(v,s){const a=T("BaseContentPlaceholdersText"),n=T("BaseContentPlaceholdersBox"),i=T("BaseContentPlaceholders");return o(),B(i,{rounded:!0,class:"relative flex justify-between w-full p-3 bg-white rounded shadow lg:col-span-3 xl:p-4"},{default:k(()=>[e("div",null,[r(a,{class:"h-5 -mb-1 w-14 xl:mb-6 xl:h-7",lines:1}),r(a,{class:"h-3 w-28 xl:h-4",lines:1})]),e("div",We,[r(n,{circle:!0,class:"w-10 h-10 xl:w-12 xl:h-12"})])]),_:1})}const ze=H(qe,[["render",He]]),Ke={},Je={class:"flex items-center"};function Ye(v,s){const a=T("BaseContentPlaceholdersText"),n=T("BaseContentPlaceholdersBox"),i=T("BaseContentPlaceholders");return o(),B(i,{rounded:!0,class:"relative flex justify-between w-full p-3 bg-white rounded shadow lg:col-span-2 xl:p-4"},{default:k(()=>[e("div",null,[r(a,{class:"w-12 h-5 -mb-1 xl:mb-6 xl:h-7",lines:1}),r(a,{class:"w-20 h-3 xl:h-4",lines:1})]),e("div",Je,[r(n,{circle:!0,class:"w-10 h-10 xl:w-12 xl:h-12"})])]),_:1})}const Ge=H(Ke,[["render",Ye]]),Qe={class:"flex-1"},Xe={class:"text-lg font-semibold leading-tight text-black sm:text-xl xl:text-3xl","aria-hidden":"true"},Ze={class:"block mt-1 text-xs leading-tight text-gray-500 sm:text-sm xl:text-lg","aria-hidden":"true"},et={class:"flex items-center justify-end mt-2 sm:mt-0 sm:ml-4","aria-hidden":"true"},Q={__name:"DashboardStatsItem",props:{iconComponent:{type:Object,required:!0},loading:{type:Boolean,default:!1},route:{type:String,required:!0},label:{type:String,required:!0},large:{type:Boolean,default:!1}},setup(v){return(s,a)=>{var i,h,m;const n=T("router-link");return v.loading?v.large?(o(),B(ze,{key:1})):(o(),B(Ge,{key:2})):(o(),B(n,{key:0,class:E(["relative flex flex-col sm:flex-row sm:justify-between p-3 bg-white rounded shadow hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-opacity-50 transition-all duration-200 xl:p-4 lg:col-span-2 min-h-[80px] sm:min-h-[100px]",{"lg:!col-span-3":v.large}]),to:v.route,"aria-label":`${v.label}: ${((m=(h=(i=s.$slots).default)==null?void 0:h.call(i)[0])==null?void 0:m.children)||"View details"}`,role:"button",tabindex:"0"},{default:k(()=>[e("div",Qe,[e("span",Xe,[be(s.$slots,"default")]),e("span",Ze,t(v.label),1)]),e("div",et,[(o(),B(ue(v.iconComponent),{class:"w-8 h-8 sm:w-10 sm:h-10 xl:w-12 xl:h-12 text-primary-500","aria-hidden":"true"}))])]),_:3},8,["class","to","aria-label"]))}}},ie=(v=!1)=>{const s=v?window.pinia.defineStore:xe,{global:a}=window.i18n;return s({id:"dashboard",state:()=>({stats:{totalAmountDue:0,totalCustomerCount:0,totalInvoiceCount:0,totalEstimateCount:0},chartData:{months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],invoiceTotals:[0,0,0,0,0,0,0,0,0,0,0,0],expenseTotals:[0,0,0,0,0,0,0,0,0,0,0,0],receiptTotals:[0,0,0,0,0,0,0,0,0,0,0,0],netIncomeTotals:[0,0,0,0,0,0,0,0,0,0,0,0]},totalSales:0,totalReceipts:0,totalExpenses:0,totalNetIncome:0,recentDueInvoices:[],recentEstimates:[],isDashboardDataLoaded:!1}),actions:{loadData(n){return new Promise((i,h)=>{K.get("/dashboard",{params:n}).then(m=>{m.data&&(this.stats.totalAmountDue=m.data.total_amount_due||0,this.stats.totalCustomerCount=m.data.total_customer_count||0,this.stats.totalInvoiceCount=m.data.total_invoice_count||0,this.stats.totalEstimateCount=m.data.total_estimate_count||0,m.data.chart_data&&(this.chartData.months=m.data.chart_data.months||this.chartData.months,this.chartData.invoiceTotals=m.data.chart_data.invoice_totals||this.chartData.invoiceTotals,this.chartData.expenseTotals=m.data.chart_data.expense_totals||this.chartData.expenseTotals,this.chartData.receiptTotals=m.data.chart_data.receipt_totals||this.chartData.receiptTotals,this.chartData.netIncomeTotals=m.data.chart_data.net_income_totals||this.chartData.netIncomeTotals),this.totalSales=m.data.total_sales||0,this.totalReceipts=m.data.total_receipts||0,this.totalExpenses=m.data.total_expenses||0,this.totalNetIncome=m.data.total_net_income||0,this.recentDueInvoices=m.data.recent_due_invoices||[],this.recentEstimates=m.data.recent_estimates||[]),this.isDashboardDataLoaded=!0,i(m)}).catch(m=>{console.warn("Dashboard API not available, using default values",m.message),this.isDashboardDataLoaded=!0,i({data:{}})})})}}})()},tt={class:"grid gap-6 sm:grid-cols-2 lg:grid-cols-9 xl:gap-8"},st={__name:"DashboardStats",setup(v){me("utils");const s=ie(),a=ne(),n=J();return(i,h)=>{const m=T("BaseFormatMoney");return o(),d("div",tt,[l(n).hasAbilities(l(V).VIEW_INVOICE)?(o(),B(Q,{key:0,"icon-component":ve,loading:!l(s).isDashboardDataLoaded,route:"/admin/invoices",large:!0,label:i.$t("dashboard.cards.due_amount")},{default:k(()=>[r(m,{amount:l(s).stats.totalAmountDue,currency:l(a).selectedCompanyCurrency},null,8,["amount","currency"])]),_:1},8,["loading","label"])):S("",!0),l(n).hasAbilities(l(V).VIEW_CUSTOMER)?(o(),B(Q,{key:1,"icon-component":ye,loading:!l(s).isDashboardDataLoaded,route:"/admin/customers",label:l(s).stats.totalCustomerCount<=1?i.$t("dashboard.cards.customers",1):i.$t("dashboard.cards.customers",2)},{default:k(()=>[j(t(l(s).stats.totalCustomerCount),1)]),_:1},8,["loading","label"])):S("",!0),l(n).hasAbilities(l(V).VIEW_INVOICE)?(o(),B(Q,{key:2,"icon-component":fe,loading:!l(s).isDashboardDataLoaded,route:"/admin/invoices",label:l(s).stats.totalInvoiceCount<=1?i.$t("dashboard.cards.invoices",1):i.$t("dashboard.cards.invoices",2)},{default:k(()=>[j(t(l(s).stats.totalInvoiceCount),1)]),_:1},8,["loading","label"])):S("",!0),l(n).hasAbilities(l(V).VIEW_ESTIMATE)?(o(),B(Q,{key:3,"icon-component":pe,loading:!l(s).isDashboardDataLoaded,route:"/admin/estimates",label:l(s).stats.totalEstimateCount<=1?i.$t("dashboard.cards.estimates",1):i.$t("dashboard.cards.estimates",2)},{default:k(()=>[j(t(l(s).stats.totalEstimateCount),1)]),_:1},8,["loading","label"])):S("",!0)])}}},at={},nt={class:"grid grid-cols-1 col-span-10 px-4 py-5 lg:col-span-7 xl:col-span-8 sm:p-8"},ot={class:"flex items-center justify-between mb-2 xl:mb-4"},rt={class:"grid grid-cols-3 col-span-10 text-center border-t border-l border-gray-200 border-solid lg:border-t-0 lg:text-right lg:col-span-3 xl:col-span-2 lg:grid-cols-1"},it={class:"flex flex-col items-center justify-center p-6 lg:justify-end lg:items-end"},lt={class:"flex flex-col items-center justify-center p-6 lg:justify-end lg:items-end"},dt={class:"flex flex-col items-center justify-center p-6 lg:justify-end lg:items-end"},ct={class:"flex flex-col items-center justify-center col-span-3 p-6 border-t border-gray-200 border-solid lg:justify-end lg:items-end lg:col-span-1"};function ut(v,s){const a=T("BaseContentPlaceholdersText"),n=T("BaseContentPlaceholdersBox"),i=T("BaseContentPlaceholders");return o(),B(i,{class:"grid grid-cols-10 mt-8 bg-white rounded shadow"},{default:k(()=>[e("div",nt,[e("div",ot,[r(a,{class:"h-10 w-36",lines:1}),r(a,{class:"h-10 w-36 !mt-0",lines:1})]),r(n,{class:"h-80 xl:h-72 sm:w-full"})]),e("div",rt,[e("div",it,[r(a,{class:"h-3 w-14 xl:h-4",lines:1}),r(a,{class:"w-20 h-5 xl:h-6",lines:1})]),e("div",lt,[r(a,{class:"h-3 w-14 xl:h-4",lines:1}),r(a,{class:"w-20 h-5 xl:h-6",lines:1})]),e("div",dt,[r(a,{class:"h-3 w-14 xl:h-4",lines:1}),r(a,{class:"w-20 h-5 xl:h-6",lines:1})]),e("div",ct,[r(a,{class:"h-3 w-14 xl:h-4",lines:1}),r(a,{class:"w-20 h-5 xl:h-6",lines:1})])])]),_:1})}const mt=H(at,[["render",ut]]),_t={key:0,class:"grid grid-cols-10 mt-8 bg-white rounded shadow"},ht={class:"grid grid-cols-1 col-span-10 px-4 py-5 lg:col-span-7 xl:col-span-8 sm:p-6"},gt={class:"flex justify-between mt-1 mb-4 flex-col md:flex-row"},vt={class:"flex items-center sw-section-title h-10"},ft={class:"w-full my-2 md:m-0 md:w-40 h-10"},pt={class:"grid grid-cols-3 col-span-10 text-center border-t border-l border-gray-200 border-solid lg:border-t-0 lg:text-right lg:col-span-3 xl:col-span-2 lg:grid-cols-1"},yt={class:"p-6"},bt={class:"text-xs leading-5 lg:text-sm"},xt={class:"block mt-1 text-xl font-semibold leading-8 lg:text-2xl"},wt={class:"p-6"},$t={class:"text-xs leading-5 lg:text-sm"},kt={class:"block mt-1 text-xl font-semibold leading-8 lg:text-2xl text-green-400"},Dt={class:"p-6"},Ct={class:"text-xs leading-5 lg:text-sm"},It={class:"block mt-1 text-xl font-semibold leading-8 lg:text-2xl text-red-400"},St={class:"col-span-3 p-6 border-t border-gray-200 border-solid lg:col-span-1"},Tt={class:"text-xs leading-5 lg:text-sm"},At={class:"block mt-1 text-xl font-semibold leading-8 lg:text-2xl text-primary-500"},Bt={__name:"DashboardChart",setup(v){const s=ie(),a=ne(),{t:n}=Y.useI18n();me("utils");const i=J(),h=I([{label:n("dateRange.this_year"),value:"This year"},{label:n("dateRange.previous_year"),value:"Previous year"}]),m=I("This year");ee(m,D=>{D==="Previous year"?w({previous_year:!0}):w()},{immediate:!0});async function w(D){i.hasAbilities(V.DASHBOARD)&&await s.loadData(D)}return(D,$)=>{const c=T("BaseIcon"),_=T("BaseMultiselect"),g=T("BaseFormatMoney");return o(),d("div",null,[l(s).isDashboardDataLoaded?(o(),d("div",_t,[e("div",ht,[e("div",gt,[e("h6",vt,[r(c,{name:"ChartBarSquareIcon",class:"text-primary-400 mr-1"}),j(" "+t(D.$t("dashboard.monthly_chart.title")),1)]),e("div",ft,[r(_,{modelValue:m.value,"onUpdate:modelValue":$[0]||($[0]=C=>m.value=C),options:h.value,"allow-empty":!1,"show-labels":!1,placeholder:D.$t("dashboard.select_year"),"can-deselect":!1},null,8,["modelValue","options","placeholder"])])]),r(Oe,{invoices:l(s).chartData.invoiceTotals,expenses:l(s).chartData.expenseTotals,receipts:l(s).chartData.receiptTotals,income:l(s).chartData.netIncomeTotals,labels:l(s).chartData.months,class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])]),e("div",pt,[e("div",yt,[e("span",bt,t(D.$t("dashboard.chart_info.total_sales")),1),$[1]||($[1]=e("br",null,null,-1)),e("span",xt,[r(g,{amount:l(s).totalSales,currency:l(a).selectedCompanyCurrency},null,8,["amount","currency"])])]),e("div",wt,[e("span",$t,t(D.$t("dashboard.chart_info.total_receipts")),1),$[2]||($[2]=e("br",null,null,-1)),e("span",kt,[r(g,{amount:l(s).totalReceipts,currency:l(a).selectedCompanyCurrency},null,8,["amount","currency"])])]),e("div",Dt,[e("span",Ct,t(D.$t("dashboard.chart_info.total_expense")),1),$[3]||($[3]=e("br",null,null,-1)),e("span",It,[r(g,{amount:l(s).totalExpenses,currency:l(a).selectedCompanyCurrency},null,8,["amount","currency"])])]),e("div",St,[e("span",Tt,t(D.$t("dashboard.chart_info.net_income")),1),$[4]||($[4]=e("br",null,null,-1)),e("span",At,[r(g,{amount:l(s).totalNetIncome,currency:l(a).selectedCompanyCurrency},null,8,["amount","currency"])])])])])):(o(),B(mt,{key:1}))])}}},Et={class:"grid grid-cols-1 gap-6 mt-10 lg:grid-cols-2"},Mt={key:0,class:"due-invoices","aria-labelledby":"due-invoices-heading"},jt={class:"relative z-10 flex flex-col items-start justify-between mb-3 space-y-2 sm:flex-row sm:items-center sm:space-y-0"},Vt={id:"due-invoices-heading",class:"mb-0 text-lg sm:text-xl font-semibold leading-normal"},Nt={class:"overflow-x-auto",role:"region","aria-label":"Due invoices table"},Pt={key:1,class:"recent-estimates","aria-labelledby":"recent-estimates-heading"},Lt={class:"relative z-10 flex flex-col items-start justify-between mb-3 space-y-2 sm:flex-row sm:items-center sm:space-y-0"},Rt={id:"recent-estimates-heading",class:"mb-0 text-lg sm:text-xl font-semibold leading-normal"},Ot={class:"overflow-x-auto",role:"region","aria-label":"Recent estimates table"},Ft={__name:"DashboardTable",setup(v){const s=ie(),{t:a}=Y.useI18n(),n=J(),i=I(null),h=I(null),m=M(()=>[{key:"formattedDueDate",label:a("dashboard.recent_invoices_card.due_on")},{key:"user",label:a("dashboard.recent_invoices_card.customer")},{key:"due_amount",label:a("dashboard.recent_invoices_card.amount_due")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"text-right pl-0",sortable:!1}]),w=M(()=>[{key:"formattedEstimateDate",label:a("dashboard.recent_estimate_card.date")},{key:"user",label:a("dashboard.recent_estimate_card.customer")},{key:"total",label:a("dashboard.recent_estimate_card.amount_due")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"text-right pl-0",sortable:!1}]);function D(){return n.hasAbilities([V.DELETE_INVOICE,V.EDIT_INVOICE,V.VIEW_INVOICE,V.SEND_INVOICE])}function $(){return n.hasAbilities([V.CREATE_ESTIMATE,V.EDIT_ESTIMATE,V.VIEW_ESTIMATE,V.SEND_ESTIMATE])}return(c,_)=>{const g=T("BaseButton"),C=T("router-link"),b=T("BaseFormatMoney"),u=T("BaseTable");return o(),d("div",null,[e("div",Et,[l(n).hasAbilities(l(V).VIEW_INVOICE)?(o(),d("section",Mt,[e("div",jt,[e("h2",Vt,t(c.$t("dashboard.recent_invoices_card.title")),1),r(g,{size:"sm",variant:"primary-outline",class:"w-full sm:w-auto","aria-label":c.$t("dashboard.recent_invoices_card.view_all")+" - "+c.$t("dashboard.recent_invoices_card.title"),onClick:_[0]||(_[0]=p=>c.$router.push("/admin/invoices"))},{default:k(()=>[j(t(c.$t("dashboard.recent_invoices_card.view_all")),1)]),_:1},8,["aria-label"])]),e("div",Nt,[r(u,{data:l(s).recentDueInvoices,columns:m.value,loading:!l(s).isDashboardDataLoaded,class:"min-w-full",role:"table","aria-label":"Recent due invoices"},le({"cell-user":k(({row:p})=>[r(C,{to:{path:`invoices/${p.data.id}/view`},class:"font-medium text-primary-500","aria-label":`View invoice for ${p.data.customer.name}`},{default:k(()=>[j(t(p.data.customer.name),1)]),_:2},1032,["to","aria-label"])]),"cell-due_amount":k(({row:p})=>[r(b,{amount:p.data.base_due_amount,currency:p.data.customer.currency},null,8,["amount","currency"])]),_:2},[D()?{name:"cell-actions",fn:k(({row:p})=>[r(Fe,{row:p.data,table:i.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["data","columns","loading"])])])):S("",!0),l(n).hasAbilities(l(V).VIEW_ESTIMATE)?(o(),d("section",Pt,[e("div",Lt,[e("h2",Rt,t(c.$t("dashboard.recent_estimate_card.title")),1),r(g,{variant:"primary-outline",size:"sm",class:"w-full sm:w-auto","aria-label":c.$t("dashboard.recent_estimate_card.view_all")+" - "+c.$t("dashboard.recent_estimate_card.title"),onClick:_[1]||(_[1]=p=>c.$router.push("/admin/estimates"))},{default:k(()=>[j(t(c.$t("dashboard.recent_estimate_card.view_all")),1)]),_:1},8,["aria-label"])]),e("div",Ot,[r(u,{data:l(s).recentEstimates,columns:w.value,loading:!l(s).isDashboardDataLoaded,class:"min-w-full",role:"table","aria-label":"Recent estimates"},le({"cell-user":k(({row:p})=>[r(C,{to:{path:`estimates/${p.data.id}/view`},class:"font-medium text-primary-500","aria-label":`View estimate for ${p.data.customer.name}`},{default:k(()=>[j(t(p.data.customer.name),1)]),_:2},1032,["to","aria-label"])]),"cell-total":k(({row:p})=>[r(b,{amount:p.data.total,currency:p.data.customer.currency},null,8,["amount","currency"])]),_:2},[$()?{name:"cell-actions",fn:k(({row:p})=>[r(Ue,{row:p.data,table:h.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["data","columns","loading"])])])):S("",!0)])])}}},Ut={class:"bg-white rounded-lg shadow-md p-6 min-h-[400px]"},qt={class:"flex items-center justify-between mb-6"},Wt={class:"flex items-center space-x-3"},Ht={class:"p-2 bg-purple-100 rounded-lg"},zt={class:"text-lg font-semibold text-gray-900"},Kt={class:"text-sm text-gray-500"},Jt=["disabled","title"],Yt={key:0,class:"flex items-center justify-center py-12"},Gt={class:"text-center"},Qt={class:"text-gray-500"},Xt={key:1,class:"text-center py-12"},Zt={class:"text-gray-500 mb-4"},es=["disabled"],ts={key:0},ss={key:1},as={key:2,class:"space-y-4"},ns={class:"flex items-start"},os={class:"flex-1"},rs={class:"font-semibold text-gray-900 mb-1"},is={class:"text-sm text-gray-600 mb-2"},ls={key:0,class:"flex items-start space-x-2 text-sm"},ds={class:"text-gray-700"},cs={key:1,class:"mt-2"},us={key:3,class:"mt-6 pt-4 border-t"},ms={class:"flex items-center justify-between text-xs text-gray-500"},_s={key:0},hs={__name:"AiInsightsWidget",setup(v){const{t:s}=Y.useI18n(),a=I([]),n=I(!0),i=I(!1),h=I(!1),m=I(null),w=I(null),D=I(null);async function $(){try{console.log("[AI Insights] Fetching insights...");const f=await K.get("/ai/insights");console.log("[AI Insights] Fetch response:",f.data),a.value=f.data.insights||[],m.value=f.data.generated_at,w.value=f.data.next_refresh,D.value=null}catch(f){console.error("Failed to fetch AI insights:",f),D.value=f.message}finally{n.value=!1,i.value=!1}}async function c(){h.value=!0;try{console.log("[AI Insights] Triggering generation..."),await K.post("/ai/insights/generate"),console.log("[AI Insights] Generation request acknowledged; polling for results"),setTimeout(()=>{console.log("[AI Insights] Refreshing after generation delay"),$(),h.value=!1},3e3)}catch(f){console.error("Failed to generate AI insights:",f),h.value=!1}}async function _(){console.log("[AI Insights] Manual refresh requested"),i.value=!0,await $()}function g(f){switch(f){case"warning":return X;case"success":return he;case"info":default:return _e}}function C(f){switch(f){case"warning":return"text-red-500";case"success":return"text-green-500";case"info":default:return"text-blue-500"}}function b(f){switch(f){case"warning":return"border-red-500";case"success":return"border-green-500";case"info":default:return"border-blue-500"}}function u(f){return f>=4?"bg-red-100 text-red-800":f>=3?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}function p(f){if(!f)return s("general.never");try{return new Date(f).toLocaleString("mk-MK",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return f}}function A(f){if(!f)return s("general.never");const L=new Date,N=new Date(f),q=Math.floor((N-L)/(1e3*60));if(q<1)return s("ai.insights.in_a_moment");if(q<60)return s("ai.insights.in_minutes",{count:q});const W=Math.floor(q/60);if(W<24)return s("ai.insights.in_hours",{count:W});const x=Math.floor(W/24);return s("ai.insights.in_days",{count:x})}return z(()=>{$()}),(f,L)=>(o(),d("div",Ut,[e("div",qt,[e("div",Wt,[e("div",Ht,[r(l(de),{class:"w-6 h-6 text-purple-600"})]),e("div",null,[e("h3",zt,t(f.$t("ai.insights.title")),1),e("p",Kt,t(f.$t("ai.insights.subtitle")),1)])]),e("button",{onClick:_,disabled:i.value,class:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:f.$t("ai.insights.refresh")},[r(l(oe),{class:E(["w-5 h-5",{"animate-spin":i.value}])},null,8,["class"])],8,Jt)]),n.value?(o(),d("div",Yt,[e("div",Gt,[L[0]||(L[0]=e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"},null,-1)),e("p",Qt,t(f.$t("ai.insights.loading")),1)])])):!a.value||a.value.length===0?(o(),d("div",Xt,[r(l(de),{class:"h-16 w-16 mx-auto text-gray-300 mb-4"}),e("p",Zt,t(f.$t("ai.insights.no_insights")),1),e("button",{onClick:c,disabled:h.value,class:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[h.value?(o(),d("span",ts,t(f.$t("ai.insights.generating")),1)):(o(),d("span",ss,t(f.$t("ai.insights.generate")),1))],8,es)])):(o(),d("div",as,[(o(!0),d(F,null,U(a.value,N=>(o(),d("div",{key:N.id,class:E([["p-4 rounded-lg border-l-4",b(N.type)],"bg-gray-50"])},[e("div",ns,[(o(),B(ue(g(N.type)),{class:E([C(N.type),"h-6 w-6 mr-3 flex-shrink-0 mt-0.5"])},null,8,["class"])),e("div",os,[e("h4",rs,t(N.title),1),e("p",is,t(N.description),1),N.action?(o(),d("div",ls,[L[1]||(L[1]=e("span",{class:"font-medium text-purple-600"},"ðŸ’¡",-1)),e("span",ds,t(N.action),1)])):S("",!0),N.priority?(o(),d("div",cs,[e("span",{class:E(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",u(N.priority)])},t(f.$t("ai.insights.priority"))+": "+t(N.priority),3)])):S("",!0)])])],2))),128))])),a.value&&a.value.length>0?(o(),d("div",us,[e("div",ms,[e("span",null,t(f.$t("ai.insights.last_updated"))+": "+t(p(m.value)),1),w.value?(o(),d("span",_s,t(f.$t("ai.insights.next_refresh"))+": "+t(A(w.value)),1)):S("",!0)])])):S("",!0)]))}},gs={class:"bg-white rounded-lg shadow-md p-6 min-h-[400px] flex flex-col"},vs={class:"flex items-center justify-between mb-6"},fs={class:"flex items-center space-x-3"},ps={class:"p-2 bg-indigo-100 rounded-lg"},ys={class:"text-lg font-semibold text-gray-900"},bs={class:"text-sm text-gray-500"},xs=["title"],ws={key:0,class:"flex items-center justify-center h-full text-center py-8"},$s={class:"text-gray-500 text-sm"},ks={class:"text-gray-400 text-xs mt-2"},Ds={class:"text-sm whitespace-pre-wrap"},Cs={key:1,class:"flex justify-start"},Is={class:"border-t pt-4"},Ss=["placeholder","disabled"],Ts=["disabled"],As={class:"hidden sm:inline"},Bs={class:"text-xs text-gray-400 mt-2"},Es={__name:"AiChatWidget",setup(v){const{t:s}=Y.useI18n(),a=I([]),n=I(""),i=I(!1),h=I(null);async function m(){if(!n.value.trim()||i.value)return;const g={role:"user",content:n.value.trim(),timestamp:new Date};a.value.push(g);const C=n.value.trim();n.value="",await se(),D(),i.value=!0;try{console.log("[AI Chat] Sending message:",C);const b=await K.post("/ai/insights/chat",{message:C});console.log("[AI Chat] Chat response:",b.data);const u={role:"assistant",content:b.data.response||b.data.message||s("ai.chat.no_response"),timestamp:new Date};a.value.push(u),await se(),D()}catch(b){console.error("Failed to send message:",b);const u={role:"assistant",content:s("ai.chat.error_response"),timestamp:new Date};a.value.push(u)}finally{i.value=!1}}function w(){a.value=[],n.value=""}function D(){h.value&&(h.value.scrollTop=h.value.scrollHeight)}function $(g){if(!g)return"";try{return new Date(g).toLocaleTimeString("mk-MK",{hour:"2-digit",minute:"2-digit"})}catch{return""}}function c(){try{const g=localStorage.getItem("ai_chat_history");if(g){const C=JSON.parse(g);a.value=C.map(b=>({...b,timestamp:new Date(b.timestamp)})),se(()=>D())}}catch(g){console.error("Failed to load chat history:",g)}}function _(){try{localStorage.setItem("ai_chat_history",JSON.stringify(a.value))}catch(g){console.error("Failed to save chat history:",g)}}return ee(a,()=>{_()},{deep:!0}),z(()=>{c()}),(g,C)=>(o(),d("div",gs,[e("div",vs,[e("div",fs,[e("div",ps,[r(l(ce),{class:"w-6 h-6 text-indigo-600"})]),e("div",null,[e("h3",ys,t(g.$t("ai.chat.title")),1),e("p",bs,t(g.$t("ai.chat.subtitle")),1)])]),a.value.length>0?(o(),d("button",{key:0,onClick:w,class:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:g.$t("ai.chat.clear")},[r(l(we),{class:"w-5 h-5"})],8,xs)):S("",!0)]),e("div",{ref_key:"chatContainer",ref:h,class:"flex-1 overflow-y-auto mb-4 space-y-4 min-h-[200px] max-h-[400px] pr-2",style:{"scrollbar-width":"thin"}},[a.value.length===0?(o(),d("div",ws,[e("div",null,[r(l(ce),{class:"h-12 w-12 mx-auto text-gray-300 mb-3"}),e("p",$s,t(g.$t("ai.chat.empty_state")),1),e("p",ks,t(g.$t("ai.chat.example_questions")),1)])])):S("",!0),(o(!0),d(F,null,U(a.value,(b,u)=>(o(),d("div",{key:u,class:E(["flex",b.role==="user"?"justify-end":"justify-start"])},[e("div",{class:E(["max-w-[80%] rounded-lg px-4 py-3",b.role==="user"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-900"])},[e("p",Ds,t(b.content),1),e("span",{class:E(["text-xs mt-1 block",b.role==="user"?"text-indigo-200":"text-gray-500"])},t($(b.timestamp)),3)],2)],2))),128)),i.value?(o(),d("div",Cs,C[1]||(C[1]=[Z('<div class="bg-gray-100 rounded-lg px-4 py-3" data-v-b3e5c4f1><div class="flex space-x-2" data-v-b3e5c4f1><div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay:0ms;" data-v-b3e5c4f1></div><div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay:150ms;" data-v-b3e5c4f1></div><div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay:300ms;" data-v-b3e5c4f1></div></div></div>',1)]))):S("",!0)],512),e("div",Is,[e("form",{onSubmit:$e(m,["prevent"]),class:"flex space-x-2"},[ke(e("input",{"onUpdate:modelValue":C[0]||(C[0]=b=>n.value=b),type:"text",placeholder:g.$t("ai.chat.placeholder"),disabled:i.value,class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",maxlength:"500"},null,8,Ss),[[De,n.value]]),e("button",{type:"submit",disabled:!n.value.trim()||i.value,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"},[r(l(Ce),{class:"w-5 h-5"}),e("span",As,t(g.$t("ai.chat.send")),1)],8,Ts)],32),e("p",Bs,t(g.$t("ai.chat.disclaimer")),1)])]))}},Ms=H(Es,[["__scopeId","data-v-b3e5c4f1"]]),js={class:"text-lg font-semibold text-gray-900"},Vs={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},Ns={class:"flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-primary-500 hover:shadow-md transition-all duration-200 cursor-pointer min-h-[60px]"},Ps={class:"flex-shrink-0"},Ls={class:"h-10 w-10 rounded-full bg-primary-100 flex items-center justify-center group-hover:bg-primary-200"},Rs={class:"ml-4"},Os={class:"text-sm font-medium text-gray-900 group-hover:text-primary-600"},Fs={class:"text-xs text-gray-500 hidden sm:block"},Us={class:"flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-primary-500 hover:shadow-md transition-all duration-200 cursor-pointer min-h-[60px]"},qs={class:"flex-shrink-0"},Ws={class:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center group-hover:bg-teal-200"},Hs={class:"ml-4"},zs={class:"text-sm font-medium text-gray-900 group-hover:text-teal-600"},Ks={class:"text-xs text-gray-500 hidden sm:block"},Js={class:"flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-primary-500 hover:shadow-md transition-all duration-200 cursor-pointer min-h-[60px]"},Ys={class:"flex-shrink-0"},Gs={class:"h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center group-hover:bg-purple-200"},Qs={class:"ml-4"},Xs={class:"text-sm font-medium text-gray-900 group-hover:text-purple-600"},Zs={class:"text-xs text-gray-500 hidden sm:block"},ea={class:"flex items-center p-4 border-2 border-gray-200 rounded-lg hover:border-primary-500 hover:shadow-md transition-all duration-200 cursor-pointer min-h-[60px]"},ta={class:"flex-shrink-0"},sa={class:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center group-hover:bg-blue-200"},aa={class:"ml-4"},na={class:"text-sm font-medium text-gray-900 group-hover:text-blue-600"},oa={class:"text-xs text-gray-500 hidden sm:block"},ra={__name:"QuickActionsWidget",setup(v){const s=J();return(a,n)=>{const i=T("BaseIcon"),h=T("router-link"),m=T("BaseCard");return o(),B(m,null,{header:k(()=>[e("h3",js,t(a.$t("dashboard.quick_actions")||"Quick Actions"),1)]),default:k(()=>[e("div",Vs,[l(s).hasAbilities(l(V).CREATE_INVOICE)?(o(),B(h,{key:0,to:"/admin/invoices/create",class:"group"},{default:k(()=>[e("div",Ns,[e("div",Ps,[e("div",Ls,[r(i,{name:"DocumentPlusIcon",class:"h-6 w-6 text-primary-600"})])]),e("div",Rs,[e("p",Os,t(a.$t("invoices.new_invoice")||"New Invoice"),1),e("p",Fs,t(a.$t("dashboard.create_invoice_desc")||"Create new invoice"),1)])])]),_:1})):S("",!0),l(s).hasAbilities(l(V).CREATE_CUSTOMER)?(o(),B(h,{key:1,to:"/admin/customers/create",class:"group"},{default:k(()=>[e("div",Us,[e("div",qs,[e("div",Ws,[r(i,{name:"UserPlusIcon",class:"h-6 w-6 text-teal-600"})])]),e("div",Hs,[e("p",zs,t(a.$t("customers.new_customer")||"New Customer"),1),e("p",Ks,t(a.$t("dashboard.create_customer_desc")||"Add new customer"),1)])])]),_:1})):S("",!0),l(s).hasAbilities(l(V).MANAGE_COMPANY)?(o(),B(h,{key:2,to:"/admin/imports",class:"group"},{default:k(()=>[e("div",Js,[e("div",Ys,[e("div",Gs,[r(i,{name:"ArrowDownTrayIcon",class:"h-6 w-6 text-purple-600"})])]),e("div",Qs,[e("p",Xs,t(a.$t("imports.import_data")||"Import Data"),1),e("p",Zs,t(a.$t("dashboard.import_data_desc")||"Import from CSV"),1)])])]),_:1})):S("",!0),l(s).hasAbilities(l(V).VIEW_REPORT)?(o(),B(h,{key:3,to:"/admin/reports",class:"group"},{default:k(()=>[e("div",ea,[e("div",ta,[e("div",sa,[r(i,{name:"ChartBarIcon",class:"h-6 w-6 text-blue-600"})])]),e("div",aa,[e("p",na,t(a.$t("reports.reports")||"Reports"),1),e("p",oa,t(a.$t("dashboard.view_reports_desc")||"View business reports"),1)])])]),_:1})):S("",!0)])]),_:1})}}},ia={class:"animate-pulse"},la={key:0},da={key:1,class:"space-y-4"},ca={key:2,class:"space-y-3"},ua={key:3,class:"space-y-4"},ma={key:4,class:"p-6 bg-white rounded-lg shadow"},_a={key:5,class:"p-6 bg-white rounded-lg shadow"},ha={class:"flex items-end justify-between h-48 space-x-2"},ga={__name:"LoadingSkeleton",props:{variant:{type:String,default:"table",validator:v=>["table","card","list","form","widget","chart"].includes(v)},rows:{type:Number,default:5}},setup(v){return(s,a)=>(o(),d("div",ia,[v.variant==="table"?(o(),d("div",la,[(o(!0),d(F,null,U(v.rows,n=>(o(),d("div",{key:n,class:"h-12 bg-gray-200 rounded mb-3"}))),128))])):v.variant==="card"?(o(),d("div",da,[(o(!0),d(F,null,U(v.rows,n=>(o(),d("div",{key:n,class:"p-4 border rounded-lg bg-white shadow-sm"},a[0]||(a[0]=[Z('<div class="flex justify-between items-start mb-3" data-v-6457d41d><div class="flex-1" data-v-6457d41d><div class="h-6 bg-gray-200 rounded w-1/3 mb-2" data-v-6457d41d></div><div class="h-4 bg-gray-200 rounded w-1/2" data-v-6457d41d></div></div><div class="h-6 w-20 bg-gray-200 rounded" data-v-6457d41d></div></div><div class="space-y-2 mb-4" data-v-6457d41d><div class="h-4 bg-gray-200 rounded" data-v-6457d41d></div><div class="h-4 bg-gray-200 rounded" data-v-6457d41d></div><div class="h-4 bg-gray-200 rounded w-3/4" data-v-6457d41d></div></div><div class="flex gap-2" data-v-6457d41d><div class="h-10 bg-gray-200 rounded flex-1" data-v-6457d41d></div><div class="h-10 bg-gray-200 rounded flex-1" data-v-6457d41d></div></div>',3)])))),128))])):v.variant==="list"?(o(),d("div",ca,[(o(!0),d(F,null,U(v.rows,n=>(o(),d("div",{key:n,class:"flex items-center p-3 border rounded-lg"},a[1]||(a[1]=[e("div",{class:"h-10 w-10 bg-gray-200 rounded-full mr-3"},null,-1),e("div",{class:"flex-1"},[e("div",{class:"h-4 bg-gray-200 rounded w-2/3 mb-2"}),e("div",{class:"h-3 bg-gray-200 rounded w-1/2"})],-1)])))),128))])):v.variant==="form"?(o(),d("div",ua,[(o(!0),d(F,null,U(v.rows,n=>(o(),d("div",{key:n},a[2]||(a[2]=[e("div",{class:"h-4 bg-gray-200 rounded w-1/4 mb-2"},null,-1),e("div",{class:"h-10 bg-gray-200 rounded w-full"},null,-1)])))),128))])):v.variant==="widget"?(o(),d("div",ma,a[3]||(a[3]=[Z('<div class="h-6 bg-gray-200 rounded w-1/3 mb-4" data-v-6457d41d></div><div class="space-y-3" data-v-6457d41d><div class="h-4 bg-gray-200 rounded" data-v-6457d41d></div><div class="h-4 bg-gray-200 rounded w-5/6" data-v-6457d41d></div><div class="h-4 bg-gray-200 rounded w-4/6" data-v-6457d41d></div></div>',2)]))):v.variant==="chart"?(o(),d("div",_a,[a[4]||(a[4]=e("div",{class:"h-6 bg-gray-200 rounded w-1/4 mb-6"},null,-1)),e("div",ha,[(o(),d(F,null,U(12,n=>e("div",{key:n,class:"flex-1 bg-gray-200 rounded-t",style:Ie({height:`${Math.random()*100}%`})},null,4)),64))])])):S("",!0)]))}},va=H(ga,[["__scopeId","data-v-6457d41d"]]),fa={class:"flex items-center justify-between"},pa={class:"text-lg font-semibold text-red-600"},ya={key:1,class:"text-center py-6"},ba={class:"text-sm text-gray-600"},xa={key:2,class:"space-y-3"},wa={class:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},$a={class:"flex items-center justify-between"},ka={class:"text-sm font-medium text-red-800"},Da={class:"text-xs text-red-600 mt-1"},Ca={class:"text-right"},Ia={key:0,class:"text-lg font-bold text-red-700"},Sa={key:1,class:"text-sm text-gray-500"},Ta={class:"text-xs text-gray-500"},Aa={class:"flex-1 min-w-0"},Ba={class:"text-xs text-gray-600 truncate"},Ea={class:"text-xs text-red-600 mt-1"},Ma={class:"ml-4 text-right flex-shrink-0"},ja={key:0,class:"pt-3 border-t border-gray-200"},Va={__name:"OverdueInvoicesWidget",setup(v){function s(c){if(c==null)return"0.00";const _=typeof c=="string"?parseFloat(c.replace(/[^0-9.,]/g,"").replace(",",".")):Number(c);return isNaN(_)?"0.00":_.toLocaleString("mk-MK",{minimumFractionDigits:2,maximumFractionDigits:2})}const a=Se(),n=ae(),i=I(!0),h=I([]);M(()=>{var c;return((c=n.companySettings)==null?void 0:c.currency)||{code:"MKD",symbol:"Ð´ÐµÐ½"}});const m=M(()=>h.value.slice(0,5)),w=M(()=>h.value.length?h.value.reduce((c,_)=>{const g=_.due_amount||_.amount_due||_.total||0,C=typeof g=="string"?parseFloat(g.replace(/[^0-9.,]/g,"").replace(",",".")):Number(g);return c+(isNaN(C)?0:C)},0):0);function D(c){if(!c)return 0;const _=new Date(c),g=new Date;g.setHours(0,0,0,0),_.setHours(0,0,0,0);const C=g.getTime()-_.getTime(),b=Math.ceil(C/(1e3*60*60*24));return Math.max(0,b)}async function $(){var c;i.value=!0;try{const _=await a.fetchInvoices({status:"DUE",orderByField:"due_date",orderBy:"asc",limit:10});if(!((c=_==null?void 0:_.data)!=null&&c.data)){console.error("Error: Invalid response format from server"),h.value=[];return}const g=new Date;g.setHours(0,0,0,0);const C=_.data.data.map(b=>{const u=b.due_date?new Date(b.due_date):null,p=parseFloat(b.due_amount||0),A=u?new Date(u)<g:!1;return{...b,_processed:{dueDate:u,formattedDueDate:u?u.toISOString().split("T")[0]:"N/A",amount:p,isOverdue:A,daysOverdue:A?D(u):0}}});h.value=C.filter(b=>b._processed.isOverdue&&b._processed.amount>0)}catch(_){console.error("Error fetching overdue invoices:",_),h.value=[]}finally{i.value=!1}}return z(()=>{$()}),(c,_)=>{const g=T("BaseIcon"),C=T("router-link"),b=T("BaseFormatMoney"),u=T("BaseCard");return o(),B(u,null,{header:k(()=>[e("div",fa,[e("h3",pa,t(c.$t("dashboard.overdue_invoices")||"Overdue Invoices"),1),r(g,{name:"ExclamationTriangleIcon",class:"h-6 w-6 text-red-500"})])]),default:k(()=>[i.value?(o(),B(va,{key:0,variant:"list",rows:3})):h.value.length?(o(),d("div",xa,[e("div",wa,[e("div",$a,[e("div",null,[e("p",ka,t(c.$t("dashboard.total_overdue")||"Total Overdue"),1),e("p",Da,t(h.value.length)+" "+t(c.$t("invoices.invoice",h.value.length)),1)]),e("div",Ca,[e("div",null,[w.value!==null?(o(),d("div",Ia,t(s(w.value)),1)):(o(),d("div",Sa," Calculating... ")),e("div",Ta,t(h.value.length)+" "+t(c.$t("invoices.invoice",h.value.length)),1)])])])]),(o(!0),d(F,null,U(m.value,p=>(o(),d("div",{key:p.id,class:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",Aa,[r(C,{to:{path:`/admin/invoices/${p.id}/view`},class:"text-sm font-medium text-primary-500 hover:text-primary-600 truncate block"},{default:k(()=>[j(t(p.invoice_number),1)]),_:2},1032,["to"]),e("p",Ba,t(p.customer.name),1),e("p",Ea,t(c.$t("invoices.overdue_by")||"Overdue by")+" "+t(D(p.due_date))+" "+t(c.$t("general.days")||"days"),1)]),e("div",Ma,[r(b,{amount:p.due_amount,currency:p.currency,class:"text-sm font-semibold text-gray-900"},null,8,["amount","currency"])])]))),128)),h.value.length>5?(o(),d("div",ja,[r(C,{to:"/admin/invoices?status=overdue",class:"text-sm text-primary-500 hover:text-primary-600 font-medium flex items-center justify-center"},{default:k(()=>[j(t(c.$t("dashboard.view_all_overdue")||"View all overdue invoices")+" ",1),r(g,{name:"ChevronRightIcon",class:"h-4 w-4 ml-1"})]),_:1})])):S("",!0)])):(o(),d("div",ya,[r(g,{name:"CheckCircleIcon",class:"h-16 w-16 mx-auto text-green-500 mb-2"}),e("p",ba,t(c.$t("dashboard.no_overdue_invoices")||"No overdue invoices"),1)]))]),_:1})}}},Na={class:"bg-white rounded-lg shadow-md p-6 min-h-[300px]"},Pa={class:"flex items-center justify-between mb-6"},La={class:"flex items-center space-x-3"},Ra={class:"p-2 bg-blue-100 rounded-lg"},Oa={class:"text-lg font-semibold text-gray-900"},Fa={class:"text-sm text-gray-500"},Ua=["disabled","title"],qa={key:0,class:"space-y-4"},Wa={key:1,class:"text-center py-8"},Ha={class:"text-lg font-medium text-gray-900 mb-2"},za={class:"text-gray-500 mb-4"},Ka={key:2,class:"space-y-6"},Ja={class:"bg-gray-50 rounded-lg p-4"},Ya={class:"flex items-center justify-between"},Ga={class:"font-medium text-gray-900"},Qa={class:"text-sm text-gray-600 mt-1"},Xa={class:"flex items-center space-x-2"},Za={class:"font-medium text-gray-900 mb-3"},en={class:"space-y-3"},tn={class:"flex items-center space-x-3"},sn={class:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center"},an={class:"font-medium text-gray-900"},nn={class:"text-sm text-gray-500"},on={class:"flex items-center space-x-3"},rn={class:"text-right"},ln={class:"text-sm text-gray-600"},dn={class:"text-sm font-medium text-gray-900"},cn={class:"grid grid-cols-2 gap-4"},un={class:"bg-blue-50 rounded-lg p-4"},mn={class:"flex items-center space-x-2"},_n={class:"font-medium text-gray-900"},hn={class:"text-2xl font-bold text-blue-600 mt-2"},gn={class:"text-sm text-gray-600"},vn={class:"font-medium"},fn={class:"bg-green-50 rounded-lg p-4"},pn={class:"flex items-center space-x-2"},yn={class:"font-medium text-gray-900"},bn={class:"text-2xl font-bold text-green-600 mt-2"},xn={class:"text-sm text-gray-600"},wn={class:"font-medium"},$n={class:"border-t pt-4"},kn={class:"flex items-center justify-between text-sm text-gray-600"},Dn={__name:"BankStatus",setup(v){const{t:s}=Y.useI18n(),a=I(!0),n=I(null),i=I([]),h=I({transactionsToday:0,totalAmountToday:0,matchedPayments:0,matchRate:0}),m=I(null),w=I(null),D=M(()=>i.value.reduce((u,p)=>u+p.accountCount,0)),$=M(()=>{const u=i.value.some(A=>A.status==="error"),p=i.value.some(A=>A.status==="warning");return u?"error":p?"warning":"healthy"}),c=async()=>{try{a.value=!0,n.value=null,await new Promise(u=>setTimeout(u,1e3)),i.value=[{code:"stopanska",name:"Stopanska Banka",accountCount:2,status:"connected",lastSync:new Date(Date.now()-1e3*60*15),psd2Status:"active"},{code:"nlb",name:"NLB Banka",accountCount:1,status:"connected",lastSync:new Date(Date.now()-1e3*60*30),psd2Status:"active"},{code:"komercijalna",name:"Komercijalna Banka",accountCount:1,status:"warning",lastSync:new Date(Date.now()-1e3*60*60*2),psd2Status:"expired"}],h.value={transactionsToday:47,totalAmountToday:125430.5,matchedPayments:23,matchRate:89},m.value=new Date(Date.now()-1e3*60*60),w.value=new Date(Date.now()+1e3*60*15)}catch(u){n.value=u.message||s("banking.status_widget.load_error")}finally{a.value=!1}},_=()=>{c()},g=u=>{if(!u)return s("banking.status_widget.never");const A=Math.floor((new Date-u)/(1e3*60));if(A<1)return s("banking.status_widget.just_now");if(A<60)return s("banking.status_widget.minutes_ago",{count:A});const f=Math.floor(A/60);if(f<24)return s("banking.status_widget.hours_ago",{count:f});const L=Math.floor(f/24);return s("banking.status_widget.days_ago",{count:L})},C=u=>{if(!u)return s("banking.status_widget.never");try{return new Date(u).toLocaleString()}catch{return u}},b=u=>!u||isNaN(u)?"0 MKD":`${Number(u).toLocaleString("mk-MK")} MKD`;return z(()=>{c()}),(u,p)=>(o(),d("div",Na,[e("div",Pa,[e("div",La,[e("div",Ra,[r(l(Te),{class:"w-6 h-6 text-blue-600"})]),e("div",null,[e("h3",Oa,t(u.$t("banking.status_widget.title")),1),e("p",Fa,t(u.$t("banking.status_widget.subtitle")),1)])]),e("button",{onClick:_,disabled:a.value,class:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:u.$t("banking.status_widget.refresh")},[r(l(oe),{class:E(["w-5 h-5",{"animate-spin":a.value}])},null,8,["class"])],8,Ua)]),a.value?(o(),d("div",qa,p[0]||(p[0]=[Z('<div class="animate-pulse"><div class="h-4 bg-gray-200 rounded w-1/3 mb-2"></div><div class="h-6 bg-gray-200 rounded w-1/2 mb-4"></div></div><div class="space-y-3"><div class="h-12 bg-gray-200 rounded animate-pulse"></div><div class="h-12 bg-gray-200 rounded animate-pulse"></div><div class="h-12 bg-gray-200 rounded animate-pulse"></div></div>',2)]))):n.value?(o(),d("div",Wa,[r(l(X),{class:"w-12 h-12 text-red-400 mx-auto mb-4"}),e("h4",Ha,t(u.$t("banking.status_widget.error_title")),1),e("p",za,t(n.value),1),e("button",{onClick:_,class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"},t(u.$t("banking.status_widget.retry")),1)])):(o(),d("div",Ka,[e("div",Ja,[e("div",Ya,[e("div",null,[e("h4",Ga,t(u.$t("banking.status_widget.overall_status")),1),e("p",Qa,t(u.$t("banking.status_widget.accounts_connected",{count:D.value})),1)]),e("div",Xa,[e("span",{class:E(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",$.value==="healthy"?"bg-green-100 text-green-800":$.value==="warning"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},[e("span",{class:E(["w-1.5 h-1.5 rounded-full mr-1.5",$.value==="healthy"?"bg-green-400":$.value==="warning"?"bg-yellow-400":"bg-red-400"])},null,2),j(" "+t(u.$t(`banking.status_widget.status_${$.value}`)),1)],2)])])]),e("div",null,[e("h4",Za,t(u.$t("banking.status_widget.bank_connections")),1),e("div",en,[(o(!0),d(F,null,U(i.value,A=>(o(),d("div",{key:A.code,class:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors"},[e("div",tn,[e("div",sn,[r(l(Ae),{class:"w-5 h-5 text-gray-600"})]),e("div",null,[e("h5",an,t(A.name),1),e("p",nn,t(u.$t("banking.status_widget.accounts",{count:A.accountCount})),1)])]),e("div",on,[e("div",rn,[e("p",ln,t(u.$t("banking.status_widget.last_sync")),1),e("p",dn,t(g(A.lastSync)),1)]),e("span",{class:E(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",A.status==="connected"?"bg-green-100 text-green-800":A.status==="warning"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"])},t(u.$t(`banking.status_widget.bank_status_${A.status}`)),3)])]))),128))])]),e("div",cn,[e("div",un,[e("div",mn,[r(l(Be),{class:"w-5 h-5 text-blue-600"}),e("h5",_n,t(u.$t("banking.status_widget.transactions_today")),1)]),e("p",hn,t(h.value.transactionsToday),1),e("p",gn,[j(t(u.$t("banking.status_widget.total_amount"))+": ",1),e("span",vn,t(b(h.value.totalAmountToday)),1)])]),e("div",fn,[e("div",pn,[r(l(he),{class:"w-5 h-5 text-green-600"}),e("h5",yn,t(u.$t("banking.status_widget.matched_payments")),1)]),e("p",bn,t(h.value.matchedPayments),1),e("p",xn,[j(t(u.$t("banking.status_widget.match_rate"))+": ",1),e("span",wn,t(h.value.matchRate)+"%",1)])])]),e("div",$n,[e("div",kn,[e("span",null,t(u.$t("banking.status_widget.last_full_sync"))+": "+t(C(m.value)),1),e("span",null,t(u.$t("banking.status_widget.next_sync"))+": "+t(g(w.value)),1)])])]))]))}},Cn={name:"VatStatus",setup(){const v=ne(),s=ge(),a=re(),n=I(!1),i=I(null),h=I([]),m=I(null),w=M(()=>v.selectedCompany),D=async()=>{var x,y,R,P,te;if(!((x=w.value)!=null&&x.id)){$();return}try{n.value=!0,m.value=null;const O=await K.get(`/tax/vat-status/${w.value.id}`);O.data&&O.data.data?(i.value=O.data.data.status,h.value=O.data.data.alerts||[]):$()}catch(O){console.error("Failed to fetch VAT status:",O),((y=O.response)==null?void 0:y.status)===404||((R=O.response)==null?void 0:R.status)===501?(console.info("VAT status API not available, using mock data"),c()):(m.value=((te=(P=O.response)==null?void 0:P.data)==null?void 0:te.message)||"Failed to load VAT status",$())}finally{n.value=!1}},$=()=>{i.value={compliance_status:"unknown",last_checked:new Date,last_generated:null,current_period:null,next_due_date:null},h.value=[]},c=()=>{const x=new Date,y=new Date(x.getFullYear(),x.getMonth()-1,1),R=new Date(x.getFullYear(),x.getMonth()+1,15);i.value={compliance_status:"compliant",last_checked:x,last_generated:y,current_period:_(),next_due_date:R},h.value=g()},_=()=>{const x=new Date,y=x.getFullYear(),R=x.getMonth()+1;return R===1?`${y-1}-12`:`${y}-${(R-1).toString().padStart(2,"0")}`},g=()=>{var P;const x=[],R=new Date().getDate();return R>=10&&R<=15&&x.push({id:"vat-deadline",severity:"warning",title:"VAT Return Due Soon",description:"VAT return for last month is due on the 15th of this month."}),(P=w.value)!=null&&P.vat_number||x.push({id:"vat-number-missing",severity:"error",title:"VAT Number Missing",description:"Company VAT number is required for VAT compliance."}),x},C=x=>{switch(x){case"compliant":return"bg-green-500";case"warning":return"bg-yellow-500";case"non_compliant":return"bg-red-500";default:return"bg-gray-400"}},b=x=>{switch(x){case"compliant":return"VAT compliance up to date";case"warning":return"Action required soon";case"non_compliant":return"Non-compliant - immediate action required";default:return"Status unknown"}},u=x=>{switch(x){case"error":return"bg-red-50 border-red-400";case"warning":return"bg-yellow-50 border-yellow-400";default:return"bg-blue-50 border-blue-400"}},p=x=>{switch(x){case"error":return"fas fa-exclamation-circle text-red-400";case"warning":return"fas fa-exclamation-triangle text-yellow-400";default:return"fas fa-info-circle text-blue-400"}},A=x=>{switch(x){case"error":return"text-red-800";case"warning":return"text-yellow-800";default:return"text-blue-800"}},f=x=>{switch(x){case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-blue-600"}},L=x=>x?new Date(x).toLocaleDateString("mk-MK",{year:"numeric",month:"short",day:"numeric"}):"-",N=()=>{D()},q=()=>{a.push("/admin/settings/vat-return")},W=()=>{s.showNotification({type:"info",message:"VAT compliance history feature coming soon"})};return ee(()=>{var x;return(x=w.value)==null?void 0:x.id},x=>{x&&D()}),z(()=>{D()}),{isLoading:n,vatStatus:i,complianceAlerts:h,error:m,currentCompany:w,getStatusColor:C,getStatusText:b,getAlertClasses:u,getAlertIcon:p,getAlertTextColor:A,getAlertDescriptionColor:f,formatDate:L,refreshData:N,navigateToVatReturn:q,viewComplianceHistory:W}}},In={class:"vat-status-widget bg-white rounded-lg shadow-md p-6 border border-gray-200"},Sn={class:"flex items-center justify-between mb-4"},Tn={class:"flex items-center"},An={class:"ml-3"},Bn={class:"text-lg font-semibold text-gray-900"},En={class:"text-sm text-gray-600"},Mn={class:"flex-shrink-0"},jn=["disabled"],Vn={key:0,class:"space-y-3"},Nn={key:1,class:"space-y-4"},Pn={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},Ln={class:"flex items-center"},Rn={class:"text-sm font-medium text-gray-900"},On={class:"text-xs text-gray-600"},Fn={class:"text-right"},Un={class:"text-xs text-gray-500"},qn={class:"text-sm font-medium text-gray-900"},Wn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Hn={class:"p-3 border border-gray-200 rounded-lg"},zn={class:"flex items-center justify-between"},Kn={class:"text-xs text-gray-500 uppercase tracking-wide"},Jn={class:"text-sm font-semibold text-gray-900"},Yn={class:"p-3 border border-gray-200 rounded-lg"},Gn={class:"flex items-center justify-between"},Qn={class:"text-xs text-gray-500 uppercase tracking-wide"},Xn={class:"text-sm font-semibold text-gray-900"},Zn={key:0,class:"space-y-2"},eo={class:"text-sm font-medium text-gray-900"},to={class:"flex items-start"},so={class:"flex-1 min-w-0"},ao={class:"pt-4 border-t border-gray-200"},no={class:"flex flex-col sm:flex-row gap-2"},oo={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},ro={class:"flex items-center"},io={class:"text-sm text-red-700"};function lo(v,s,a,n,i,h){var m,w,D,$,c;return o(),d("div",In,[e("div",Sn,[e("div",Tn,[s[3]||(s[3]=e("div",{class:"flex-shrink-0"},[e("i",{class:"fas fa-file-invoice-dollar text-2xl text-blue-600"})],-1)),e("div",An,[e("h3",Bn,t(v.$t("vat.compliance_status")),1),e("p",En,t(v.$t("vat.widget_description")),1)])]),e("div",Mn,[e("button",{onClick:s[0]||(s[0]=(..._)=>n.refreshData&&n.refreshData(..._)),class:"p-2 text-gray-400 hover:text-gray-600 transition-colors",disabled:n.isLoading},[e("i",{class:E(["fas fa-sync-alt",{"fa-spin":n.isLoading}])},null,2)],8,jn)])]),n.isLoading&&!n.vatStatus?(o(),d("div",Vn,s[4]||(s[4]=[e("div",{class:"animate-pulse"},[e("div",{class:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e("div",{class:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),e("div",{class:"h-8 bg-gray-200 rounded"})],-1)]))):(o(),d("div",Nn,[e("div",Pn,[e("div",Ln,[e("div",{class:E(["w-3 h-3 rounded-full mr-3",n.getStatusColor(((m=n.vatStatus)==null?void 0:m.compliance_status)||"unknown")])},null,2),e("div",null,[e("p",Rn,t(v.$t("vat.current_status")),1),e("p",On,t(n.getStatusText(((w=n.vatStatus)==null?void 0:w.compliance_status)||"unknown")),1)])]),e("div",Fn,[e("p",Un,t(v.$t("vat.as_of")),1),e("p",qn,t(n.formatDate(((D=n.vatStatus)==null?void 0:D.last_checked)||new Date)),1)])]),e("div",Wn,[e("div",Hn,[e("div",zn,[e("div",null,[e("p",Kn,t(v.$t("vat.last_generation")),1),e("p",Jn,t(($=n.vatStatus)!=null&&$.last_generated?n.formatDate(n.vatStatus.last_generated):v.$t("vat.never_generated")),1)]),s[5]||(s[5]=e("i",{class:"fas fa-calendar-alt text-gray-400"},null,-1))])]),e("div",Yn,[e("div",Gn,[e("div",null,[e("p",Qn,t(v.$t("vat.return_period")),1),e("p",Xn,t(((c=n.vatStatus)==null?void 0:c.current_period)||v.$t("vat.no_period_set")),1)]),s[6]||(s[6]=e("i",{class:"fas fa-clock text-gray-400"},null,-1))])])]),n.complianceAlerts&&n.complianceAlerts.length>0?(o(),d("div",Zn,[e("h4",eo,t(v.$t("vat.compliance_alerts")),1),(o(!0),d(F,null,U(n.complianceAlerts,_=>(o(),d("div",{key:_.id,class:E(["p-3 rounded-lg border-l-4",n.getAlertClasses(_.severity)])},[e("div",to,[e("i",{class:E([n.getAlertIcon(_.severity),"mt-0.5 mr-2"])},null,2),e("div",so,[e("p",{class:E(["text-sm font-medium",n.getAlertTextColor(_.severity)])},t(_.title),3),e("p",{class:E(["text-xs mt-1",n.getAlertDescriptionColor(_.severity)])},t(_.description),3)])])],2))),128))])):S("",!0),e("div",ao,[e("div",no,[e("button",{onClick:s[1]||(s[1]=(..._)=>n.navigateToVatReturn&&n.navigateToVatReturn(..._)),class:"flex-1 px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"},[s[7]||(s[7]=e("i",{class:"fas fa-file-export mr-2"},null,-1)),j(" "+t(v.$t("vat.generate_return")),1)]),e("button",{onClick:s[2]||(s[2]=(..._)=>n.viewComplianceHistory&&n.viewComplianceHistory(..._)),class:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"},[s[8]||(s[8]=e("i",{class:"fas fa-history mr-2"},null,-1)),j(" "+t(v.$t("vat.view_history")),1)])])]),n.error?(o(),d("div",oo,[e("div",ro,[s[9]||(s[9]=e("i",{class:"fas fa-exclamation-triangle text-red-400 mr-2"},null,-1)),e("p",io,t(n.error),1)])])):S("",!0)]))])}const co=H(Cn,[["render",lo],["__scopeId","data-v-439ad0b3"]]),uo={class:"flex items-center"},mo={class:"text-lg font-medium"},_o={key:0,class:"flex items-center justify-center py-8"},ho={class:"ml-2 text-gray-600"},go={key:1,class:"text-center py-8"},vo={class:"mt-2 text-red-600"},fo={key:2,class:"text-center py-8"},po={class:"mt-2 text-gray-500"},yo={class:"text-sm text-gray-400 mt-1"},bo={key:3,class:"space-y-4"},xo={class:"flex items-center justify-between"},wo={class:"text-sm text-gray-600"},$o={class:"flex items-center"},ko={key:0,class:"w-2 h-2 bg-red-400 rounded-full mr-2 animate-pulse"},Do={class:"text-sm text-gray-600"},Co={class:"text-sm font-medium truncate"},Io={class:"text-sm text-gray-600"},So={key:0,class:"bg-blue-50 border border-blue-200 rounded-md p-3"},To={class:"flex items-center"},Ao={class:"text-sm font-medium text-blue-700"},Bo={class:"text-xs text-blue-600 mt-1"},Eo={key:1,class:"bg-red-50 border border-red-200 rounded-md p-3"},Mo={class:"flex items-center"},jo={class:"text-sm font-medium text-red-700"},Vo={class:"text-xs text-red-600 mt-1"},No={class:"flex space-x-2 pt-2 border-t"},Po={class:"mt-4 pt-3 border-t text-center"},Lo={class:"text-xs text-gray-400"},Ro={__name:"CertExpiry",setup(v){const{t:s}=Y.useI18n(),a=re();ge();const n=J(),i=I(null),h=I(!0),m=I(""),w=I(new Date),D=I(null),$=M(()=>i.value?_.value?"text-red-500":i.value.is_valid?"text-green-500":"text-red-500":"text-gray-400"),c=M(()=>{var O;if(!((O=i.value)!=null&&O.valid_to))return null;const y=new Date,P=new Date(i.value.valid_to)-y;return Math.ceil(P/(1e3*60*60*24))}),_=M(()=>c.value!==null&&c.value<=30),g=M(()=>i.value?_.value?"red":i.value.is_valid?"green":"red":"gray"),C=M(()=>i.value?c.value!==null&&c.value<0?s("widgets.cert_expiry.expired"):_.value?s("widgets.cert_expiry.expiring_soon"):i.value.is_valid?s("widgets.cert_expiry.valid"):s("widgets.cert_expiry.invalid"):s("widgets.cert_expiry.no_cert")),b=M(()=>{var y;return _.value?"text-red-600":(y=i.value)!=null&&y.is_valid?"text-green-600":"text-gray-600"}),u=M(()=>_.value?"text-red-500":"text-gray-500"),p=M(()=>{if(c.value===null)return"";if(c.value<0){const y=Math.abs(c.value);return s("widgets.cert_expiry.expired_days_ago",{days:y})}return c.value===0?s("widgets.cert_expiry.expires_today"):s("widgets.cert_expiry.expires_in_days",{days:c.value})}),A=M(()=>{var y;if(!((y=i.value)!=null&&y.valid_to))return s("widgets.cert_expiry.unknown");try{return new Date(i.value.valid_to).toLocaleDateString()}catch{return s("widgets.cert_expiry.unknown")}}),f=M(()=>w.value.toLocaleTimeString()),L=async()=>{var y,R;h.value=!0,m.value="";try{const P=await K.get("/certificates/current");i.value=P.data.data,w.value=new Date}catch(P){((y=P.response)==null?void 0:y.status)===404||((R=P.response)==null?void 0:R.status)===501?i.value=null:(console.error("Failed to fetch certificate:",P),m.value=s("widgets.cert_expiry.fetch_error"))}finally{h.value=!1}},N=()=>{a.push("/admin/settings/certificates")},q=()=>{a.push("/admin/settings/certificates")},W=()=>{D.value=setInterval(()=>{L()},300*1e3)},x=()=>{D.value&&(clearInterval(D.value),D.value=null)};return z(()=>{n.currentUser&&(L(),W())}),ee(()=>n.currentUser,y=>{y&&!i.value&&(L(),W())}),Ee(()=>{x()}),(y,R)=>(o(),B(Le,{class:"cert-expiry-widget"},{header:k(()=>[e("div",uo,[r(l(Pe),{class:E(["h-5 w-5 mr-2",$.value])},null,8,["class"]),e("span",mo,t(y.$t("widgets.cert_expiry.title")),1)])]),default:k(()=>{var P;return[h.value?(o(),d("div",_o,[r(Me,{class:"h-8 w-8 text-primary-500"}),e("span",ho,t(y.$t("widgets.cert_expiry.loading")),1)])):m.value?(o(),d("div",go,[r(l(X),{class:"mx-auto h-12 w-12 text-red-400"}),e("p",vo,t(m.value),1),r(G,{variant:"primary-outline",size:"sm",class:"mt-3",onClick:L},{default:k(()=>[j(t(y.$t("widgets.cert_expiry.retry")),1)]),_:1})])):i.value?(o(),d("div",bo,[e("div",xo,[e("span",wo,t(y.$t("widgets.cert_expiry.status")),1),r(Ve,{variant:g.value,size:"sm"},{default:k(()=>[e("div",$o,[_.value?(o(),d("div",ko)):S("",!0),j(" "+t(C.value),1)])]),_:1},8,["variant"])]),e("div",null,[e("span",Do,t(y.$t("widgets.cert_expiry.subject")),1),e("p",Co,t(((P=i.value.subject)==null?void 0:P.CN)||y.$t("widgets.cert_expiry.unknown")),1)]),e("div",null,[e("span",Io,t(y.$t("widgets.cert_expiry.expires")),1),e("p",{class:E(["text-sm font-medium",b.value])},t(A.value),3),c.value!==null?(o(),d("p",{key:0,class:E(["text-xs",u.value])},t(p.value),3)):S("",!0)]),i.value.qes_enabled?(o(),d("div",So,[e("div",To,[r(l(Ne),{class:"h-4 w-4 text-blue-500 mr-2"}),e("span",Ao,t(y.$t("widgets.cert_expiry.qes_enabled")),1)]),e("p",Bo,t(y.$t("widgets.cert_expiry.qes_description")),1)])):S("",!0),_.value?(o(),d("div",Eo,[e("div",Mo,[r(l(X),{class:"h-4 w-4 text-red-500 mr-2"}),e("span",jo,t(y.$t("widgets.cert_expiry.expiry_alert")),1)]),e("p",Vo,t(y.$t("widgets.cert_expiry.renew_message")),1)])):S("",!0),e("div",No,[r(G,{variant:"primary-outline",size:"sm",onClick:N},{left:k(()=>[r(l(_e),{class:"h-4 w-4"})]),default:k(()=>[j(" "+t(y.$t("widgets.cert_expiry.view_details")),1)]),_:1}),_.value?(o(),B(G,{key:0,variant:"primary",size:"sm",onClick:q},{left:k(()=>[r(l(oe),{class:"h-4 w-4"})]),default:k(()=>[j(" "+t(y.$t("widgets.cert_expiry.renew_now")),1)]),_:1})):S("",!0)])])):(o(),d("div",fo,[r(l(je),{class:"mx-auto h-12 w-12 text-gray-300"}),e("p",po,t(y.$t("widgets.cert_expiry.no_certificate")),1),e("p",yo,t(y.$t("widgets.cert_expiry.upload_help")),1),r(G,{variant:"primary",size:"sm",class:"mt-3",onClick:q},{default:k(()=>[j(t(y.$t("widgets.cert_expiry.upload_certificate")),1)]),_:1})])),e("div",Po,[e("p",Lo,t(y.$t("widgets.cert_expiry.last_checked"))+": "+t(f.value),1)])]}),_:1}))}},Oo=H(Ro,[["__scopeId","data-v-0fa45a3a"]]),Fo={class:"mb-6"},Uo={key:0,class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},qo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6"},Wo={class:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6"},Qo={__name:"Dashboard",setup(v){const s=Re(),a=J(),n=re(),i=ae(),h=M(()=>{var w;return((w=a.currentUserSettings)==null?void 0:w.show_ai_insights)!==!1}),m=M(()=>{var w;return((w=i.featureFlags)==null?void 0:w.mcp_ai_tools)===!0});return z(()=>{const w=ae();if(w.isAppLoaded&&s.meta.ability&&a.currentAbilities&&a.currentAbilities.length>0&&!a.hasAbilities(s.meta.ability)){n.push({name:"account.settings"});return}if(w.isAppLoaded&&s.meta.isOwner&&a.currentUser&&a.currentUser.is_owner===!1){n.push({name:"account.settings"});return}}),(w,D)=>{const $=T("BasePage");return o(),B($,null,{default:k(()=>[r(st),e("div",Fo,[r(Bt)]),m.value&&h.value?(o(),d("div",Uo,[r(hs),r(Ms)])):S("",!0),e("div",qo,[r(Dn),r(co),r(Oo)]),e("div",Wo,[r(ra),r(Va)]),r(Ft)]),_:1})}}};export{Qo as default};
