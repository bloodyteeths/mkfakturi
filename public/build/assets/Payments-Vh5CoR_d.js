import{j as C,e as L,I as R,k as J,K as g,w as l,r as o,N as O,o as y,a as t,b as B,c as Q,q as i,t as u,l as b,M as W,m as X,L as Y}from"./main-C3HD31Qx.js";import{u as Z}from"./bills-DoaZgB1i.js";import{u as x}from"./expense-Bp9eCRNs.js";const ee={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},te={key:1,class:"relative table-container"},ae={class:"space-y-4"},le={class:"mt-6 flex justify-end space-x-3"},de={__name:"Payments",setup(ne){const M=O(),s=Z(),P=x(),m=C(()=>M.params.id),c=L(!1),w=[{key:"payment_date",label:"Date"},{key:"amount",label:"Amount"},{key:"method",label:"Method"},{key:"actions",label:"",sortable:!1,tdClass:"text-right"}],a=R({id:null,payment_date:"",amount:0,payment_method_id:null,notes:""}),f=C(()=>s.selectedBill);function D(e){a.id=e.id,a.payment_date=e.payment_date,a.amount=e.amount,a.payment_method_id=e.payment_method_id,a.notes=e.notes||"",c.value=!0}function v(){a.id=null,a.payment_date="",a.amount=0,a.payment_method_id=null,a.notes="",c.value=!1}function I(e){D(e)}function S(e){s.deleteBillPayment(m.value,e).then(()=>{s.fetchBill(m.value)})}function F(){const e={payment_date:a.payment_date,amount:a.amount,payment_method_id:a.payment_method_id,notes:a.notes};c.value&&a.id?s.updateBillPayment(m.value,a.id,e).then(()=>{s.fetchBillPayments(m.value),s.fetchBill(m.value),v()}):s.createBillPayment(m.value,e).then(()=>{s.fetchBillPayments(m.value),s.fetchBill(m.value),v()})}return J(()=>{P.fetchPaymentModes(),s.fetchBill(m.value),s.fetchBillPayments(m.value)}),(e,r)=>{const p=o("BaseBreadcrumbItem"),N=o("BaseBreadcrumb"),T=o("BasePageHeader"),$=o("BaseHeading"),q=o("BaseEmptyPlaceholder"),z=o("BaseFormatMoney"),h=o("BaseButton"),k=o("BaseDropdownItem"),E=o("BaseDropdown"),H=o("BaseTable"),V=o("BaseCard"),U=o("BaseDatePicker"),_=o("BaseInputGroup"),j=o("BaseMoney"),G=o("BaseMultiselect"),A=o("BaseTextarea"),K=o("BasePage");return y(),g(K,null,{default:l(()=>[t(T,{title:e.$t("bills.payments_title")},{default:l(()=>[t(N,null,{default:l(()=>{var n;return[t(p,{title:e.$t("general.home"),to:"dashboard"},null,8,["title"]),t(p,{title:e.$t("bills.title"),to:"/admin/bills"},null,8,["title"]),t(p,{title:((n=f.value)==null?void 0:n.bill_number)||"",to:`/admin/bills/${m.value}/view`},null,8,["title","to"]),t(p,{title:e.$t("bills.payments_title"),to:"#",active:""},null,8,["title"])]}),_:1})]),_:1},8,["title"]),B("div",ee,[t(V,{class:"lg:col-span-2"},{default:l(()=>[t($,{tag:"h3",size:"sm",class:"mb-4"},{default:l(()=>[i(u(e.$t("bills.payments_list")),1)]),_:1}),b(s).billPayments.length?(y(),Q("div",te,[t(H,{data:b(s).billPayments,columns:w,meta:{total:b(s).billPayments.length}},{"cell-payment_date":l(({row:n})=>[i(u(n.data.formatted_payment_date),1)]),"cell-amount":l(({row:n})=>{var d;return[t(z,{amount:n.data.amount,currency:(d=f.value)==null?void 0:d.currency},null,8,["amount","currency"])]}),"cell-method":l(({row:n})=>{var d;return[i(u(((d=n.data.payment_method)==null?void 0:d.name)||"-"),1)]}),"cell-actions":l(({row:n})=>[t(E,null,{button:l(d=>[t(h,{variant:"tertiary",size:"xs",class:W(d.class)},{default:l(()=>[i(u(e.$t("general.actions")),1)]),_:2},1032,["class"])]),default:l(()=>[t(k,{onClick:d=>I(n.data)},{default:l(()=>[i(u(e.$t("general.edit")),1)]),_:2},1032,["onClick"]),t(k,{onClick:d=>S(n.data.id)},{default:l(()=>[i(u(e.$t("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","meta"])])):(y(),g(q,{key:0,title:e.$t("bills.no_payments"),description:e.$t("bills.no_payments_description")},null,8,["title","description"]))]),_:1}),t(V,null,{default:l(()=>[t($,{tag:"h3",size:"sm",class:"mb-4"},{default:l(()=>[i(u(c.value?e.$t("bills.edit_payment"):e.$t("bills.add_payment")),1)]),_:1}),B("form",{onSubmit:X(F,["prevent"])},[B("div",ae,[t(_,{label:e.$t("payments.date"),required:""},{default:l(()=>[t(U,{modelValue:a.payment_date,"onUpdate:modelValue":r[0]||(r[0]=n=>a.payment_date=n),"calendar-button":!0},null,8,["modelValue"])]),_:1},8,["label"]),t(_,{label:e.$t("payments.amount"),required:""},{default:l(()=>{var n;return[t(j,{modelValue:a.amount,"onUpdate:modelValue":r[1]||(r[1]=d=>a.amount=d),currency:(n=f.value)==null?void 0:n.currency},null,8,["modelValue","currency"])]}),_:1},8,["label"]),t(_,{label:e.$t("payments.payment_mode"),required:""},{default:l(()=>[t(G,{modelValue:a.payment_method_id,"onUpdate:modelValue":r[2]||(r[2]=n=>a.payment_method_id=n),options:b(P).paymentModes,label:"name","value-prop":"id","track-by":"name",placeholder:e.$t("payments.select_payment_mode")},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),t(_,{label:e.$t("payments.notes")},{default:l(()=>[t(A,{modelValue:a.notes,"onUpdate:modelValue":r[3]||(r[3]=n=>a.notes=n),rows:"3"},null,8,["modelValue"])]),_:1},8,["label"])]),B("div",le,[c.value?(y(),g(h,{key:0,variant:"secondary",type:"button",onClick:v},{default:l(()=>[i(u(e.$t("general.cancel")),1)]),_:1})):Y("",!0),t(h,{variant:"primary",type:"submit"},{default:l(()=>[i(u(c.value?e.$t("general.update"):e.$t("general.create")),1)]),_:1})])],32)]),_:1})])]),_:1})}}};export{de as default};
