import{v as W,u as Q,e as b,r,K as P,o as i,w as s,b as t,c as g,L as v,t as a,M as T,a as n,q as x,s as O,j as R,P as oe,k as ee,l as le,bG as ie,Q as re,R as ce}from"./main-Ds_umSNN.js";const de={class:"flex justify-between items-center"},ue={class:"text-lg font-semibold text-gray-900"},me={class:"p-6"},ge={class:"text-sm text-gray-600 mb-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"flex flex-col items-center"},fe={class:"text-md font-semibold text-gray-900 mb-2"},be={class:"text-sm text-gray-500 text-center"},ve={class:"flex flex-col items-center"},ye={class:"text-md font-semibold text-gray-900 mb-2"},he={class:"text-sm text-gray-500 text-center"},ke={key:0,class:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg"},$e={class:"flex items-start"},xe={class:"text-sm text-blue-800"},Be={class:"font-semibold mb-1"},we={class:"list-disc list-inside space-y-1 ml-2"},Ce={key:1,class:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg"},Ie={class:"flex items-start"},Ve={class:"text-sm text-red-800"},De={class:"flex justify-end space-x-3"},ze={__name:"ConnectBank",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","connected"],setup(I,{emit:V}){const k=V,{t:z}=W.useI18n();Q();const d=b(null),B=b(!1),p=b(null),w=m=>{d.value=m,p.value=null},u=async()=>{var m,y;if(d.value){B.value=!0,p.value=null;try{const $=await O.get("/banking/oauth/start",{params:{provider:d.value}});if($.data.authorization_url)window.location.href=$.data.authorization_url;else throw new Error("No authorization URL returned")}catch($){console.error("Failed to start OAuth flow:",$),p.value=((y=(m=$.response)==null?void 0:m.data)==null?void 0:y.message)||z("banking.oauth_failed"),B.value=!1}}},f=()=>{k("update:modelValue",!1),d.value=null,p.value=null,B.value=!1},M=m=>{m.target.style.display="none"};return(m,y)=>{const $=r("BaseIcon"),D=r("BaseButton"),F=r("BaseModal");return i(),P(F,{show:I.modelValue,onClose:f,"onUpdate:show":y[2]||(y[2]=l=>m.$emit("update:modelValue",l))},{header:s(()=>[t("div",de,[t("h3",ue,a(m.$t("banking.connect_new_bank")),1)])]),footer:s(()=>[t("div",De,[n(D,{variant:"secondary",onClick:f},{default:s(()=>[x(a(m.$t("general.cancel")),1)]),_:1}),n(D,{variant:"primary",disabled:!d.value||B.value,loading:B.value,onClick:u},{default:s(()=>[x(a(m.$t("banking.connect")),1)]),_:1},8,["disabled","loading"])])]),default:s(()=>[t("div",me,[t("p",ge,a(m.$t("banking.select_bank_to_connect")),1),t("div",_e,[t("div",{class:T(["border-2 border-gray-200 rounded-lg p-6 hover:border-primary-500 hover:shadow-md transition-all cursor-pointer",{"border-primary-500 bg-primary-50":d.value==="stopanska"}]),onClick:y[0]||(y[0]=l=>w("stopanska"))},[t("div",pe,[t("img",{src:"/images/banks/stopanska-logo.png",alt:"Stopanska Banka",class:"h-16 w-auto mb-4",onError:M},null,32),t("h4",fe,a(m.$t("banking.stopanska")),1),t("p",be,a(m.$t("banking.stopanska_description")),1)])],2),t("div",{class:T(["border-2 border-gray-200 rounded-lg p-6 hover:border-primary-500 hover:shadow-md transition-all cursor-pointer",{"border-primary-500 bg-primary-50":d.value==="nlb"}]),onClick:y[1]||(y[1]=l=>w("nlb"))},[t("div",ve,[t("img",{src:"/images/banks/nlb-logo.png",alt:"NLB Banka",class:"h-16 w-auto mb-4",onError:M},null,32),t("h4",ye,a(m.$t("banking.nlb")),1),t("p",he,a(m.$t("banking.nlb_description")),1)])],2)]),d.value?(i(),g("div",ke,[t("div",$e,[n($,{name:"InformationCircleIcon",class:"h-5 w-5 text-blue-600 mt-0.5 mr-3"}),t("div",xe,[t("p",Be,a(m.$t("banking.oauth_info_title")),1),t("ul",we,[t("li",null,a(m.$t("banking.oauth_step_1")),1),t("li",null,a(m.$t("banking.oauth_step_2")),1),t("li",null,a(m.$t("banking.oauth_step_3")),1),t("li",null,a(m.$t("banking.oauth_step_4")),1)])])])])):v("",!0),p.value?(i(),g("div",Ce,[t("div",Ie,[n($,{name:"ExclamationTriangleIcon",class:"h-5 w-5 text-red-600 mt-0.5 mr-3"}),t("p",Ve,a(p.value),1)])])):v("",!0)])]),_:1},8,["show"])}}},Se={class:"relative"},Me={class:"text-sm text-gray-900"},Ne={class:"max-w-xs"},Fe={class:"text-sm font-medium text-gray-900 truncate"},Ee={key:0,class:"text-xs text-gray-500 truncate"},Pe={class:"text-right"},Te={key:0},Ue={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"},Ae={key:1},je={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Le={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},Oe={key:2,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},qe={class:"text-lg font-semibold text-gray-900"},Ge={key:0,class:"p-6 space-y-4"},Ke={class:"grid grid-cols-2 gap-4"},He={class:"text-sm font-medium text-gray-500"},Re={class:"text-sm text-gray-900"},We={class:"text-sm font-medium text-gray-500"},Qe={class:"col-span-2"},Xe={class:"text-sm font-medium text-gray-500"},Je={class:"text-sm text-gray-900"},Ye={key:0,class:"col-span-2"},Ze={class:"text-sm font-medium text-gray-500"},et={class:"text-sm text-gray-900"},tt={key:1},at={class:"text-sm font-medium text-gray-500"},nt={class:"text-sm text-gray-900"},st={key:2},ot={class:"text-sm font-medium text-gray-500"},lt={class:"text-sm text-gray-900"},it={key:3},rt={class:"text-sm font-medium text-gray-500"},ct={class:"text-sm text-gray-900"},dt={class:"text-sm font-medium text-gray-500"},ut={class:"text-sm text-gray-900"},mt={class:"flex justify-end"},gt={__name:"TransactionsList",props:{filters:{type:Object,default:()=>({})},accounts:{type:Array,default:()=>[]}},emits:["categorize"],setup(I,{expose:V,emit:k}){const z=I,{t:d}=W.useI18n(),B=Q(),p=b(null),w=b(!1),u=b(null),f=R(()=>[{label:d("banking.date"),key:"date",thClass:"text-left",tdClass:"text-left"},{label:d("banking.description"),key:"description",thClass:"text-left",tdClass:"text-left"},{label:d("banking.amount"),key:"amount",thClass:"text-right",tdClass:"text-right"},{label:d("banking.type"),key:"type",thClass:"text-center",tdClass:"text-center"},{label:d("banking.category"),key:"category",thClass:"text-left",tdClass:"text-left"},{label:d("banking.status"),key:"status",thClass:"text-center",tdClass:"text-center"},{label:"",key:"actions",thClass:"text-right",tdClass:"text-right"}]),M=async({page:l,limit:C,search:U,orderByField:N,orderBy:j})=>{var A,L,o,e;try{const _={page:l,limit:C,search:U,orderByField:N||"transaction_date",orderBy:j||"desc",...z.filters},h=await O.get("/banking/transactions",{params:_});return{data:h.data.data||[],pagination:{totalPages:((A=h.data.meta)==null?void 0:A.last_page)||1,currentPage:((L=h.data.meta)==null?void 0:L.current_page)||1,totalCount:((o=h.data.meta)==null?void 0:o.total)||0,limit:((e=h.data.meta)==null?void 0:e.per_page)||C}}}catch(_){return console.error("Failed to fetch transactions:",_),B.showNotification({type:"error",message:d("banking.failed_to_load_transactions")}),{data:[],pagination:{totalPages:1,currentPage:1,totalCount:0,limit:C}}}},m=l=>{u.value=l,w.value=!0},y=async l=>{B.showNotification({type:"info",message:d("banking.match_invoice_coming_soon")})},$=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",D=(l,C)=>{if(l==null)return"-";const U=Math.abs(l);return`${l>=0?"+":"-"} ${new Intl.NumberFormat("en-US",{style:"currency",currency:C||"MKD"}).format(U)}`};return V({refresh:()=>{p.value&&p.value.refresh()}}),(l,C)=>{const U=r("BaseButton"),N=r("BaseIcon"),j=r("BaseDropdownItem"),A=r("BaseDropdown"),L=r("BaseTable"),o=r("BaseModal");return i(),g("div",Se,[n(L,{ref_key:"tableComponent",ref:p,data:M,columns:f.value,class:"mt-3"},{"cell-date":s(({row:e})=>[t("span",Me,a($(e.data.transaction_date)),1)]),"cell-description":s(({row:e})=>[t("div",Ne,[t("p",Fe,a(e.data.description||e.data.remittance_info),1),e.data.counterparty_name?(i(),g("p",Ee,a(e.data.counterparty_name),1)):v("",!0)])]),"cell-amount":s(({row:e})=>[t("div",Pe,[t("span",{class:T(["text-sm font-semibold",e.data.amount>0?"text-green-600":"text-red-600"])},a(D(e.data.amount,e.data.currency)),3)])]),"cell-type":s(({row:e})=>[t("span",{class:T(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",e.data.amount>0?"bg-green-100 text-green-800":"bg-red-100 text-red-800"])},a(e.data.amount>0?l.$t("banking.credit"):l.$t("banking.debit")),3)]),"cell-category":s(({row:e})=>[e.data.category?(i(),g("div",Te,[t("span",Ue,a(e.data.category.name),1)])):(i(),g("div",Ae,[n(U,{variant:"link",size:"sm",onClick:_=>l.$emit("categorize",e.data)},{default:s(()=>[x(a(l.$t("banking.categorize")),1)]),_:2},1032,["onClick"])]))]),"cell-status":s(({row:e})=>[e.data.matched_invoice_id?(i(),g("span",je,[n(N,{name:"CheckCircleIcon",class:"h-3 w-3 mr-1"}),x(" "+a(l.$t("banking.matched")),1)])):e.data.processing_status==="processed"?(i(),g("span",Le,a(l.$t("banking.processed")),1)):(i(),g("span",Oe,a(l.$t("banking.pending")),1))]),"cell-actions":s(({row:e})=>[n(A,null,{activator:s(()=>[n(N,{name:"EllipsisVerticalIcon",class:"h-5 w-5 text-gray-400 cursor-pointer"})]),default:s(()=>[e.data.category?v("",!0):(i(),P(j,{key:0,onClick:_=>l.$emit("categorize",e.data)},{default:s(()=>[n(N,{name:"TagIcon",class:"mr-3 text-gray-600"}),x(" "+a(l.$t("banking.categorize")),1)]),_:2},1032,["onClick"])),n(j,{onClick:_=>m(e.data)},{default:s(()=>[n(N,{name:"EyeIcon",class:"mr-3 text-gray-600"}),x(" "+a(l.$t("general.view")),1)]),_:2},1032,["onClick"]),e.data.matched_invoice_id?v("",!0):(i(),P(j,{key:1,onClick:_=>y(e.data)},{default:s(()=>[n(N,{name:"LinkIcon",class:"mr-3 text-gray-600"}),x(" "+a(l.$t("banking.match_invoice")),1)]),_:2},1032,["onClick"]))]),_:2},1024)]),_:1},8,["columns"]),n(o,{show:w.value,onClose:C[1]||(C[1]=e=>w.value=!1),"onUpdate:show":C[2]||(C[2]=e=>w.value=e)},{header:s(()=>[t("h3",qe,a(l.$t("banking.transaction_details")),1)]),footer:s(()=>[t("div",mt,[n(U,{variant:"secondary",onClick:C[0]||(C[0]=e=>w.value=!1)},{default:s(()=>[x(a(l.$t("general.close")),1)]),_:1})])]),default:s(()=>[u.value?(i(),g("div",Ge,[t("div",Ke,[t("div",null,[t("p",He,a(l.$t("banking.date")),1),t("p",Re,a($(u.value.transaction_date)),1)]),t("div",null,[t("p",We,a(l.$t("banking.amount")),1),t("p",{class:T(["text-sm font-semibold",u.value.amount>0?"text-green-600":"text-red-600"])},a(D(u.value.amount,u.value.currency)),3)]),t("div",Qe,[t("p",Xe,a(l.$t("banking.description")),1),t("p",Je,a(u.value.description),1)]),u.value.remittance_info?(i(),g("div",Ye,[t("p",Ze,a(l.$t("banking.remittance_info")),1),t("p",et,a(u.value.remittance_info),1)])):v("",!0),u.value.counterparty_name?(i(),g("div",tt,[t("p",at,a(l.$t("banking.counterparty")),1),t("p",nt,a(u.value.counterparty_name),1)])):v("",!0),u.value.counterparty_iban?(i(),g("div",st,[t("p",ot,a(l.$t("banking.iban")),1),t("p",lt,a(u.value.counterparty_iban),1)])):v("",!0),u.value.transaction_reference?(i(),g("div",it,[t("p",rt,a(l.$t("banking.reference")),1),t("p",ct,a(u.value.transaction_reference),1)])):v("",!0),t("div",null,[t("p",dt,a(l.$t("banking.status")),1),t("p",ut,a(u.value.booking_status),1)])])])):v("",!0)]),_:1},8,["show"])])}}},_t={class:"text-lg font-semibold text-gray-900"},pt={key:0,class:"p-6 space-y-6"},ft={class:"bg-gray-50 rounded-lg p-4"},bt={class:"text-sm font-medium text-gray-900 mb-3"},vt={class:"grid grid-cols-2 gap-4"},yt={class:"text-xs text-gray-500"},ht={class:"text-sm font-medium text-gray-900"},kt={class:"text-xs text-gray-500"},$t={class:"col-span-2"},xt={class:"text-xs text-gray-500"},Bt={class:"text-sm font-medium text-gray-900"},wt={key:0,class:"col-span-2"},Ct={class:"text-xs text-gray-500"},It={class:"text-sm font-medium text-gray-900"},Vt={key:0,class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Dt={class:"flex items-start"},zt={class:"flex-1"},St={class:"text-sm font-medium text-blue-900 mb-2"},Mt={class:"text-sm text-blue-800"},Nt={class:"text-xs text-blue-600 mt-1"},Ft={class:"flex items-start"},Et={key:1,class:"text-sm text-gray-500 ml-6 -mt-4"},Pt={key:2,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Tt={class:"flex items-start"},Ut={class:"text-sm text-red-800"},At={class:"flex justify-between items-center"},jt={key:1},Lt={class:"flex space-x-3"},Ot={__name:"TransactionCategorization",props:{modelValue:{type:Boolean,required:!0},transaction:{type:Object,default:null}},emits:["update:modelValue","categorized"],setup(I,{emit:V}){const k=I,z=V,{t:d}=W.useI18n(),B=Q(),p=b(null),w=b(""),u=b(!1),f=b(null),M=b([]),m=b(!1),y=b(!1),$=b(!1),D=b(null),F=b({}),l=R(()=>M.value.map(e=>({label:e.name,value:e.id}))),C=async()=>{m.value=!0;try{const e=await O.get("/categories");M.value=e.data.data||[]}catch(e){console.error("Failed to fetch categories:",e),B.showNotification({type:"error",message:d("banking.failed_to_load_categories")})}finally{m.value=!1}},U=async()=>{var e,_;if(k.transaction){y.value=!0,D.value=null;try{const h=await O.post("/banking/transactions/suggest-category",{transaction_id:k.transaction.id,description:k.transaction.description,amount:k.transaction.amount,counterparty:k.transaction.counterparty_name});h.data.suggestion&&(f.value=h.data.suggestion)}catch(h){console.error("Failed to fetch AI suggestion:",h),D.value=((_=(e=h.response)==null?void 0:e.data)==null?void 0:_.message)||d("banking.ai_suggestion_failed")}finally{y.value=!1}}},N=()=>{f.value&&f.value.category_id&&(p.value=f.value.category_id)},j=async()=>{var e,_;if(F.value={},!p.value){F.value.category=d("validation.required");return}$.value=!0,D.value=null;try{await O.patch(`/banking/transactions/${k.transaction.id}/categorize`,{category_id:p.value,notes:w.value,create_expense:u.value}),B.showNotification({type:"success",message:d("banking.transaction_categorized")}),z("categorized"),A()}catch(h){console.error("Failed to categorize transaction:",h),D.value=((_=(e=h.response)==null?void 0:e.data)==null?void 0:_.message)||d("banking.categorization_failed")}finally{$.value=!1}},A=()=>{z("update:modelValue",!1),p.value=null,w.value="",u.value=!1,f.value=null,D.value=null,F.value={}},L=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"-",o=(e,_)=>e==null?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:_||"MKD"}).format(e);return oe(()=>k.modelValue,e=>{e&&M.value.length===0&&C()}),ee(()=>{k.modelValue&&C()}),(e,_)=>{const h=r("BaseIcon"),S=r("BaseButton"),q=r("BaseSelect"),X=r("BaseInputError"),K=r("BaseInputGroup"),H=r("BaseTextarea"),J=r("BaseCheckbox"),G=r("BaseModal");return i(),P(G,{show:I.modelValue,onClose:A,"onUpdate:show":_[3]||(_[3]=E=>e.$emit("update:modelValue",E))},{header:s(()=>[t("h3",_t,a(e.$t("banking.categorize_transaction")),1)]),footer:s(()=>[t("div",At,[f.value?(i(),g("div",jt)):(i(),P(S,{key:0,variant:"link",loading:y.value,onClick:U},{left:s(E=>[n(h,{name:"SparklesIcon",class:T(E.class)},null,8,["class"])]),default:s(()=>[x(" "+a(e.$t("banking.get_ai_suggestion")),1)]),_:1},8,["loading"])),t("div",Lt,[n(S,{variant:"secondary",onClick:A},{default:s(()=>[x(a(e.$t("general.cancel")),1)]),_:1}),n(S,{variant:"primary",disabled:!p.value||$.value,loading:$.value,onClick:j},{default:s(()=>[x(a(e.$t("general.save")),1)]),_:1},8,["disabled","loading"])])])]),default:s(()=>[I.transaction?(i(),g("div",pt,[t("div",ft,[t("h4",bt,a(e.$t("banking.transaction_summary")),1),t("div",vt,[t("div",null,[t("p",yt,a(e.$t("banking.date")),1),t("p",ht,a(L(I.transaction.transaction_date)),1)]),t("div",null,[t("p",kt,a(e.$t("banking.amount")),1),t("p",{class:T(["text-sm font-semibold",I.transaction.amount>0?"text-green-600":"text-red-600"])},a(o(I.transaction.amount,I.transaction.currency)),3)]),t("div",$t,[t("p",xt,a(e.$t("banking.description")),1),t("p",Bt,a(I.transaction.description||I.transaction.remittance_info),1)]),I.transaction.counterparty_name?(i(),g("div",wt,[t("p",Ct,a(e.$t("banking.counterparty")),1),t("p",It,a(I.transaction.counterparty_name),1)])):v("",!0)])]),f.value?(i(),g("div",Vt,[t("div",Dt,[n(h,{name:"SparklesIcon",class:"h-5 w-5 text-blue-600 mt-0.5 mr-3"}),t("div",zt,[t("p",St,a(e.$t("banking.ai_suggestion")),1),t("p",Mt,a(f.value.category_name),1),t("p",Nt,a(e.$t("banking.confidence"))+": "+a(Math.round(f.value.confidence*100))+"% ",1)]),n(S,{variant:"link",size:"sm",onClick:N},{default:s(()=>[x(a(e.$t("banking.use_suggestion")),1)]),_:1})])])):v("",!0),n(K,{label:e.$t("banking.expense_category"),required:""},{default:s(()=>[n(q,{modelValue:p.value,"onUpdate:modelValue":_[0]||(_[0]=E=>p.value=E),options:l.value,searchable:!0,"show-labels":!1,placeholder:e.$t("banking.select_category"),label:"label","value-prop":"value",invalid:F.value.category},null,8,["modelValue","options","placeholder","invalid"]),F.value.category?(i(),P(X,{key:0},{default:s(()=>[x(a(F.value.category),1)]),_:1})):v("",!0)]),_:1},8,["label"]),n(K,{label:e.$t("banking.notes")},{default:s(()=>[n(H,{modelValue:w.value,"onUpdate:modelValue":_[1]||(_[1]=E=>w.value=E),placeholder:e.$t("banking.add_notes_placeholder"),rows:"3"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t("div",Ft,[n(J,{modelValue:u.value,"onUpdate:modelValue":_[2]||(_[2]=E=>u.value=E),label:e.$t("banking.create_expense_from_transaction")},null,8,["modelValue","label"])]),u.value?(i(),g("p",Et,a(e.$t("banking.create_expense_description")),1)):v("",!0),D.value?(i(),g("div",Pt,[t("div",Tt,[n(h,{name:"ExclamationTriangleIcon",class:"h-5 w-5 text-red-600 mt-0.5 mr-3"}),t("p",Ut,a(D.value),1)])])):v("",!0)])):v("",!0)]),_:1},8,["show"])}}},qt={class:"flex items-center justify-end space-x-5"},Gt={key:1,class:"mt-6"},Kt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ht={class:"flex items-center justify-between mb-4"},Rt={class:"flex items-center"},Wt=["src","alt"],Qt={class:"text-lg font-semibold text-gray-900"},Xt={class:"text-sm text-gray-500"},Jt={class:"mb-4"},Yt={class:"text-sm text-gray-500 mb-1"},Zt={class:"text-2xl font-bold text-gray-900"},ea={class:"flex items-center justify-between text-sm text-gray-500"},ta={class:"flex items-center"},aa={key:0,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},na={key:1,class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},sa={key:2,class:"mt-6 flex justify-center"},oa={key:3,class:"mt-8"},la={class:"flex items-center justify-between mb-4"},ia={class:"text-xl font-semibold text-gray-900"},ca={__name:"BankingDashboard",setup(I){const{t:V}=W.useI18n(),k=Q(),z=b([]),d=b(!0),B=b(!1),p=b(!1),w=b(null),u=b(!1),f=b({account_id:null,from_date:null,to_date:null}),M=R(()=>!d.value&&z.value.length===0),m=R(()=>[{label:V("banking.all_accounts"),value:null},...z.value.map(o=>({label:`${o.bank_name} - ${o.account_number}`,value:o.id}))]),y=async()=>{d.value=!0;try{const o=await O.get("/banking/accounts");z.value=o.data.data||[]}catch(o){console.error("Failed to fetch connected accounts:",o),k.showNotification({type:"error",message:V("banking.failed_to_load_accounts")})}finally{d.value=!1}},$=async o=>{try{k.showNotification({type:"info",message:V("banking.syncing_account")}),await O.post(`/banking/sync/${o}`),k.showNotification({type:"success",message:V("banking.sync_successful")}),await y()}catch(e){console.error("Failed to sync account:",e),k.showNotification({type:"error",message:V("banking.sync_failed")})}},D=async o=>{if(confirm(V("banking.confirm_disconnect")))try{await O.delete(`/banking/accounts/${o}`),k.showNotification({type:"success",message:V("banking.disconnected_successfully")}),await y()}catch(e){console.error("Failed to disconnect bank:",e),k.showNotification({type:"error",message:V("banking.disconnect_failed")})}},F=()=>{B.value=!1,y(),k.showNotification({type:"success",message:V("banking.bank_connected_successfully")})},l=o=>{w.value=o,p.value=!0},C=()=>{p.value=!1,w.value=null},U=()=>{u.value=!u.value},N=()=>{f.value={account_id:null,from_date:null,to_date:null}},j=(o,e)=>o?new Intl.NumberFormat("en-US",{style:"currency",currency:e||"MKD"}).format(o):"0.00",A=o=>o?new Date(o).toLocaleDateString():V("banking.never"),L=o=>{o.target.style.display="none"};return ee(()=>{y()}),(o,e)=>{const _=r("BaseBreadcrumbItem"),h=r("BaseBreadcrumb"),S=r("BaseIcon"),q=r("BaseButton"),X=r("BasePageHeader"),K=r("BaseEmptyPlaceholder"),H=r("BaseDropdownItem"),J=r("BaseDropdown"),G=r("BaseContentPlaceholdersBox"),E=r("BaseContentPlaceholders"),te=r("BaseSelect"),Y=r("BaseInputGroup"),Z=r("BaseDatePicker"),ae=r("BaseFilterWrapper"),ne=r("BasePage");return i(),P(ne,null,{default:s(()=>[n(X,{title:o.$t("banking.title")},{actions:s(()=>[t("div",qt,[n(q,{variant:"primary",onClick:e[0]||(e[0]=c=>B.value=!0)},{left:s(c=>[n(S,{name:"PlusIcon",class:T(c.class)},null,8,["class"])]),default:s(()=>[x(" "+a(o.$t("banking.connect_bank")),1)]),_:1})])]),default:s(()=>[n(h,null,{default:s(()=>[n(_,{title:o.$t("general.home"),to:"dashboard"},null,8,["title"]),n(_,{title:o.$t("banking.title"),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),M.value?(i(),P(K,{key:0,title:o.$t("banking.no_banks_connected"),description:o.$t("banking.connect_bank_description")},{actions:s(()=>[n(q,{variant:"primary-outline",onClick:e[1]||(e[1]=c=>B.value=!0)},{left:s(c=>[n(S,{name:"PlusIcon",class:T(c.class)},null,8,["class"])]),default:s(()=>[x(" "+a(o.$t("banking.connect_first_bank")),1)]),_:1})]),default:s(()=>[n(le(ie),{class:"mt-5 mb-4 w-20 h-20 text-gray-300"})]),_:1},8,["title","description"])):v("",!0),!M.value&&!d.value?(i(),g("div",Gt,[t("div",Kt,[(i(!0),g(re,null,ce(z.value,c=>(i(),g("div",{key:c.id,class:"bg-white rounded-lg shadow-md p-6 border border-gray-200 hover:shadow-lg transition-shadow"},[t("div",Ht,[t("div",Rt,[c.bank_logo?(i(),g("img",{key:0,src:c.bank_logo,alt:c.bank_name,class:"h-10 w-auto mr-3",onError:L},null,40,Wt)):v("",!0),t("div",null,[t("h3",Qt,a(c.bank_name),1),t("p",Xt,a(c.account_number),1)])]),n(J,null,{activator:s(()=>[n(S,{name:"EllipsisVerticalIcon",class:"h-6 w-6 text-gray-400 cursor-pointer"})]),default:s(()=>[n(H,{onClick:se=>$(c.id)},{default:s(()=>[n(S,{name:"ArrowPathIcon",class:"mr-3 text-gray-600"}),x(" "+a(o.$t("banking.sync_now")),1)]),_:2},1032,["onClick"]),n(H,{onClick:se=>D(c.id)},{default:s(()=>[n(S,{name:"TrashIcon",class:"mr-3 text-red-600"}),x(" "+a(o.$t("banking.disconnect")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),t("div",Jt,[t("p",Yt,a(o.$t("banking.current_balance")),1),t("p",Zt,a(j(c.current_balance,c.currency)),1)]),t("div",ea,[t("div",ta,[n(S,{name:"ClockIcon",class:"h-4 w-4 mr-1"}),t("span",null,a(o.$t("banking.last_sync"))+": "+a(A(c.last_sync_at)),1)]),c.sync_status==="syncing"?(i(),g("span",aa,a(o.$t("banking.syncing")),1)):(i(),g("span",na,a(o.$t("banking.connected")),1))])]))),128))])])):v("",!0),d.value?(i(),g("div",sa,[n(E,null,{default:s(()=>[n(G,{rounded:!0}),n(G,{rounded:!0}),n(G,{rounded:!0})]),_:1})])):v("",!0),M.value?v("",!0):(i(),g("div",oa,[t("div",la,[t("h2",ia,a(o.$t("banking.recent_transactions")),1),z.value.length>0?(i(),P(q,{key:0,variant:"primary-outline",size:"sm",onClick:U},{right:s(c=>[u.value?(i(),P(S,{key:1,name:"XMarkIcon",class:T(c.class)},null,8,["class"])):(i(),P(S,{key:0,name:"FunnelIcon",class:T(c.class)},null,8,["class"]))]),default:s(()=>[x(a(o.$t("general.filter"))+" ",1)]),_:1})):v("",!0)]),n(ae,{show:u.value,class:"mb-4",onClear:N},{default:s(()=>[n(Y,{label:o.$t("banking.account"),class:"text-left"},{default:s(()=>[n(te,{modelValue:f.value.account_id,"onUpdate:modelValue":e[2]||(e[2]=c=>f.value.account_id=c),options:m.value,searchable:!0,"show-labels":!1,placeholder:o.$t("banking.select_account"),label:"label","value-prop":"value"},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),n(Y,{label:o.$t("general.from"),class:"text-left"},{default:s(()=>[n(Z,{modelValue:f.value.from_date,"onUpdate:modelValue":e[3]||(e[3]=c=>f.value.from_date=c),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),n(Y,{label:o.$t("general.to"),class:"text-left"},{default:s(()=>[n(Z,{modelValue:f.value.to_date,"onUpdate:modelValue":e[4]||(e[4]=c=>f.value.to_date=c),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),n(gt,{filters:f.value,accounts:z.value,onCategorize:l},null,8,["filters","accounts"])])),n(ze,{modelValue:B.value,"onUpdate:modelValue":e[5]||(e[5]=c=>B.value=c),onConnected:F},null,8,["modelValue"]),n(Ot,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=c=>p.value=c),transaction:w.value,onCategorized:C},null,8,["modelValue","transaction"])]),_:1})}}};export{ca as default};
