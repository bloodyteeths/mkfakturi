import{u as B,e as P,k as F,K as y,w as d,bA as R,n as T,o,a as l,c as r,bB as E,L as g,l as n,ar as p,q as u,bF as x,b as t,aq as L,at as f,t as c,Q as h,R as v,aw as b,m as U,M as V}from"./main-C3HD31Qx.js";import{u as O}from"./console-e4_BWoZp.js";const Y={key:0,class:"text-center py-12"},q={key:1,class:"space-y-8"},H={class:"flex items-center justify-between mb-4"},K={class:"flex items-center space-x-3"},Q={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},W={class:"p-6"},G={class:"flex items-center space-x-3 mb-4"},J=["src","alt"],X={key:1,class:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center"},Z={class:"flex-1 min-w-0"},ee={class:"font-semibold text-gray-900 truncate"},te={class:"text-sm text-blue-600 font-medium"},se={key:0,class:"text-sm text-gray-600 mb-3"},oe={class:"flex justify-between items-center pt-3 border-t border-gray-100"},ne={class:"text-sm text-gray-500"},ae={key:1,class:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"},re={key:0},ie={class:"flex items-center justify-between mb-4"},le={class:"flex items-center space-x-3"},de={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},ce={class:"p-6"},me={class:"flex items-center space-x-3 mb-4"},ue=["src","alt"],ge={key:1,class:"h-12 w-12 rounded-lg bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center"},xe={class:"flex-1 min-w-0"},ye={class:"font-semibold text-gray-900 truncate"},pe={class:"mb-3 space-y-2"},fe={class:"flex justify-between items-center text-sm"},_e={class:"font-semibold text-orange-600"},he={class:"flex justify-between items-center text-sm"},ve={class:"pt-3 border-t border-gray-100"},we={key:1,class:"text-center py-12 bg-orange-50 rounded-lg border-2 border-dashed border-orange-300"},be={key:1},ke={class:"flex items-center justify-between mb-4"},Ce={class:"flex items-center space-x-3"},Se={key:0,class:"space-y-4"},Ne={class:"p-6"},Ie={class:"flex items-start justify-between"},je={class:"flex-1"},Pe={class:"flex items-center space-x-3 mb-3"},$e={class:"h-12 w-12 rounded-lg bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center"},ze={class:"font-semibold text-gray-900"},De={class:"text-sm text-gray-600"},Me={class:"mb-3 space-y-2"},Ae={class:"text-sm text-gray-600"},Be={key:0,class:"text-sm"},Fe={key:0,class:"ml-2 text-xs text-red-600 font-semibold uppercase"},Re={key:0,class:"mb-4"},Te={class:"flex flex-wrap gap-1 mt-2"},Ee={class:"flex flex-col gap-2 ml-4"},Le={key:1,class:"text-center py-12 bg-yellow-50 rounded-lg border-2 border-dashed border-yellow-300"},Ue={key:2,class:"text-center py-16"},qe={__name:"ConsoleHome",setup(Ve){const i=O(),k=T(),w=B(),$=P(!1),_=P(null);F(async()=>{await i.fetchCompanies()});const C=async a=>{try{await i.switchCompany(a.id),k.push({name:"dashboard"})}catch(e){console.error("Failed to switch company:",e),w.showNotification({type:"error",message:"Failed to switch company. Please try again."})}},z=a=>{k.push({name:"partner.commissions",query:{company_id:a.id}})},S=async(a,e)=>{var s,m;_.value=a;try{await i.respondToInvitation(a,e),w.showNotification({type:"success",message:e==="accept"?"Invitation accepted successfully! You now have access to this company.":"Invitation declined."})}catch(j){console.error("Failed to respond to invitation:",j),w.showNotification({type:"error",message:((m=(s=j.response)==null?void 0:s.data)==null?void 0:m.message)||"Failed to process invitation response."})}finally{_.value=null}},D=a=>{try{const e=typeof a=="string"?JSON.parse(a):a;return Array.isArray(e)?e:[]}catch{return[]}},M=a=>{if(!a)return 0;try{const e=typeof a=="string"?JSON.parse(a):a;return Array.isArray(e)?e.length:0}catch{return 0}},N=a=>a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",A=a=>a?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a/100):"$0.00",I=a=>{if(!a)return!1;const e=new Date(a),m=Math.ceil((e-new Date)/(1e3*60*60*24));return m<=3&&m>=0};return(a,e)=>(o(),y(R,null,{default:d(()=>[l(E,{title:"Partner Console"},{actions:d(()=>[n(i).hasMultipleCompanies?(o(),y(p,{key:0,variant:"white",onClick:e[0]||(e[0]=s=>$.value=!0)},{left:d(()=>[l(n(x),{class:"h-5 w-5"})]),default:d(()=>[e[1]||(e[1]=u(" Switch Company ",-1))]),_:1,__:[1]})):g("",!0)]),_:1}),n(i).isLoading?(o(),r("div",Y,[l(L,{class:"mx-auto"}),e[2]||(e[2]=t("p",{class:"mt-2 text-sm text-gray-500"},"Loading companies...",-1))])):(o(),r("div",q,[t("section",null,[t("div",H,[t("div",K,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Companies I Manage",-1)),l(f,{variant:"primary",size:"sm"},{default:d(()=>[u(c(n(i).totalManaged),1)]),_:1})])]),n(i).managedCompanies.length>0?(o(),r("div",Q,[(o(!0),r(h,null,v(n(i).managedCompanies,s=>(o(),y(b,{key:s.id,class:"cursor-pointer hover:shadow-lg transition-all duration-200 border-l-4 border-l-blue-500",onClick:m=>C(s)},{default:d(()=>[t("div",W,[t("div",G,[s.logo?(o(),r("img",{key:0,src:s.logo,alt:s.name,class:"h-12 w-12 rounded-lg object-cover"},null,8,J)):(o(),r("div",X,[l(n(x),{class:"h-6 w-6 text-white"})])),t("div",Z,[t("h3",ee,c(s.name),1),t("p",te,c(s.commission_rate||0)+"% commission ",1)]),s.is_primary?(o(),y(f,{key:2,variant:"success",size:"sm"},{default:d(()=>e[4]||(e[4]=[u(" Primary ",-1)])),_:1,__:[4]})):g("",!0)]),s.address?(o(),r("div",se,c(s.address.city)+", "+c(s.address.country),1)):g("",!0),t("div",oe,[t("span",ne,c(M(s.permissions))+" permissions ",1),l(p,{size:"sm",variant:"primary",onClick:U(m=>C(s),["stop"])},{default:d(()=>e[5]||(e[5]=[u(" Manage ",-1)])),_:2,__:[5]},1032,["onClick"])])])]),_:2},1032,["onClick"]))),128))])):(o(),r("div",ae,[l(n(x),{class:"mx-auto h-12 w-12 text-gray-400"}),e[6]||(e[6]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No companies assigned",-1)),e[7]||(e[7]=t("p",{class:"mt-1 text-sm text-gray-500"}," You don't have management access to any companies yet. ",-1))]))]),n(i).referredCompanies.length>0||n(i).totalReferred>0?(o(),r("section",re,[t("div",ie,[t("div",le,[e[8]||(e[8]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Companies I Referred",-1)),l(f,{variant:"warning",size:"sm"},{default:d(()=>[u(c(n(i).totalReferred),1)]),_:1})])]),n(i).referredCompanies.length>0?(o(),r("div",de,[(o(!0),r(h,null,v(n(i).referredCompanies,s=>(o(),y(b,{key:s.id,class:"border-l-4 border-l-orange-500 hover:shadow-md transition-shadow duration-200"},{default:d(()=>[t("div",ce,[t("div",me,[s.logo?(o(),r("img",{key:0,src:s.logo,alt:s.name,class:"h-12 w-12 rounded-lg object-cover"},null,8,ue)):(o(),r("div",ge,[l(n(x),{class:"h-6 w-6 text-white"})])),t("div",xe,[t("h3",ye,c(s.name),1),e[9]||(e[9]=t("p",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Referral Only",-1))])]),t("div",pe,[t("div",fe,[e[10]||(e[10]=t("span",{class:"text-gray-600"},"Total Commissions:",-1)),t("span",_e,c(A(s.total_commissions||0)),1)]),t("div",he,[e[11]||(e[11]=t("span",{class:"text-gray-600"},"Status:",-1)),l(f,{variant:s.subscription_status==="active"?"success":"default",size:"sm"},{default:d(()=>[u(c(s.subscription_status||"Unknown"),1)]),_:2},1032,["variant"])])]),t("div",ve,[l(p,{size:"sm",variant:"warning-outline",class:"w-full",onClick:m=>z(s)},{default:d(()=>e[12]||(e[12]=[u(" View Commissions ",-1)])),_:2,__:[12]},1032,["onClick"])])])]),_:2},1024))),128))])):(o(),r("div",we,[l(n(x),{class:"mx-auto h-12 w-12 text-orange-400"}),e[13]||(e[13]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No referral tracking yet",-1)),e[14]||(e[14]=t("p",{class:"mt-1 text-sm text-gray-500"}," Companies you refer will appear here for commission tracking. ",-1))]))])):g("",!0),n(i).pendingInvitations.length>0||n(i).totalPending>0?(o(),r("section",be,[t("div",ke,[t("div",Ce,[e[15]||(e[15]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Pending Invitations",-1)),l(f,{variant:"danger",size:"sm"},{default:d(()=>[u(c(n(i).totalPending),1)]),_:1})])]),n(i).pendingInvitations.length>0?(o(),r("div",Se,[(o(!0),r(h,null,v(n(i).pendingInvitations,s=>(o(),y(b,{key:s.id,class:"border-l-4 border-l-yellow-500 hover:shadow-md transition-shadow duration-200"},{default:d(()=>[t("div",Ne,[t("div",Ie,[t("div",je,[t("div",Pe,[t("div",$e,[l(n(x),{class:"h-6 w-6 text-white"})]),t("div",null,[t("h3",ze,c(s.company_name),1),t("p",De," Invited by "+c(s.inviter_name||"Company Admin"),1)])]),t("div",Me,[t("div",Ae,[e[16]||(e[16]=t("span",{class:"font-medium"},"Invited:",-1)),u(" "+c(N(s.invited_at)),1)]),s.expires_at?(o(),r("div",Be,[e[17]||(e[17]=t("span",{class:"font-medium text-gray-600"},"Expires:",-1)),t("span",{class:V(I(s.expires_at)?"text-red-600 font-semibold":"text-gray-600")},c(N(s.expires_at)),3),I(s.expires_at)?(o(),r("span",Fe," Expiring Soon! ")):g("",!0)])):g("",!0)]),s.permissions?(o(),r("div",Re,[e[18]||(e[18]=t("span",{class:"text-xs font-medium text-gray-700 uppercase tracking-wide"},"Permissions Offered:",-1)),t("div",Te,[(o(!0),r(h,null,v(D(s.permissions),m=>(o(),r("span",{key:m,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-md"},c(m),1))),128))])])):g("",!0)]),t("div",Ee,[l(p,{variant:"primary",size:"sm",onClick:m=>S(s.id,"accept"),loading:_.value===s.id},{default:d(()=>e[19]||(e[19]=[u(" Accept ",-1)])),_:2,__:[19]},1032,["onClick","loading"]),l(p,{variant:"danger-outline",size:"sm",onClick:m=>S(s.id,"decline"),loading:_.value===s.id},{default:d(()=>e[20]||(e[20]=[u(" Decline ",-1)])),_:2,__:[20]},1032,["onClick","loading"])])])])]),_:2},1024))),128))])):(o(),r("div",Le,[l(n(x),{class:"mx-auto h-12 w-12 text-yellow-400"}),e[21]||(e[21]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No pending invitations",-1)),e[22]||(e[22]=t("p",{class:"mt-1 text-sm text-gray-500"}," You don't have any pending company invitations at this time. ",-1))]))])):g("",!0),n(i).managedCompanies.length===0&&n(i).referredCompanies.length===0&&n(i).pendingInvitations.length===0?(o(),r("div",Ue,[l(n(x),{class:"mx-auto h-16 w-16 text-gray-400"}),e[23]||(e[23]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Welcome to the Partner Console",-1)),e[24]||(e[24]=t("p",{class:"mt-2 text-sm text-gray-500 max-w-md mx-auto"}," You don't have any companies assigned yet. Contact your administrator to get access to company accounts or wait for company invitations. ",-1))])):g("",!0)]))]),_:1}))}};export{qe as default};
