import{v as Z,u as ee,H as te,e as f,I as ae,j as se,k as ne,K as P,w as a,s as w,r as l,n as oe,o as u,a as s,c as $,L as D,ag as T,b as o,q as _,t as n,M as g,aB as j,l as M}from"./main-Ds_umSNN.js";import{_ as re}from"./AstronautIcon-C8b_eo1n.js";const le={class:"flex items-center justify-end space-x-5"},ce={value:""},ie={value:"active"},de={value:"inactive"},ue={value:""},pe={value:"pending"},me={value:"under_review"},_e={value:"approved"},ge={value:"rejected"},ye={key:0,class:"grid grid-cols-1 gap-4 mt-6 md:grid-cols-4"},ve={class:"p-4 bg-white border border-gray-200 rounded-lg"},he={class:"text-sm text-gray-500"},fe={class:"text-2xl font-semibold"},be={class:"p-4 bg-white border border-gray-200 rounded-lg"},ke={class:"text-sm text-gray-500"},$e={class:"text-2xl font-semibold text-green-600"},Be={class:"p-4 bg-white border border-gray-200 rounded-lg"},xe={class:"text-sm text-gray-500"},Ie={class:"text-2xl font-semibold text-purple-600"},Pe={class:"p-4 bg-white border border-gray-200 rounded-lg"},we={class:"text-sm text-gray-500"},Ce={class:"text-2xl font-semibold text-orange-600"},Se={class:"relative mt-6 table-container"},Ve={class:"text-xs text-gray-400"},Fe={class:"text-sm"},Ee={class:"px-2 py-1 text-xs font-medium text-gray-700 bg-gray-100 rounded"},Ne={key:0},De={key:1},Te={key:0,class:"ml-2 px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded"},Ge={__name:"Index",setup(je){const{t:d}=Z.useI18n();oe();const C=ee(),S=te(),V=f(null),b=f(!1),p=f(null),c=ae({search:"",status:"",kyc_status:""}),H=f([{key:"name",label:d("partners.name"),thClass:"extra",tdClass:"font-medium text-gray-900",sortable:!0},{key:"company_name",label:d("partners.company_name"),sortable:!0},{key:"companies_count",label:d("partners.companies"),sortable:!0},{key:"total_earnings",label:d("partners.total_earnings"),sortable:!0},{key:"status",label:d("general.status"),sortable:!0},{key:"kyc_status",label:d("partners.kyc_status"),sortable:!0},{key:"actions",label:"",tdClass:"text-right"}]),B=se(()=>{const e=y.value===0;return console.log("[Partners Index] showEmptyScreen computed:",{totalPartners:y.value,isEmpty:e}),e}),y=f(null);async function G({page:e,filter:i,sort:v}){var m;const k={page:e,per_page:15,search:c.search,status:c.status,kyc_status:c.kyc_status,sort_by:v.fieldName||"created_at",sort_order:v.order||"desc"};console.log("[Partners Index] Fetching data with params:",k);const r=await w.get("/partners",{params:k});return console.log("[Partners Index] Response received:",{total:r.data.total,dataLength:(m=r.data.data)==null?void 0:m.length,currentPage:r.data.current_page,lastPage:r.data.last_page}),y.value=r.data.total,console.log("[Partners Index] totalPartners.value set to:",y.value),console.log("[Partners Index] showEmptyScreen computed:",B.value),{data:r.data.data,pagination:{totalPages:r.data.last_page,currentPage:r.data.current_page,count:r.data.total}}}async function F(){try{const e=await w.get("/partners/stats");p.value=e.data}catch(e){console.error("Failed to fetch partner stats:",e)}}function U(){b.value=!b.value}function z(){c.search="",c.status="",c.kyc_status="",E()}function E(){var e;(e=V.value)==null||e.refresh()}async function L(e){if(confirm(d("partners.confirm_deactivate")))try{await w.delete(`/partners/${e}`),C.showNotification({type:"success",message:d("partners.deactivated_successfully")}),E(),F()}catch{C.showNotification({type:"error",message:d("partners.deactivate_failed")})}}return ne(()=>{console.log("[Partners Index] Component mounted"),console.log("[Partners Index] totalPartners initial value:",y.value),F()}),(e,i)=>{const v=l("BaseBreadcrumbItem"),k=l("BaseBreadcrumb"),r=l("BaseIcon"),m=l("BaseButton"),R=l("BasePageHeader"),W=l("BaseInput"),x=l("BaseInputGroup"),N=l("BaseSelect"),q=l("BaseFilterWrapper"),K=l("BaseEmptyPlaceholder"),X=l("BaseText"),A=l("router-link"),J=l("BaseFormatMoney"),I=l("BaseDropdownItem"),O=l("BaseDropdown"),Q=l("BaseTable"),Y=l("BasePage");return u(),P(Y,null,{default:a(()=>[s(R,{title:e.$t("partners.title",2)},{actions:a(()=>[o("div",le,[s(m,{variant:"primary-outline",onClick:U},{right:a(t=>[b.value?(u(),P(r,{key:1,name:"XMarkIcon",class:g(t.class)},null,8,["class"])):(u(),P(r,{key:0,name:"FunnelIcon",class:g(t.class)},null,8,["class"]))]),default:a(()=>[_(n(e.$t("general.filter"))+" ",1)]),_:1}),s(m,{onClick:i[0]||(i[0]=t=>e.$router.push("/admin/partners/create"))},{left:a(t=>[s(r,{name:"PlusIcon",class:g(t.class)},null,8,["class"])]),default:a(()=>[_(" "+n(e.$t("partners.new_partner")),1)]),_:1})])]),default:a(()=>[s(k,null,{default:a(()=>[s(v,{title:e.$t("general.home"),to:"dashboard"},null,8,["title"]),s(v,{title:e.$t("partners.title",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),s(q,{show:b.value,class:"mt-5",onClear:z},{default:a(()=>[s(x,{label:e.$t("general.search"),class:"text-left"},{default:a(()=>[s(W,{modelValue:c.search,"onUpdate:modelValue":i[1]||(i[1]=t=>c.search=t),type:"text",name:"search",autocomplete:"off",placeholder:e.$t("partners.search_placeholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(x,{label:e.$t("general.status"),class:"text-left"},{default:a(()=>[s(N,{modelValue:c.status,"onUpdate:modelValue":i[2]||(i[2]=t=>c.status=t)},{default:a(()=>[o("option",ce,n(e.$t("general.all")),1),o("option",ie,n(e.$t("general.active")),1),o("option",de,n(e.$t("general.inactive")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(x,{label:e.$t("partners.kyc_status"),class:"text-left"},{default:a(()=>[s(N,{modelValue:c.kyc_status,"onUpdate:modelValue":i[3]||(i[3]=t=>c.kyc_status=t)},{default:a(()=>[o("option",ue,n(e.$t("general.all")),1),o("option",pe,n(e.$t("partners.kyc.pending")),1),o("option",me,n(e.$t("partners.kyc.under_review")),1),o("option",_e,n(e.$t("partners.kyc.approved")),1),o("option",ge,n(e.$t("partners.kyc.rejected")),1)]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),p.value?(u(),$("div",ye,[o("div",ve,[o("div",he,n(e.$t("partners.stats.total_partners")),1),o("div",fe,n(p.value.total_partners),1)]),o("div",be,[o("div",ke,n(e.$t("partners.stats.active_partners")),1),o("div",$e,n(p.value.active_partners),1)]),o("div",Be,[o("div",xe,n(e.$t("partners.stats.partner_plus")),1),o("div",Ie,n(p.value.partner_plus_count),1)]),o("div",Pe,[o("div",we,n(e.$t("partners.stats.pending_kyc")),1),o("div",Ce,n(p.value.pending_kyc),1)])])):D("",!0),T(s(K,{title:e.$t("partners.no_partners"),description:e.$t("partners.list_description")},{actions:a(()=>[s(m,{variant:"primary-outline",onClick:i[4]||(i[4]=t=>e.$router.push("/admin/partners/create"))},{left:a(t=>[s(r,{name:"PlusIcon",class:g(t.class)},null,8,["class"])]),default:a(()=>[_(" "+n(e.$t("partners.add_new_partner")),1)]),_:1})]),default:a(()=>[s(re,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[j,B.value]]),T(o("div",Se,[s(Q,{ref_key:"tableComponent",ref:V,data:G,columns:H.value,class:"mt-3"},{"cell-name":a(({row:t})=>[s(A,{to:{path:`partners/${t.data.id}/view`}},{default:a(()=>[s(X,{text:t.data.name,tag:"span",class:"font-medium text-primary-500"},null,8,["text"]),o("div",Ve,n(t.data.email),1)]),_:2},1032,["to"])]),"cell-company_name":a(({row:t})=>[o("span",Fe,n(t.data.company_name||"-"),1)]),"cell-companies_count":a(({row:t})=>[o("span",Ee,n(t.data.companies_count||0),1)]),"cell-total_earnings":a(({row:t})=>{var h;return[(h=M(S).companySettings)!=null&&h.currency?(u(),$("span",Ne,[s(J,{amount:t.data.total_earnings||0,currency:M(S).companySettings.currency},null,8,["amount","currency"])])):(u(),$("span",De,n((t.data.total_earnings||0).toFixed(2)),1))]}),"cell-status":a(({row:t})=>[o("span",{class:g(["px-2 py-1 text-xs font-medium rounded",t.data.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},n(t.data.is_active?e.$t("general.active"):e.$t("general.inactive")),3),t.data.is_partner_plus?(u(),$("span",Te," Plus ")):D("",!0)]),"cell-kyc_status":a(({row:t})=>[o("span",{class:g(["px-2 py-1 text-xs font-medium rounded",{"bg-gray-100 text-gray-800":t.data.kyc_status==="pending","bg-yellow-100 text-yellow-800":t.data.kyc_status==="under_review","bg-green-100 text-green-800":t.data.kyc_status==="approved","bg-red-100 text-red-800":t.data.kyc_status==="rejected"}])},n(e.$t(`partners.kyc.${t.data.kyc_status||"pending"}`)),3)]),"cell-actions":a(({row:t})=>[s(O,null,{activator:a(()=>[s(r,{name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"})]),default:a(()=>[s(I,{onClick:h=>e.$router.push(`/admin/partners/${t.data.id}/view`)},{default:a(()=>[s(r,{name:"EyeIcon",class:"mr-3 text-gray-600"}),_(" "+n(e.$t("general.view")),1)]),_:2},1032,["onClick"]),s(I,{onClick:h=>e.$router.push(`/admin/partners/${t.data.id}/edit`)},{default:a(()=>[s(r,{name:"PencilIcon",class:"mr-3 text-gray-600"}),_(" "+n(e.$t("general.edit")),1)]),_:2},1032,["onClick"]),s(I,{onClick:h=>L(t.data.id)},{default:a(()=>[s(r,{name:"TrashIcon",class:"mr-3 text-gray-600"}),_(" "+n(e.$t("general.deactivate")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["columns"])],512),[[j,!B.value]])]),_:1})}}};export{Ge as default};
