import{bg as j,N as U,v as O,e as L,I as C,S as J,j as $,k as W,r as c,c as p,o as a,b as n,a as s,w as u,l as r,t as b,K as h,L as i,Q as X,R as Z,M as G,q as R,P as ee,p as te,O as ae,n as se,V as z}from"./main-Ds_umSNN.js";import{_ as le}from"./SupplierIndexDropdown-CrkhnX5l.js";import{L as ne}from"./LoadingIcon-C_CG-rF2.js";import{_ as oe}from"./LineChart-4mSxrko3.js";const re={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.6rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},ie={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},ue={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},ce={class:"px-4 py-3 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},de={class:"px-2"},pe={class:"px-2"},me={class:"flex-1 font-bold text-right whitespace-nowrap"},_e={key:0,class:"flex justify-center p-4 items-center"},ye={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},ve={__name:"SupplierViewSidebar",setup(M){const I=j(),t=U(),{t:m}=O.useI18n();let d=L(!1),e=C({orderBy:null,orderByField:null,searchText:null});const x=L(null),S=L(1),_=L(1),k=L(null);w=J.debounce(w,500);const g=$(()=>e.orderBy==="asc"||e.orderBy==null);$(()=>g.value?m("general.ascending"):m("general.descending"));function T(o){return t.params.id==o}async function v(o,l=!1){if(d.value)return;let y={};e.searchText!==""&&e.searchText!==null&&e.searchText!==void 0&&(y.search=e.searchText),e.orderBy!==null&&e.orderBy!==void 0&&(y.orderBy=e.orderBy),e.orderByField!==null&&e.orderByField!==void 0&&(y.orderByField=e.orderByField),y.page=o,d.value=!0;try{let B=await I.fetchSuppliers(y);l?x.value=[...x.value,...B.data.data]:x.value=B.data.data,S.value=B.data.meta.current_page,_.value=B.data.meta.last_page}catch(B){console.error(B)}finally{d.value=!1}}async function w(){v(1,!1)}function V(){return e.orderBy==="asc"?(e.orderBy="desc",v(1,!1),!0):(e.orderBy="asc",v(1,!1),!0)}function D(){const o=k.value;o.scrollTop+o.clientHeight>=o.scrollHeight-10&&S.value<_.value&&v(S.value+1,!0)}return W(()=>{v(1,!1),k.value&&k.value.addEventListener("scroll",D)}),(o,l)=>{var H;const y=c("BaseIcon"),B=c("BaseInput"),F=c("BaseButton"),E=c("BaseRadio"),P=c("BaseInputGroup"),N=c("BaseDropdownItem"),q=c("BaseDropdown"),A=c("BaseText"),Y=c("BaseFormatMoney"),K=c("router-link");return a(),p("div",re,[n("div",ie,[s(B,{modelValue:r(e).searchText,"onUpdate:modelValue":l[0]||(l[0]=f=>r(e).searchText=f),placeholder:o.$t("general.search"),"container-class":"mb-6",type:"text",variant:"gray",onInput:l[1]||(l[1]=f=>w())},{default:u(()=>[s(y,{name:"MagnifyingGlassIcon",class:"text-gray-500"})]),_:1},8,["modelValue","placeholder"]),n("div",ue,[s(q,{"close-on-select":!1,position:"bottom-start","width-class":"w-40","position-class":"left-0"},{activator:u(()=>[s(F,{variant:"gray"},{default:u(()=>[s(y,{name:"FunnelIcon"})]),_:1})]),default:u(()=>[n("div",ce,b(o.$t("general.sort_by")),1),n("div",de,[s(N,{class:"flex px-1 py-2 mt-1 cursor-pointer hover:rounded-md"},{default:u(()=>[s(P,{class:"pt-2 -mt-4"},{default:u(()=>[s(E,{id:"filter_create_date",modelValue:r(e).orderByField,"onUpdate:modelValue":[l[2]||(l[2]=f=>r(e).orderByField=f),w],label:o.$t("customers.create_date"),size:"sm",name:"filter",value:"created_at"},null,8,["modelValue","label"])]),_:1})]),_:1})]),n("div",pe,[s(N,{class:"flex px-1 cursor-pointer hover:rounded-md"},{default:u(()=>[s(P,{class:"pt-2 -mt-4"},{default:u(()=>[s(E,{id:"filter_display_name",modelValue:r(e).orderByField,"onUpdate:modelValue":[l[3]||(l[3]=f=>r(e).orderByField=f),w],label:o.$t("suppliers.name"),size:"sm",name:"filter",value:"name"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),s(F,{class:"ml-1",size:"md",variant:"gray",onClick:V},{default:u(()=>[g.value?(a(),h(y,{key:0,name:"SortAscendingIcon"})):(a(),h(y,{key:1,name:"SortDescendingIcon"}))]),_:1})])]),n("div",{ref_key:"supplierListSection",ref:k,class:"h-full overflow-y-scroll border-l border-gray-200 border-solid sidebar base-scroll"},[(a(!0),p(X,null,Z(x.value,(f,Q)=>(a(),p("div",{key:Q},[f?(a(),h(K,{key:0,id:"supplier-"+f.id,to:`/admin/suppliers/${f.id}/view`,class:G(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":T(f.id)}]),style:{"border-top":"1px solid rgba(185, 193, 209, 0.41)"}},{default:u(()=>[n("div",null,[s(A,{text:f.name,class:"pr-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),f.contact_name?(a(),h(A,{key:0,text:f.contact_name,class:"mt-1 text-xs not-italic font-medium leading-5 text-gray-600"},null,8,["text"])):i("",!0)]),n("div",me,[s(Y,{amount:f.due_amount!==null?f.due_amount:0,currency:f.currency},null,8,["amount","currency"])])]),_:2},1032,["id","to","class"])):i("",!0)]))),128)),r(d)?(a(),p("div",_e,[s(ne,{class:"h-6 m-1 animate-spin text-primary-400"})])):i("",!0),!((H=x.value)!=null&&H.length)&&!r(d)?(a(),p("p",ye,b(o.$t("suppliers.no_matching_suppliers")),1)):i("",!0)],512)])}}},fe={class:"pt-6 mt-5 border-t border-solid lg:pt-8 md:pt-4 border-gray-200"},be=["href"],he={key:0},ge={key:0},xe={key:0},Be={key:1},$e={key:2},ke={key:1},we={__name:"SupplierInfo",setup(M){const I=j(),t=$(()=>I.selectedSupplier||{}),m=$(()=>I.isFetchingView),d=$(()=>t.value?!!(t.value.address_street_1||t.value.address_street_2||t.value.city||t.value.state||t.value.zip||t.value.country):!1);return(e,x)=>{const S=c("BaseHeading"),_=c("BaseDescriptionListItem"),k=c("BaseDescriptionList");return a(),p("div",fe,[s(S,null,{default:u(()=>[R(b(e.$t("customers.basic_info")),1)]),_:1}),s(k,null,{default:u(()=>{var g,T,v;return[t.value.name?(a(),h(_,{key:0,"content-loading":m.value,label:e.$t("suppliers.name"),value:(g=t.value)==null?void 0:g.name},null,8,["content-loading","label","value"])):i("",!0),t.value.contact_name?(a(),h(_,{key:1,"content-loading":m.value,label:e.$t("customers.primary_contact_name"),value:(T=t.value)==null?void 0:T.contact_name},null,8,["content-loading","label","value"])):i("",!0),t.value.email?(a(),h(_,{key:2,"content-loading":m.value,label:e.$t("suppliers.email"),value:(v=t.value)==null?void 0:v.email},null,8,["content-loading","label","value"])):i("",!0)]}),_:1}),s(k,{class:"mt-5"},{default:u(()=>{var g,T,v,w,V,D;return[s(_,{"content-loading":m.value,label:e.$t("wizard.currency"),value:(g=t.value)!=null&&g.currency?`${(v=(T=t.value)==null?void 0:T.currency)==null?void 0:v.code} (${(V=(w=t.value)==null?void 0:w.currency)==null?void 0:V.symbol})`:""},null,8,["content-loading","label","value"]),t.value.phone?(a(),h(_,{key:0,"content-loading":m.value,label:e.$t("suppliers.phone"),value:(D=t.value)==null?void 0:D.phone},null,8,["content-loading","label","value"])):i("",!0),t.value.website?(a(),h(_,{key:1,"content-loading":m.value,label:e.$t("suppliers.website")},{default:u(()=>[t.value.website?(a(),p("a",{key:0,href:t.value.website,target:"_blank",rel:"noopener noreferrer",class:"text-primary-500 hover:underline"},b(t.value.website),9,be)):i("",!0)]),_:1},8,["content-loading","label"])):i("",!0)]}),_:1}),d.value?(a(),h(S,{key:0,class:"mt-8"},{default:u(()=>[R(b(e.$t("customers.address")),1)]),_:1})):i("",!0),d.value?(a(),h(k,{key:1,class:"mt-5"},{default:u(()=>[s(_,{"content-loading":m.value,label:e.$t("customers.billing_address")},{default:u(()=>[t.value.address_street_1?(a(),p("div",he,[n("p",null,b(t.value.address_street_1),1),t.value.address_street_2?(a(),p("p",ge,b(t.value.address_street_2),1)):i("",!0),n("p",null,[t.value.city?(a(),p("span",xe,b(t.value.city),1)):i("",!0),t.value.state?(a(),p("span",Be,", "+b(t.value.state),1)):i("",!0),t.value.zip?(a(),p("span",$e,b(t.value.zip),1)):i("",!0)]),t.value.country?(a(),p("p",ke,b(t.value.country),1)):i("",!0)])):i("",!0)]),_:1},8,["content-loading","label"])]),_:1})):i("",!0)])}}},Se={key:0,class:"p-8"},Ie={key:1,class:"grid grid-cols-12"},Te={class:"col-span-12 xl:col-span-9 xxl:col-span-10"},Ve={class:"flex justify-between mt-1 mb-6"},De={class:"flex items-center"},Fe={class:"w-40 h-10"},Le={class:"grid col-span-12 mt-6 text-center xl:mt-0 sm:grid-cols-4 xl:text-right xl:col-span-3 xl:grid-cols-1 xxl:col-span-2"},Pe={class:"px-6 py-2"},Ee={class:"text-xs leading-5 lg:text-sm"},Ce={key:0,class:"block mt-1 text-xl font-semibold leading-8"},Re={class:"px-6 py-2"},je={class:"text-xs leading-5 lg:text-sm"},Me={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#00c99c"}},ze={class:"px-6 py-2"},Ue={class:"text-xs leading-5 lg:text-sm"},Ne={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#fb7178"}},Ae={class:"px-6 py-2"},He={class:"text-xs leading-5 lg:text-sm"},Oe={key:0,class:"block mt-1 text-xl font-semibold leading-8",style:{color:"#5851d8"}},Ge={__name:"SupplierChart",setup(M){const I=j(),{t}=O.useI18n(),m=U();let d=L(!1),e=C({}),x=C({}),S=C([{label:t("dateRange.this_year"),value:"This year"},{label:t("dateRange.previous_year"),value:"Previous year"}]),_=L("This year");const k=$(()=>e.expenseTotals?e.expenseTotals:[]),g=$(()=>e.netProfits?e.netProfits:[]),T=$(()=>e&&e.months?e.months:[]),v=$(()=>e.paymentTotals?e.paymentTotals:[]),w=$(()=>e.billTotals?e.billTotals:[]);ee(m,()=>{m.params.id&&V(),_.value="This year"},{immediate:!0});async function V(){var l;d.value=!1;let o=await I.fetchViewSupplier({id:m.params.id});o.data&&(Object.assign(e,((l=o.data.meta)==null?void 0:l.chartData)||{}),Object.assign(x,o.data.data)),d.value=!0}async function D(o){var B;let l={id:m.params.id};o==="Previous year"?l.previous_year=!0:l.this_year=!0;let y=await I.fetchViewSupplier(l);return(B=y.data.meta)!=null&&B.chartData&&Object.assign(e,y.data.meta.chartData),!0}return(o,l)=>{const y=c("BaseIcon"),B=c("BaseMultiselect"),F=c("BaseFormatMoney"),E=c("BaseCard");return a(),h(E,{class:"flex flex-col mt-6"},{default:u(()=>[r(I).isFetchingView?(a(),p("div",Se,l[1]||(l[1]=[n("div",{class:"animate-pulse"},[n("div",{class:"h-6 bg-gray-200 rounded w-1/4 mb-4"}),n("div",{class:"h-64 bg-gray-200 rounded"})],-1)]))):(a(),p("div",Ie,[n("div",Te,[n("div",Ve,[n("h6",De,[s(y,{name:"ChartBarSquareIcon",class:"h-5 text-primary-400"}),R(" "+b(o.$t("dashboard.monthly_chart.title")),1)]),n("div",Fe,[s(B,{modelValue:r(_),"onUpdate:modelValue":l[0]||(l[0]=P=>te(_)?_.value=P:_=P),options:r(S),"allow-empty":!1,"show-labels":!1,placeholder:o.$t("dashboard.select_year"),"can-deselect":!1,onSelect:D},null,8,["modelValue","options","placeholder"])])]),r(d)?(a(),h(oe,{key:0,invoices:w.value,expenses:k.value,receipts:v.value,income:g.value,labels:T.value,class:"sm:w-full"},null,8,["invoices","expenses","receipts","income","labels"])):i("",!0)]),n("div",Le,[n("div",Pe,[n("span",Ee,b(o.$t("dashboard.chart_info.total_sales")),1),l[2]||(l[2]=n("br",null,null,-1)),r(d)?(a(),p("span",Ce,[s(F,{amount:r(e).billsTotal,currency:r(x).currency},null,8,["amount","currency"])])):i("",!0)]),n("div",Re,[n("span",je,b(o.$t("dashboard.chart_info.total_receipts")),1),l[3]||(l[3]=n("br",null,null,-1)),r(d)?(a(),p("span",Me,[s(F,{amount:r(e).paymentsTotal,currency:r(x).currency},null,8,["amount","currency"])])):i("",!0)]),n("div",ze,[n("span",Ue,b(o.$t("dashboard.chart_info.total_expense")),1),l[4]||(l[4]=n("br",null,null,-1)),r(d)?(a(),p("span",Ne,[s(F,{amount:r(e).totalExpenses,currency:r(x).currency},null,8,["amount","currency"])])):i("",!0)]),n("div",Ae,[n("span",He,b(o.$t("dashboard.chart_info.net_income")),1),l[5]||(l[5]=n("br",null,null,-1)),r(d)?(a(),p("span",Oe,[s(F,{amount:r(e).netProfit,currency:r(x).currency},null,8,["amount","currency"])])):i("",!0)])])])),s(we)]),_:1})}}},Je={__name:"View",setup(M){const I=U(),t=se(),m=j(),d=ae(),e=$(()=>m.selectedSupplier),x=$(()=>e.value?e.value.name:""),S=$(()=>m.isFetchingView||!1);function _(){return d.hasAbilities([z.DELETE_SUPPLIER,z.EDIT_SUPPLIER])}function k(){t.push("/admin/suppliers")}return(g,T)=>{const v=c("BaseBreadcrumbItem"),w=c("BaseBreadcrumb"),V=c("BaseButton"),D=c("router-link"),o=c("BasePageHeader"),l=c("BasePage");return a(),h(l,{class:"xl:pl-96"},{default:u(()=>[s(o,{title:x.value},{actions:u(()=>[r(d).hasAbilities(r(z).EDIT_SUPPLIER)?(a(),h(D,{key:0,to:`/admin/suppliers/${r(I).params.id}/edit`},{default:u(()=>[s(V,{class:"mr-3",variant:"primary-outline","content-loading":S.value},{default:u(()=>[R(b(g.$t("general.edit")),1)]),_:1},8,["content-loading"])]),_:1},8,["to"])):i("",!0),_()?(a(),h(le,{key:1,class:G({"ml-3":S.value}),row:e.value||{},"load-data":k},null,8,["class","row"])):i("",!0)]),default:u(()=>[s(w,null,{default:u(()=>{var y;return[s(v,{title:g.$t("general.home"),to:"dashboard"},null,8,["title"]),s(v,{title:g.$t("suppliers.title"),to:"/admin/suppliers"},null,8,["title"]),s(v,{title:((y=e.value)==null?void 0:y.name)||g.$t("suppliers.view_supplier"),to:"#",active:""},null,8,["title"])]}),_:1})]),_:1},8,["title"]),s(ve),s(Ge)]),_:1})}}};export{Je as default};
