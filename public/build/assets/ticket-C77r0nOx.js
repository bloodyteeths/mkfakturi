import{a6 as k,s as r,a3 as a}from"./main-rC5xHABW.js";const d=k({id:"ticket",state:()=>({tickets:[],currentTicket:null,selectedTickets:[],selectAllField:!1,ticketTotalCount:0,isFetchingTickets:!1,isFetchingTicket:!1,categories:[],labels:[],filters:{status:"",priority:"",category_id:null,search:""}}),getters:{getTicket:e=>i=>{const c=parseInt(i);return e.tickets.find(t=>t.id===c)},openTicketsCount:e=>e.tickets.filter(i=>i.status==="open").length,urgentTicketsCount:e=>e.tickets.filter(i=>i.priority==="urgent").length},actions:{fetchTickets(e){return new Promise((i,c)=>{this.isFetchingTickets=!0,r.get("/support/tickets",{params:e}).then(t=>{this.tickets=t.data.data,this.ticketTotalCount=t.data.meta.ticket_total_count,i(t)}).catch(t=>{a(t),c(t)}).finally(()=>{this.isFetchingTickets=!1})})},fetchTicket(e){return new Promise((i,c)=>{this.isFetchingTicket=!0,r.get(`/support/tickets/${e}`).then(t=>{this.currentTicket=t.data.data,i(t)}).catch(t=>{a(t),c(t)}).finally(()=>{this.isFetchingTicket=!1})})},createTicket(e){return new Promise((i,c)=>{r.post("/support/tickets",e).then(t=>{this.tickets.unshift(t.data.data),this.ticketTotalCount++,i(t)}).catch(t=>{a(t),c(t)})})},updateTicket(e,i){return new Promise((c,t)=>{r.put(`/support/tickets/${e}`,i).then(s=>{const n=this.tickets.findIndex(h=>h.id===e);n!==-1&&(this.tickets[n]=s.data.data),this.currentTicket&&this.currentTicket.id===e&&(this.currentTicket=s.data.data),c(s)}).catch(s=>{a(s),t(s)})})},deleteTicket(e){return new Promise((i,c)=>{r.delete(`/support/tickets/${e}`).then(t=>{const s=this.tickets.findIndex(n=>n.id===e);s!==-1&&(this.tickets.splice(s,1),this.ticketTotalCount--),i(t)}).catch(t=>{a(t),c(t)})})},deleteMultipleTickets(e){return new Promise((i,c)=>{r.post("/support/tickets/delete",{ids:e}).then(t=>{e.forEach(s=>{const n=this.tickets.findIndex(h=>h.id===s);n!==-1&&(this.tickets.splice(n,1),this.ticketTotalCount--)}),this.selectedTickets=[],i(t)}).catch(t=>{a(t),c(t)})})},fetchTicketMessages(e){return new Promise((i,c)=>{r.get(`/support/tickets/${e}/messages`).then(t=>{this.currentTicket&&this.currentTicket.id===e&&(this.currentTicket.messages=t.data.data),i(t)}).catch(t=>{a(t),c(t)})})},replyToTicket(e,i){return new Promise((c,t)=>{r.post(`/support/tickets/${e}/messages`,i).then(s=>{this.currentTicket&&this.currentTicket.id===e&&(this.currentTicket.messages||(this.currentTicket.messages=[]),this.currentTicket.messages.push(s.data.data)),c(s)}).catch(s=>{a(s),t(s)})})},updateMessage(e,i,c){return new Promise((t,s)=>{r.put(`/support/tickets/${e}/messages/${i}`,c).then(n=>{if(this.currentTicket&&this.currentTicket.id===e){const h=this.currentTicket.messages.findIndex(l=>l.id===i);h!==-1&&(this.currentTicket.messages[h]=n.data.data)}t(n)}).catch(n=>{a(n),s(n)})})},deleteMessage(e,i){return new Promise((c,t)=>{r.delete(`/support/tickets/${e}/messages/${i}`).then(s=>{if(this.currentTicket&&this.currentTicket.id===e){const n=this.currentTicket.messages.findIndex(h=>h.id===i);n!==-1&&this.currentTicket.messages.splice(n,1)}c(s)}).catch(s=>{a(s),t(s)})})},selectAllTickets(){this.selectedTickets=this.tickets.map(e=>e.id),this.selectAllField=!0},deselectAllTickets(){this.selectedTickets=[],this.selectAllField=!1},selectTicket(e){this.selectedTickets=e,this.selectedTickets.length===this.tickets.length?this.selectAllField=!0:this.selectAllField=!1},resetCurrentTicket(){this.currentTicket=null},setFilters(e){this.filters={...this.filters,...e}},clearFilters(){this.filters={status:"",priority:"",category_id:null,search:""}}}});export{d as u};
