import{a6 as g,u as v,s as n,a3 as a}from"./main-rC5xHABW.js";const p=(u=!1)=>{const o=u?window.pinia.defineStore:g,{global:i}=window.i18n,s=v();return o({id:"exchange-rate",state:()=>({supportedCurrencies:[],drivers:[],activeUsedCurrencies:[],providers:[],currencies:null,currentExchangeRate:{id:null,driver:"",key:"",active:!0,currencies:[]},currencyConverter:{type:"",url:""},bulkCurrencies:[]}),getters:{isEdit:r=>!!r.currentExchangeRate.id},actions:{fetchProviders(r){return new Promise((c,t)=>{n.get("/exchange-rate-providers",{params:r}).then(e=>{this.providers=e.data.data,c(e)}).catch(e=>{a(e),t(e)})})},fetchDefaultProviders(){return new Promise((r,c)=>{n.get("/config?key=exchange_rate_drivers").then(t=>{this.drivers=t.data.exchange_rate_drivers,r(t)}).catch(t=>{a(t),c(t)})})},fetchProvider(r){return new Promise((c,t)=>{n.get(`/exchange-rate-providers/${r}`).then(e=>{this.currentExchangeRate=e.data.data,this.currencyConverter=e.data.data.driver_config,c(e)}).catch(e=>{a(e),t(e)})})},addProvider(r){return new Promise((c,t)=>{n.post("/exchange-rate-providers",r).then(e=>{s.showNotification({type:"success",message:i.t("settings.exchange_rate.created_message")}),c(e)}).catch(e=>{a(e),t(e)})})},updateProvider(r){return new Promise((c,t)=>{n.put(`/exchange-rate-providers/${r.id}`,r).then(e=>{s.showNotification({type:"success",message:i.t("settings.exchange_rate.updated_message")}),c(e)}).catch(e=>{a(e),t(e)})})},deleteExchangeRate(r){return new Promise((c,t)=>{n.delete(`/exchange-rate-providers/${r}`).then(e=>{let h=this.drivers.findIndex(d=>d.id===r);this.drivers.splice(h,1),e.data.success?s.showNotification({type:"success",message:i.t("settings.exchange_rate.deleted_message")}):s.showNotification({type:"error",message:i.t("settings.exchange_rate.error")}),c(e)}).catch(e=>{a(e),t(e)})})},fetchCurrencies(r){return new Promise((c,t)=>{n.get("/supported-currencies",{params:r}).then(e=>{this.supportedCurrencies=e.data.supportedCurrencies,c(e)}).catch(e=>{a(e),t(e)})})},fetchActiveCurrency(r){return new Promise((c,t)=>{n.get("/used-currencies",{params:r}).then(e=>{this.activeUsedCurrencies=e.data.activeUsedCurrencies,c(e)}).catch(e=>{a(e),t(e)})})},fetchBulkCurrencies(){return new Promise((r,c)=>{n.get("/currencies/used").then(t=>{this.bulkCurrencies=t.data.currencies.map(e=>(e.exchange_rate=null,e)),r(t)}).catch(t=>{a(t),c(t)})})},updateBulkExchangeRate(r){return new Promise((c,t)=>{n.post("/currencies/bulk-update-exchange-rate",r).then(e=>{c(e)}).catch(e=>{a(e),t(e)})})},getCurrentExchangeRate(r){return new Promise((c,t)=>{n.get(`/currencies/${r}/exchange-rate`).then(e=>{c(e)}).catch(e=>{t(e)})})},getCurrencyConverterServers(){return new Promise((r,c)=>{n.get("/config?key=currency_converter_servers").then(t=>{r(t)}).catch(t=>{a(t),c(t)})})},checkForActiveProvider(r){return new Promise((c,t)=>{n.get(`/currencies/${r}/active-provider`).then(e=>{c(e)}).catch(e=>{t(e)})})}}})()};export{p as u};
