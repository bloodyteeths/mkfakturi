import{O as X,j as U,V as y,r as n,K as B,o as p,w as t,b as r,c as j,L as D,a as e,q as f,t as m,M as E,ax as he,u as ke,v as $e,e as I,I as Ie,az as Ee,ap as De,a7 as xe,n as Ae,ag as P,aB as F,l as i,a8 as Y,Q as Ce,R as Se,bh as Q}from"./main-Ds_umSNN.js";import{u as Te}from"./bills-C_KboshD.js";import{_ as Ve}from"./MoonwalkerIcon-C_jSMrKj.js";import{_ as we}from"./BillIndexDropdown-LmkkiCFc.js";const Le={class:"p-4"},Pe={class:"flex justify-between items-start mb-3"},Fe={class:"text-sm text-gray-600 mt-1"},Ue={class:"space-y-2 mb-4"},Re={class:"flex justify-between text-sm"},Me={class:"text-gray-500"},Ne={class:"font-medium"},Oe={class:"flex justify-between text-sm"},je={class:"text-gray-500"},ze={class:"flex items-center"},We={class:"flex justify-between pt-2 border-t border-gray-200"},Ge={class:"text-gray-700 font-medium"},qe={class:"flex gap-2 mt-4"},He={key:0,class:"absolute top-4 right-4"},Ke={__name:"BillCard",props:{bill:{type:Object,required:!0},selectable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1}},emits:["toggle-select"],setup(d){const c=X(),R=U(()=>c.hasAbilities(y.EDIT_BILL));return(a,h)=>{const x=n("router-link"),k=n("BaseBillStatusLabel"),M=n("BaseBillStatusBadge"),A=n("BaseFormatMoney"),b=n("BaseBillPaidStatusBadge"),v=n("BaseIcon"),o=n("BaseButton"),C=n("BaseCheckbox"),V=n("BaseCard");return p(),B(V,{class:"mb-4 hover:shadow-lg transition-shadow duration-200"},{default:t(()=>[r("div",Le,[r("div",Pe,[r("div",null,[e(x,{to:{path:`/admin/bills/${d.bill.id}/view`},class:"text-lg font-semibold text-primary-500 hover:text-primary-600"},{default:t(()=>[f(m(d.bill.bill_number),1)]),_:1},8,["to"]),r("p",Fe,m(d.bill.supplier.name),1)]),e(M,{status:d.bill.status,class:"px-3 py-1"},{default:t(()=>[e(k,{status:d.bill.status},null,8,["status"])]),_:1},8,["status"])]),r("div",Ue,[r("div",Re,[r("span",Me,m(a.$t("bills.bill_date")),1),r("span",Ne,m(d.bill.formatted_bill_date),1)]),r("div",Oe,[r("span",je,m(a.$t("bills.due_amount")),1),r("div",ze,[e(A,{amount:d.bill.due_amount,currency:d.bill.currency,class:"font-medium"},null,8,["amount","currency"]),d.bill.overdue?(p(),B(b,{key:0,status:"OVERDUE",class:"px-2 py-0.5 ml-2 text-xs"},{default:t(()=>[f(m(a.$t("bills.overdue")),1)]),_:1})):d.bill.status==="COMPLETED"?(p(),B(b,{key:1,status:"PAID",class:"px-2 py-0.5 ml-2 text-xs"},{default:t(()=>[f(m(a.$t("bills.paid")),1)]),_:1})):D("",!0)])]),r("div",We,[r("span",Ge,m(a.$t("bills.total")),1),e(A,{amount:d.bill.total,currency:d.bill.supplier.currency,class:"text-lg font-bold text-gray-900"},null,8,["amount","currency"])])]),r("div",qe,[e(x,{to:{path:`/admin/bills/${d.bill.id}/view`},class:"flex-1"},{default:t(()=>[e(o,{variant:"primary",size:"md",class:"w-full min-h-[44px]"},{left:t($=>[e(v,{name:"EyeIcon",class:E($.class)},null,8,["class"])]),default:t(()=>[f(" "+m(a.$t("general.view")),1)]),_:1})]),_:1},8,["to"]),R.value?(p(),B(x,{key:0,to:{path:`/admin/bills/${d.bill.id}/edit`},class:"flex-1"},{default:t(()=>[e(o,{variant:"primary-outline",size:"md",class:"w-full min-h-[44px]"},{left:t($=>[e(v,{name:"PencilIcon",class:E($.class)},null,8,["class"])]),default:t(()=>[f(" "+m(a.$t("general.edit")),1)]),_:1})]),_:1},8,["to"])):D("",!0)]),d.selectable?(p(),j("div",He,[e(C,{id:d.bill.id,"model-value":d.isSelected,"onUpdate:modelValue":h[0]||(h[0]=$=>a.$emit("toggle-select",d.bill.id)),class:"min-w-[44px] min-h-[44px] flex items-center justify-center"},null,8,["id","model-value"])])):D("",!0)])]),_:1})}}},Ye={class:"relative table-container"},Qe={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Xe={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Je={key:0,class:"block md:hidden mt-6"},Ze={class:"absolute items-center left-6 top-2.5 select-none"},el={class:"relative block"},ll={class:"flex justify-between"},ol={__name:"Index",setup(d){const c=Te(),R=he();ke();const{t:a}=$e.useI18n();xe("$utils");const h=I(null),x=I(0),k=I(!1),M=I([{label:a("bills.status"),options:[{label:a("general.draft"),value:"DRAFT"},{label:a("general.due"),value:"DUE"},{label:a("general.sent"),value:"SENT"},{label:a("bills.viewed"),value:"VIEWED"},{label:a("bills.completed"),value:"COMPLETED"}]},{label:a("bills.paid_status"),options:[{label:a("bills.unpaid"),value:"UNPAID"},{label:a("bills.paid"),value:"PAID"},{label:a("bills.partially_paid"),value:"PARTIALLY_PAID"}]},,]),A=I(!0),b=I("general.draft");Ae();const v=X();let o=Ie({supplier_id:"",status:"",from_date:"",to_date:"",bill_number:""});const C=I([]),V=U(()=>!c.billTotalCount&&!A.value),$=U({get:()=>c.selectedBills,set:s=>c.selectBill(s)}),J=U(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"bill_date",label:a("bills.date"),thClass:"extra",tdClass:"font-medium"},{key:"bill_number",label:a("bills.number")},{key:"supplier",label:a("bills.supplier")},{key:"status",label:a("bills.status")},{key:"due_amount",label:a("dashboard.recent_bills_card.amount_due")},{key:"total",label:a("bills.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:a("bills.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);Ee(o,()=>{se()},{debounce:500}),De(()=>{c.selectAllField&&c.selectAllBills()});function Z(){return v.hasAbilities([y.DELETE_BILL,y.EDIT_BILL,y.VIEW_BILL])}async function ee(s,u){o.status="",N()}function N(){h.value&&h.value.refresh()}async function le({page:s,filter:u,sort:g}){let w={supplier_id:o.supplier_id,status:o.status,from_date:o.from_date,to_date:o.to_date,bill_number:o.bill_number,orderByField:g.fieldName||"created_at",orderBy:g.order||"desc",page:s};console.log(w),A.value=!0;let _=await c.fetchBills(w);return console.log("API response:",_.data.data),C.value=_.data.data,A.value=!1,{data:_.data.data,pagination:{totalPages:_.data.meta.last_page,currentPage:s,totalCount:_.data.meta.total,limit:10}}}function te(s){c.selectBill([s])}function ae(s){if(b.value==s.title)return!0;switch(b.value=s.title,s.title){case a("general.draft"):o.status="DRAFT";break;case a("general.sent"):o.status="SENT";break;case a("general.due"):o.status="OVERDUE";break;case a("general.paid"):o.status="PAID";break;default:o.status="";break}}function se(){c.$patch(s=>{s.selectedBills=[],s.selectAllField=!1}),x.value+=1,N()}function z(){o.supplier_id="",o.status="",o.from_date="",o.to_date="",o.bill_number="",b.value=a("general.all")}async function ne(){R.openDialog({title:a("general.are_you_sure"),message:a("bills.confirm_delete"),yesLabel:a("general.ok"),noLabel:a("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async s=>{s&&await c.deleteMultipleBills().then(u=>{u.data.success&&(N(),c.$patch(g=>{g.selectedBills=[],g.selectAllField=!1}))})})}function oe(){k.value&&z(),k.value=!k.value}function ie(s){switch(s){case"DRAFT":b.value=a("general.draft");break;case"SENT":b.value=a("general.sent");break;case"DUE":b.value=a("general.due");break;case"OVERDUE":b.value=a("general.due");break;case"COMPLETED":b.value=a("bills.completed");break;case"PAID":b.value=a("bills.paid");break;case"UNPAID":b.value=a("bills.unpaid");break;case"PARTIALLY_PAID":b.value=a("bills.partially_paid");break;case"VIEWED":b.value=a("bills.viewed");break;default:b.value=a("general.all");break}}return(s,u)=>{const g=n("BaseBreadcrumbItem"),w=n("BaseBreadcrumb"),_=n("BaseIcon"),O=n("BaseButton"),W=n("router-link"),ue=n("BasePageHeader"),re=n("BaseSupplierSelectInput"),S=n("BaseInputGroup"),de=n("BaseMultiselect"),G=n("BaseDatePicker"),ce=n("BaseInput"),me=n("BaseFilterWrapper"),be=n("BaseEmptyPlaceholder"),T=n("BaseTab"),pe=n("BaseTabGroup"),_e=n("BaseDropdownItem"),fe=n("BaseDropdown"),q=n("BaseCheckbox"),Be=n("BaseText"),H=n("BaseFormatMoney"),ve=n("BaseBillStatusBadge"),K=n("BaseBillPaidStatusBadge"),ge=n("BaseTable"),ye=n("BasePage");return p(),B(ye,null,{default:t(()=>[e(ue,{title:s.$t("bills.title")},{actions:t(()=>[P(e(O,{variant:"primary-outline",onClick:oe},{right:t(l=>[k.value?(p(),B(_,{key:1,name:"XMarkIcon",class:E(l.class)},null,8,["class"])):(p(),B(_,{key:0,name:"FunnelIcon",class:E(l.class)},null,8,["class"]))]),default:t(()=>[f(m(s.$t("general.filter"))+" ",1)]),_:1},512),[[F,i(c).billTotalCount]]),i(v).hasAbilities(i(y).CREATE_BILL)?(p(),B(W,{key:0,to:"bills/create"},{default:t(()=>[e(O,{variant:"primary",class:"ml-4"},{left:t(l=>[e(_,{name:"PlusIcon",class:E(l.class)},null,8,["class"])]),default:t(()=>[f(" "+m(s.$t("bills.new_bill")),1)]),_:1})]),_:1})):D("",!0)]),default:t(()=>[e(w,null,{default:t(()=>[e(g,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),e(g,{title:s.$t("bills.title"),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),P(e(me,{"row-on-xl":!0,onClear:z},{default:t(()=>[e(S,{label:s.$t("bills.supplier")},{default:t(()=>[e(re,{modelValue:i(o).supplier_id,"onUpdate:modelValue":u[0]||(u[0]=l=>i(o).supplier_id=l),placeholder:s.$t("bills.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(S,{label:s.$t("bills.status")},{default:t(()=>[e(de,{modelValue:i(o).status,"onUpdate:modelValue":[u[1]||(u[1]=l=>i(o).status=l),ie],groups:!0,options:M.value,searchable:"",placeholder:s.$t("general.select_a_status"),onRemove:u[2]||(u[2]=l=>ee())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),e(S,{label:s.$t("general.from")},{default:t(()=>[e(G,{modelValue:i(o).from_date,"onUpdate:modelValue":u[3]||(u[3]=l=>i(o).from_date=l),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),u[9]||(u[9]=r("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1)),e(S,{label:s.$t("general.to"),class:"mt-2"},{default:t(()=>[e(G,{modelValue:i(o).to_date,"onUpdate:modelValue":u[4]||(u[4]=l=>i(o).to_date=l),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),e(S,{label:s.$t("bills.bill_number")},{default:t(()=>[e(ce,{modelValue:i(o).bill_number,"onUpdate:modelValue":u[5]||(u[5]=l=>i(o).bill_number=l)},{left:t(l=>[e(_,{name:"HashtagIcon",class:E(l.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1,__:[9]},512),[[F,k.value]]),P(e(be,{title:s.$t("bills.no_bills"),description:s.$t("bills.list_of_bills")},Y({default:t(()=>[e(Ve,{class:"mt-5 mb-4"})]),_:2},[i(v).hasAbilities(i(y).CREATE_BILL)?{name:"actions",fn:t(()=>[e(O,{variant:"primary-outline",onClick:u[6]||(u[6]=l=>s.$router.push("/admin/bills/create"))},{left:t(l=>[e(_,{name:"PlusIcon",class:E(l.class)},null,8,["class"])]),default:t(()=>[f(" "+m(s.$t("bills.add_new_bill")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"]),[[F,V.value]]),P(r("div",Ye,[r("div",Qe,[e(pe,{class:"-mb-5",onChange:ae},{default:t(()=>[e(T,{title:s.$t("general.all"),filter:""},null,8,["title"]),e(T,{title:s.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),e(T,{title:s.$t("general.sent"),filter:"SENT"},null,8,["title"]),e(T,{title:s.$t("general.due"),filter:"OVERDUE"},null,8,["title"]),e(T,{title:s.$t("general.paid"),filter:"PAID"},null,8,["title"])]),_:1}),i(c).selectedBills.length&&i(v).hasAbilities(i(y).DELETE_BILL)?(p(),B(fe,{key:0,class:"absolute float-right"},{activator:t(()=>[r("span",Xe,[f(m(s.$t("general.actions"))+" ",1),e(_,{name:"ChevronDownIcon"})])]),default:t(()=>[e(_e,{onClick:ne},{default:t(()=>[e(_,{name:"TrashIcon",class:"mr-3 text-gray-600"}),f(" "+m(s.$t("general.delete")),1)]),_:1})]),_:1})):D("",!0)]),C.value.length?(p(),j("div",Je,[(p(!0),j(Ce,null,Se(C.value,l=>(p(),B(Ke,{key:l.id,bill:l,selectable:i(v).hasAbilities(i(y).DELETE_BILL),"is-selected":i(c).selectedBills.includes(l.id),onToggleSelect:te},null,8,["bill","selectable","is-selected"]))),128))])):D("",!0),(p(),B(ge,{ref_key:"table",ref:h,data:le,columns:J.value,"placeholder-count":i(c).billTotalCount>=20?10:5,key:x.value,class:"mt-10 hidden md:block"},Y({header:t(()=>[r("div",Ze,[e(q,{modelValue:i(c).selectAllField,"onUpdate:modelValue":u[7]||(u[7]=l=>i(c).selectAllField=l),variant:"primary",onChange:i(c).selectAllBills},null,8,["modelValue","onChange"])])]),"cell-checkbox":t(({row:l})=>[r("div",el,[e(q,{id:l.id,modelValue:$.value,"onUpdate:modelValue":u[8]||(u[8]=L=>$.value=L),value:l.data.id},null,8,["id","modelValue","value"])])]),"cell-supplier":t(({row:l})=>{var L;return[e(Be,{text:((L=l.data.supplier)==null?void 0:L.name)||"-"},null,8,["text"])]}),"cell-bill_number":t(({row:l})=>[e(W,{to:{path:`bills/${l.data.id}/view`},class:"font-medium text-primary-500"},{default:t(()=>[f(m(l.data.bill_number),1)]),_:2},1032,["to"])]),"cell-bill_date":t(({row:l})=>[f(m(l.data.formatted_bill_date),1)]),"cell-total":t(({row:l})=>[e(H,{amount:l.data.total,currency:l.data.currency},null,8,["amount","currency"])]),"cell-status":t(({row:l})=>[e(ve,{status:l.data.status,class:"px-3 py-1"},{default:t(()=>[e(Q,{status:l.data.status},null,8,["status"])]),_:2},1032,["status"])]),"cell-due_amount":t(({row:l})=>[r("div",ll,[e(H,{amount:l.data.due_amount,currency:l.data.currency},null,8,["amount","currency"]),l.data.overdue?(p(),B(K,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:t(()=>[f(m(s.$t("bills.overdue")),1)]),_:1})):D("",!0),e(K,{status:l.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:t(()=>[e(Q,{status:l.data.paid_status},null,8,["status"])]),_:2},1032,["status"])])]),_:2},[Z()?{name:"cell-actions",fn:t(({row:l})=>[e(we,{row:l.data,table:h.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns","placeholder-count"]))],512),[[F,!V.value]])]),_:1})}}};export{ol as default};
