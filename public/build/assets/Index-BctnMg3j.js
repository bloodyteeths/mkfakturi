import{O as Q,j as N,V as y,r as n,K as p,o as _,w as a,b as u,c as M,L as C,a as e,q as b,t as m,M as $,al as Ie,ax as he,u as ke,v as Ee,e as E,I as $e,az as Ce,ap as De,a7 as Ve,n as xe,ag as P,aB as F,l as i,a8 as K,Q as Te,R as Se,bi as Y}from"./main-C3HD31Qx.js";import{_ as Ae}from"./MoonwalkerIcon-D4Z39jBc.js";import{_ as we}from"./InvoiceIndexDropdown-D7FBlqoN.js";import{_ as Pe}from"./SendInvoiceModal-BMsEgj4i.js";import"./mail-driver-DLfaRacG.js";const Fe={class:"p-4"},Ne={class:"flex justify-between items-start mb-3"},Oe={class:"text-sm text-gray-600 mt-1"},Ue={class:"space-y-2 mb-4"},Le={class:"flex justify-between text-sm"},Re={class:"text-gray-500"},Me={class:"font-medium"},je={class:"flex justify-between text-sm"},ze={class:"text-gray-500"},We={class:"flex items-center"},Ge={class:"flex justify-between pt-2 border-t border-gray-200"},qe={class:"text-gray-700 font-medium"},He={class:"flex gap-2 mt-4"},Ke={key:0,class:"absolute top-4 right-4"},Ye={__name:"InvoiceCard",props:{invoice:{type:Object,required:!0},selectable:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1}},emits:["toggle-select"],setup(r){const d=Q(),O=N(()=>d.hasAbilities(y.EDIT_INVOICE));return(s,I)=>{const D=n("router-link"),h=n("BaseInvoiceStatusLabel"),U=n("BaseInvoiceStatusBadge"),V=n("BaseFormatMoney"),v=n("BasePaidStatusBadge"),g=n("BaseIcon"),o=n("BaseButton"),x=n("BaseCheckbox"),S=n("BaseCard");return _(),p(S,{class:"mb-4 hover:shadow-lg transition-shadow duration-200"},{default:a(()=>[u("div",Fe,[u("div",Ne,[u("div",null,[e(D,{to:{path:`/admin/invoices/${r.invoice.id}/view`},class:"text-lg font-semibold text-primary-500 hover:text-primary-600"},{default:a(()=>[b(m(r.invoice.invoice_number),1)]),_:1},8,["to"]),u("p",Oe,m(r.invoice.customer.name),1)]),e(U,{status:r.invoice.status,class:"px-3 py-1"},{default:a(()=>[e(h,{status:r.invoice.status},null,8,["status"])]),_:1},8,["status"])]),u("div",Ue,[u("div",Le,[u("span",Re,m(s.$t("invoices.invoice_date")),1),u("span",Me,m(r.invoice.formatted_invoice_date),1)]),u("div",je,[u("span",ze,m(s.$t("invoices.due_amount")),1),u("div",We,[e(V,{amount:r.invoice.due_amount,currency:r.invoice.currency,class:"font-medium"},null,8,["amount","currency"]),r.invoice.overdue?(_(),p(v,{key:0,status:"OVERDUE",class:"px-2 py-0.5 ml-2 text-xs"},{default:a(()=>[b(m(s.$t("invoices.overdue")),1)]),_:1})):r.invoice.status==="COMPLETED"?(_(),p(v,{key:1,status:"PAID",class:"px-2 py-0.5 ml-2 text-xs"},{default:a(()=>[b(m(s.$t("invoices.paid")),1)]),_:1})):C("",!0)])]),u("div",Ge,[u("span",qe,m(s.$t("invoices.total")),1),e(V,{amount:r.invoice.total,currency:r.invoice.customer.currency,class:"text-lg font-bold text-gray-900"},null,8,["amount","currency"])])]),u("div",He,[e(D,{to:{path:`/admin/invoices/${r.invoice.id}/view`},class:"flex-1"},{default:a(()=>[e(o,{variant:"primary",size:"md",class:"w-full min-h-[44px]"},{left:a(k=>[e(g,{name:"EyeIcon",class:$(k.class)},null,8,["class"])]),default:a(()=>[b(" "+m(s.$t("general.view")),1)]),_:1})]),_:1},8,["to"]),O.value?(_(),p(D,{key:0,to:{path:`/admin/invoices/${r.invoice.id}/edit`},class:"flex-1"},{default:a(()=>[e(o,{variant:"primary-outline",size:"md",class:"w-full min-h-[44px]"},{left:a(k=>[e(g,{name:"PencilIcon",class:$(k.class)},null,8,["class"])]),default:a(()=>[b(" "+m(s.$t("general.edit")),1)]),_:1})]),_:1},8,["to"])):C("",!0)]),r.selectable?(_(),M("div",Ke,[e(x,{id:r.invoice.id,"model-value":r.isSelected,"onUpdate:modelValue":I[0]||(I[0]=k=>s.$emit("toggle-select",r.invoice.id)),class:"min-w-[44px] min-h-[44px] flex items-center justify-center"},null,8,["id","model-value"])])):C("",!0)])]),_:1})}}},Qe={class:"relative table-container"},Xe={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Je={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Ze={key:0,class:"block md:hidden mt-6"},et={class:"absolute items-center left-6 top-2.5 select-none"},tt={class:"relative block"},at={class:"flex justify-between"},ct={__name:"Index",setup(r){const d=Ie(),O=he();ke();const{t:s}=Ee.useI18n();Ve("$utils");const I=E(null),D=E(0),h=E(!1),U=E([{label:s("invoices.status"),options:[{label:s("general.draft"),value:"DRAFT"},{label:s("general.due"),value:"DUE"},{label:s("general.sent"),value:"SENT"},{label:s("invoices.viewed"),value:"VIEWED"},{label:s("invoices.completed"),value:"COMPLETED"}]},{label:s("invoices.paid_status"),options:[{label:s("invoices.unpaid"),value:"UNPAID"},{label:s("invoices.paid"),value:"PAID"},{label:s("invoices.partially_paid"),value:"PARTIALLY_PAID"}]},,]),V=E(!0),v=E("general.draft");xe();const g=Q();let o=$e({customer_id:"",status:"",from_date:"",to_date:"",invoice_number:""});const x=E([]),S=N(()=>!d.invoiceTotalCount&&!V.value),k=N({get:()=>d.selectedInvoices,set:l=>d.selectInvoice(l)}),X=N(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:s("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:s("invoices.number")},{key:"name",label:s("invoices.customer")},{key:"status",label:s("invoices.status")},{key:"due_amount",label:s("dashboard.recent_invoices_card.amount_due")},{key:"total",label:s("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:s("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);Ce(o,()=>{se()},{debounce:500}),De(()=>{d.selectAllField&&d.selectAllInvoices()});function J(){return g.hasAbilities([y.DELETE_INVOICE,y.EDIT_INVOICE,y.VIEW_INVOICE,y.SEND_INVOICE])}async function Z(l,c){o.status="",L()}function L(){I.value&&I.value.refresh()}async function ee({page:l,filter:c,sort:B}){let A={customer_id:o.customer_id,status:o.status,from_date:o.from_date,to_date:o.to_date,invoice_number:o.invoice_number,orderByField:B.fieldName||"created_at",orderBy:B.order||"desc",page:l};console.log(A),V.value=!0;let f=await d.fetchInvoices(A);return console.log("API response:",f.data.data),x.value=f.data.data,V.value=!1,{data:f.data.data,pagination:{totalPages:f.data.meta.last_page,currentPage:l,totalCount:f.data.meta.total,limit:10}}}function te(l){d.selectInvoice([l])}function ae(l){if(v.value==l.title)return!0;switch(v.value=l.title,l.title){case s("general.draft"):o.status="DRAFT";break;case s("general.sent"):o.status="SENT";break;case s("general.due"):o.status="DUE";break;default:o.status="";break}}function se(){d.$patch(l=>{l.selectedInvoices=[],l.selectAllField=!1}),D.value+=1,L()}function j(){o.customer_id="",o.status="",o.from_date="",o.to_date="",o.invoice_number="",v.value=s("general.all")}async function le(){O.openDialog({title:s("general.are_you_sure"),message:s("invoices.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async l=>{l&&await d.deleteMultipleInvoices().then(c=>{c.data.success&&(L(),d.$patch(B=>{B.selectedInvoices=[],B.selectAllField=!1}))})})}function ne(){h.value&&j(),h.value=!h.value}function oe(l){switch(l){case"DRAFT":v.value=s("general.draft");break;case"SENT":v.value=s("general.sent");break;case"DUE":v.value=s("general.due");break;case"COMPLETED":v.value=s("invoices.completed");break;case"PAID":v.value=s("invoices.paid");break;case"UNPAID":v.value=s("invoices.unpaid");break;case"PARTIALLY_PAID":v.value=s("invoices.partially_paid");break;case"VIEWED":v.value=s("invoices.viewed");break;default:v.value=s("general.all");break}}return(l,c)=>{const B=n("BaseBreadcrumbItem"),A=n("BaseBreadcrumb"),f=n("BaseIcon"),R=n("BaseButton"),z=n("router-link"),ie=n("BasePageHeader"),ce=n("BaseCustomerSelectInput"),T=n("BaseInputGroup"),ue=n("BaseMultiselect"),W=n("BaseDatePicker"),re=n("BaseInput"),de=n("BaseFilterWrapper"),me=n("BaseEmptyPlaceholder"),w=n("BaseTab"),ve=n("BaseTabGroup"),_e=n("BaseDropdownItem"),fe=n("BaseDropdown"),G=n("BaseCheckbox"),be=n("BaseText"),q=n("BaseFormatMoney"),pe=n("BaseInvoiceStatusBadge"),H=n("BasePaidStatusBadge"),ye=n("BaseTable"),ge=n("BasePage");return _(),p(ge,null,{default:a(()=>[e(Pe),e(ie,{title:l.$t("invoices.title")},{actions:a(()=>[P(e(R,{variant:"primary-outline",onClick:ne},{right:a(t=>[h.value?(_(),p(f,{key:1,name:"XMarkIcon",class:$(t.class)},null,8,["class"])):(_(),p(f,{key:0,name:"FunnelIcon",class:$(t.class)},null,8,["class"]))]),default:a(()=>[b(m(l.$t("general.filter"))+" ",1)]),_:1},512),[[F,i(d).invoiceTotalCount]]),i(g).hasAbilities(i(y).CREATE_INVOICE)?(_(),p(z,{key:0,to:"invoices/create"},{default:a(()=>[e(R,{variant:"primary",class:"ml-4"},{left:a(t=>[e(f,{name:"PlusIcon",class:$(t.class)},null,8,["class"])]),default:a(()=>[b(" "+m(l.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):C("",!0)]),default:a(()=>[e(A,null,{default:a(()=>[e(B,{title:l.$t("general.home"),to:"dashboard"},null,8,["title"]),e(B,{title:l.$t("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),P(e(de,{"row-on-xl":!0,onClear:j},{default:a(()=>[e(T,{label:l.$t("customers.customer",1)},{default:a(()=>[e(ce,{modelValue:i(o).customer_id,"onUpdate:modelValue":c[0]||(c[0]=t=>i(o).customer_id=t),placeholder:l.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(T,{label:l.$t("invoices.status")},{default:a(()=>[e(ue,{modelValue:i(o).status,"onUpdate:modelValue":[c[1]||(c[1]=t=>i(o).status=t),oe],groups:!0,options:U.value,searchable:"",placeholder:l.$t("general.select_a_status"),onRemove:c[2]||(c[2]=t=>Z())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),e(T,{label:l.$t("general.from")},{default:a(()=>[e(W,{modelValue:i(o).from_date,"onUpdate:modelValue":c[3]||(c[3]=t=>i(o).from_date=t),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),c[9]||(c[9]=u("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1)),e(T,{label:l.$t("general.to"),class:"mt-2"},{default:a(()=>[e(W,{modelValue:i(o).to_date,"onUpdate:modelValue":c[4]||(c[4]=t=>i(o).to_date=t),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),e(T,{label:l.$t("invoices.invoice_number")},{default:a(()=>[e(re,{modelValue:i(o).invoice_number,"onUpdate:modelValue":c[5]||(c[5]=t=>i(o).invoice_number=t)},{left:a(t=>[e(f,{name:"HashtagIcon",class:$(t.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1,__:[9]},512),[[F,h.value]]),P(e(me,{title:l.$t("invoices.no_invoices"),description:l.$t("invoices.list_of_invoices")},K({default:a(()=>[e(Ae,{class:"mt-5 mb-4"})]),_:2},[i(g).hasAbilities(i(y).CREATE_INVOICE)?{name:"actions",fn:a(()=>[e(R,{variant:"primary-outline",onClick:c[6]||(c[6]=t=>l.$router.push("/admin/invoices/create"))},{left:a(t=>[e(f,{name:"PlusIcon",class:$(t.class)},null,8,["class"])]),default:a(()=>[b(" "+m(l.$t("invoices.add_new_invoice")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"]),[[F,S.value]]),P(u("div",Qe,[u("div",Xe,[e(ve,{class:"-mb-5",onChange:ae},{default:a(()=>[e(w,{title:l.$t("general.all"),filter:""},null,8,["title"]),e(w,{title:l.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),e(w,{title:l.$t("general.sent"),filter:"SENT"},null,8,["title"]),e(w,{title:l.$t("general.due"),filter:"DUE"},null,8,["title"])]),_:1}),i(d).selectedInvoices.length&&i(g).hasAbilities(i(y).DELETE_INVOICE)?(_(),p(fe,{key:0,class:"absolute float-right"},{activator:a(()=>[u("span",Je,[b(m(l.$t("general.actions"))+" ",1),e(f,{name:"ChevronDownIcon"})])]),default:a(()=>[e(_e,{onClick:le},{default:a(()=>[e(f,{name:"TrashIcon",class:"mr-3 text-gray-600"}),b(" "+m(l.$t("general.delete")),1)]),_:1})]),_:1})):C("",!0)]),x.value.length?(_(),M("div",Ze,[(_(!0),M(Te,null,Se(x.value,t=>(_(),p(Ye,{key:t.id,invoice:t,selectable:i(g).hasAbilities(i(y).DELETE_INVOICE),"is-selected":i(d).selectedInvoices.includes(t.id),onToggleSelect:te},null,8,["invoice","selectable","is-selected"]))),128))])):C("",!0),(_(),p(ye,{ref_key:"table",ref:I,data:ee,columns:X.value,"placeholder-count":i(d).invoiceTotalCount>=20?10:5,key:D.value,class:"mt-10 hidden md:block"},K({header:a(()=>[u("div",et,[e(G,{modelValue:i(d).selectAllField,"onUpdate:modelValue":c[7]||(c[7]=t=>i(d).selectAllField=t),variant:"primary",onChange:i(d).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":a(({row:t})=>[u("div",tt,[e(G,{id:t.id,modelValue:k.value,"onUpdate:modelValue":c[8]||(c[8]=Be=>k.value=Be),value:t.data.id},null,8,["id","modelValue","value"])])]),"cell-name":a(({row:t})=>[e(be,{text:t.data.customer.name},null,8,["text"])]),"cell-invoice_number":a(({row:t})=>[e(z,{to:{path:`invoices/${t.data.id}/view`},class:"font-medium text-primary-500"},{default:a(()=>[b(m(t.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":a(({row:t})=>[b(m(t.data.formatted_invoice_date),1)]),"cell-total":a(({row:t})=>[e(q,{amount:t.data.total,currency:t.data.customer.currency},null,8,["amount","currency"])]),"cell-status":a(({row:t})=>[e(pe,{status:t.data.status,class:"px-3 py-1"},{default:a(()=>[e(Y,{status:t.data.status},null,8,["status"])]),_:2},1032,["status"])]),"cell-due_amount":a(({row:t})=>[u("div",at,[e(q,{amount:t.data.due_amount,currency:t.data.currency},null,8,["amount","currency"]),t.data.overdue?(_(),p(H,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:a(()=>[b(m(l.$t("invoices.overdue")),1)]),_:1})):C("",!0),e(H,{status:t.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:a(()=>[e(Y,{status:t.data.paid_status},null,8,["status"])]),_:2},1032,["status"])])]),_:2},[J()?{name:"cell-actions",fn:a(({row:t})=>[e(we,{row:t.data,table:I.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns","placeholder-count"]))],512),[[F,!S.value]])]),_:1})}}};export{ct as default};
