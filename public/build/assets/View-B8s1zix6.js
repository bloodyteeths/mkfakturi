import{v as ee,j as B,r,K as d,o,w as s,L as p,b as a,t as i,G as oe,e as D,I as ue,f as ce,g as de,i as Ee,P as Z,m as ke,a as n,l as k,c as C,q as T,aA as me,s as we,N as ve,ax as _e,k as Ce,Q as ne,R as pe,al as De,O as Te,H as Me,S as Ae,V as Q,M as Ne}from"./main-rC5xHABW.js";import{_ as Ve}from"./SendInvoiceModal-CcO-_tRJ.js";import{u as fe,_ as Fe}from"./InvoiceIndexDropdown-atx1-oTH.js";import{L as W}from"./LoadingIcon-DhRbLPcb.js";import"./mail-driver-C0Orknci.js";const Le={__name:"EInvoiceStatusBadge",props:{status:{type:String,required:!0,validator:j=>["DRAFT","SIGNED","SUBMITTED","ACCEPTED","REJECTED"].includes(j)}},setup(j){const L=j,{t:m}=ee.useI18n(),N=B(()=>({DRAFT:"gray",SIGNED:"blue",SUBMITTED:"yellow",ACCEPTED:"green",REJECTED:"red"})[L.status]||"gray"),b=B(()=>({DRAFT:"DocumentTextIcon",SIGNED:"ShieldCheckIcon",SUBMITTED:"PaperAirplaneIcon",ACCEPTED:"CheckCircleIcon",REJECTED:"XCircleIcon"})[L.status]||null),V=B(()=>m(`e_invoice.status_${L.status.toLowerCase()}`));return(I,l)=>{const g=r("BaseIcon"),M=r("BaseBadge");return o(),d(M,{variant:N.value,class:"px-3 py-1"},{default:s(()=>[b.value?(o(),d(g,{key:0,name:b.value,class:"w-4 h-4 mr-1"},null,8,["name"])):p("",!0),a("span",null,i(V.value),1)]),_:1},8,["variant"])}}},Pe={class:"flex justify-between w-full"},Ge={class:"px-8 py-8 sm:p-6"},Re={key:0},Ue={class:"font-medium"},ze={class:"text-xs text-gray-500"},je={class:"font-medium"},qe={class:"text-xs text-gray-500"},Ye={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},He={__name:"EInvoiceSignModal",emits:["signed"],setup(j,{emit:L}){const m=oe(),N=fe(),{t:b}=ee.useI18n(),V=D(!1),I=D(!1),l=D([]),g=D(""),M=L,_=ue({certificate_id:null,passphrase:""}),c=B(()=>m.active&&m.componentName==="EInvoiceSignModal"),x=B(()=>m.title||b("e_invoice.sign"));B(()=>m.data);const P=B(()=>m.id),q={certificate_id:{required:ce.withMessage(b("validation.required"),de)},passphrase:{required:ce.withMessage(b("validation.required"),de)}},$=Ee(q,_);async function v(){g.value="",_.certificate_id=null,_.passphrase="",$.value.$reset(),await X()}async function X(){var h;I.value=!0;try{console.log("[EInvoiceSignModal] Loading certificates...");const f=await we.get("/certificates/current");console.log("[EInvoiceSignModal] API Response:",f.data),l.value=f.data.data||[],console.log("[EInvoiceSignModal] Certificates loaded:",l.value),console.log("[EInvoiceSignModal] Certificate count:",l.value.length),l.value.length===1?(_.certificate_id=l.value[0].id,console.log("[EInvoiceSignModal] Auto-selected certificate ID:",_.certificate_id)):l.value.length===0&&(console.warn("[EInvoiceSignModal] No certificates found!"),g.value=b("certificates.no_certificate"))}catch(f){console.error("[EInvoiceSignModal] Failed to load certificates:",f),console.error("[EInvoiceSignModal] Error details:",(h=f.response)==null?void 0:h.data),g.value=b("e_invoice.failed_to_load_certificates")}finally{I.value=!1}}function F(h){return me(h).format("DD.MM.YYYY")}async function K(){var h,f;if($.value.$touch(),!$.value.$invalid){V.value=!0,g.value="";try{await N.signEInvoice(P.value,_.passphrase),M("signed"),R()}catch(U){g.value=((f=(h=U.response)==null?void 0:h.data)==null?void 0:f.message)||b("e_invoice.signing_failed")}finally{V.value=!1}}}function R(){m.closeModal(),_.certificate_id=null,_.passphrase="",g.value="",$.value.$reset()}return Z(c,(h,f)=>{h&&!f&&(console.log("[EInvoiceSignModal] Modal opened, loading initial data"),v())}),(h,f)=>{const U=r("BaseIcon"),G=r("BaseSelect"),O=r("BaseInputGroup"),z=r("BaseInput"),J=r("BaseAlert"),e=r("BaseInputGrid"),u=r("BaseButton"),A=r("BaseModal");return o(),d(A,{show:c.value,onClose:R},{header:s(()=>[a("div",Pe,[T(i(x.value)+" ",1),n(U,{name:"XMarkIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:R})])]),default:s(()=>[a("form",{onSubmit:ke(K,["prevent"])},[a("div",Ge,[n(e,{layout:"one-column"},{default:s(()=>[n(O,{label:h.$t("e_invoice.select_certificate"),required:"",error:k($).certificate_id.$error&&k($).certificate_id.$errors[0].$message},{default:s(()=>[n(G,{modelValue:_.certificate_id,"onUpdate:modelValue":f[0]||(f[0]=t=>_.certificate_id=t),options:l.value,invalid:k($).certificate_id.$error,loading:I.value,placeholder:h.$t("e_invoice.select_certificate"),label:"name","value-prop":"id",onInput:f[1]||(f[1]=t=>k($).certificate_id.$touch())},{"selected-option":s(({option:t})=>[t?(o(),C("div",Re,[a("div",Ue,i(t.name),1),a("div",ze,i(h.$t("certificates.expires"))+": "+i(F(t.expires_at)),1)])):p("",!0)]),option:s(({option:t})=>[a("div",null,[a("div",je,i(t.name),1),a("div",qe,i(h.$t("certificates.expires"))+": "+i(F(t.expires_at)),1)])]),_:1},8,["modelValue","options","invalid","loading","placeholder"])]),_:1},8,["label","error"]),n(O,{label:h.$t("e_invoice.enter_passphrase"),required:"",error:k($).passphrase.$error&&k($).passphrase.$errors[0].$message},{default:s(()=>[n(z,{modelValue:_.passphrase,"onUpdate:modelValue":f[2]||(f[2]=t=>_.passphrase=t),type:"password",invalid:k($).passphrase.$error,placeholder:h.$t("e_invoice.enter_passphrase"),onInput:f[3]||(f[3]=t=>k($).passphrase.$touch())},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["label","error"]),g.value?(o(),d(J,{key:0,variant:"danger",class:"mt-4"},{default:s(()=>[T(i(g.value),1)]),_:1})):p("",!0)]),_:1})]),a("div",Ye,[n(u,{class:"mr-3",variant:"primary-outline",type:"button",onClick:R},{default:s(()=>[T(i(h.$t("general.cancel")),1)]),_:1}),n(u,{loading:V.value,disabled:V.value||k($).$invalid,variant:"primary",type:"submit"},{default:s(()=>[V.value?p("",!0):(o(),d(U,{key:0,name:"ShieldCheckIcon",class:"h-5 mr-2"})),T(" "+i(h.$t("e_invoice.sign")),1)]),_:1},8,["loading","disabled"])])],32)]),_:1},8,["show"])}}},Oe={class:"py-6"},Je={key:0,class:"flex justify-center items-center py-12"},We={key:1},Xe={key:0,class:"text-center py-8"},Ke={class:"p-8"},Qe={class:"text-lg font-medium text-gray-900 mb-2"},Ze={class:"text-sm text-gray-500 mb-6"},et={key:1},tt={class:"p-6"},at={class:"flex items-center justify-between mb-4"},st={class:"text-lg font-medium text-gray-900"},nt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm"},ot={class:"text-gray-500"},it={class:"ml-2 font-medium"},lt={key:0},rt={class:"text-gray-500"},ct={class:"ml-2 font-medium"},dt={key:1},ut={class:"text-gray-500"},mt={class:"ml-2 font-medium"},vt={class:"p-6"},_t={class:"text-lg font-medium text-gray-900 mb-4"},pt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},ft={class:"p-6"},yt={class:"text-lg font-medium text-gray-900 mb-4"},gt={class:"mt-4 overflow-hidden shadow ring-1 ring-black ring-opacity-5 sm:rounded-lg"},ht={class:"min-w-full divide-y divide-gray-300"},bt={class:"bg-gray-50"},Bt={scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},It={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},xt={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},$t={scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},St={class:"divide-y divide-gray-200 bg-white"},Et={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm text-gray-900 sm:pl-6"},kt={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},wt={class:"px-3 py-4 text-sm text-gray-500"},Ct={key:0,class:"text-sm"},Dt={key:1,class:"text-xs text-gray-500 mt-1"},Tt={class:"whitespace-nowrap px-3 py-4 text-sm"},Mt={class:"p-6 text-center text-gray-500"},At={__name:"EInvoiceTab",props:{invoice:{type:Object,required:!0}},setup(j){const L=j,{t:m}=ee.useI18n(),N=ve(),b=fe(),V=oe(),I=_e(),l=D(!0),g=D(!1),M=D(!1),_=D(!1),c=B(()=>b.currentEInvoice),x=B(()=>b.submissions||[]),P=B(()=>L.invoice.status==="SENT"&&!c.value),q=B(()=>{var u;return c.value?((u=c.value.status)==null?void 0:u.toUpperCase())==="DRAFT":!1}),$=B(()=>{var u;return c.value?((u=c.value.status)==null?void 0:u.toUpperCase())==="SIGNED":!1}),v=B(()=>{var u;return c.value?((u=c.value.status)==null?void 0:u.toUpperCase())==="SIGNED":!1}),X=B(()=>{var u;if(!c.value)return!1;const e=(u=c.value.status)==null?void 0:u.toUpperCase();return["SIGNED","SUBMITTED","ACCEPTED","REJECTED"].includes(e)});Ce(async()=>{await F()}),Z(()=>N.params.id,async(e,u)=>{e&&e!==u&&await F()}),Z(()=>{var e;return(e=L.invoice)==null?void 0:e.id},async(e,u)=>{e&&e!==u&&await F()});async function F(){l.value=!0;try{await b.fetchEInvoiceStatus(N.params.id)}catch(e){console.error("Failed to load e-invoice:",e)}finally{l.value=!1}}async function K(){I.openDialog({title:m("general.are_you_sure"),message:m("e_invoice.confirm_generate"),yesLabel:m("general.yes"),noLabel:m("general.cancel"),variant:"primary",hideNoButton:!1,size:"md"}).then(async e=>{if(e){g.value=!0;try{await b.generateEInvoice(N.params.id)}catch(u){console.error("Generate failed:",u)}finally{g.value=!1}}})}function R(){V.openModal({title:m("e_invoice.sign"),componentName:"EInvoiceSignModal",id:c.value.id})}async function h(){await F()}async function f(){M.value=!0;try{await b.simulateSubmission(c.value.id)}catch(e){console.error("Simulation failed:",e)}finally{M.value=!1}}async function U(){I.openDialog({title:m("general.are_you_sure"),message:m("e_invoice.confirm_submit"),yesLabel:m("general.yes"),noLabel:m("general.cancel"),variant:"primary",hideNoButton:!1,size:"md"}).then(async e=>{if(e){_.value=!0;try{await b.submitEInvoice(c.value.id)}catch(u){console.error("Submit failed:",u)}finally{_.value=!1}}})}async function G(){try{await b.downloadXml(c.value.id)}catch(e){console.error("Download failed:",e)}}async function O(e){I.openDialog({title:m("general.are_you_sure"),message:m("e_invoice.confirm_resubmit"),yesLabel:m("general.yes"),noLabel:m("general.cancel"),variant:"primary",hideNoButton:!1,size:"md"}).then(async u=>{if(u)try{await b.resubmit(e),await F()}catch(A){console.error("Resubmit failed:",A)}})}function z(e){return me(e).format("DD.MM.YYYY HH:mm")}function J(e){return{PENDING:"yellow",SUCCESS:"green",FAILED:"red"}[e]||"gray"}return(e,u)=>{var H;const A=r("BaseIcon"),t=r("BaseButton"),S=r("BaseAlert"),E=r("BaseCard"),Y=r("BaseBadge");return o(),C("div",Oe,[l.value?(o(),C("div",Je,[n(W,{class:"h-8 w-8 animate-spin text-primary-500"})])):(o(),C("div",We,[c.value?(o(),C("div",et,[n(E,{class:"mb-6"},{default:s(()=>[a("div",tt,[a("div",at,[a("h3",st,i(e.$t("e_invoice.status_title")),1),n(Le,{status:c.value.status},null,8,["status"])]),a("div",nt,[a("div",null,[a("span",ot,i(e.$t("e_invoice.created_at"))+":",1),a("span",it,i(z(c.value.created_at)),1)]),c.value.signed_at?(o(),C("div",lt,[a("span",rt,i(e.$t("e_invoice.signed_at"))+":",1),a("span",ct,i(z(c.value.signed_at)),1)])):p("",!0),c.value.submitted_at?(o(),C("div",dt,[a("span",ut,i(e.$t("e_invoice.submitted_at"))+":",1),a("span",mt,i(z(c.value.submitted_at)),1)])):p("",!0)])])]),_:1}),n(E,{class:"mb-6"},{default:s(()=>[a("div",vt,[a("h3",_t,i(e.$t("e_invoice.actions")),1),a("div",pt,[q.value?(o(),d(t,{key:0,variant:"primary",onClick:R},{default:s(()=>[n(A,{name:"ShieldCheckIcon",class:"h-5 mr-2"}),T(" "+i(e.$t("e_invoice.sign")),1)]),_:1})):p("",!0),$.value?(o(),d(t,{key:1,variant:"primary-outline",disabled:M.value,onClick:f},{default:s(()=>[M.value?(o(),d(W,{key:1,class:"h-5 mr-2 animate-spin"})):(o(),d(A,{key:0,name:"CheckCircleIcon",class:"h-5 mr-2"})),T(" "+i(M.value?e.$t("e_invoice.validating"):e.$t("e_invoice.simulate")),1)]),_:1},8,["disabled"])):p("",!0),v.value?(o(),d(t,{key:2,variant:"primary",disabled:_.value,onClick:U},{default:s(()=>[_.value?(o(),d(W,{key:1,class:"h-5 mr-2 animate-spin"})):(o(),d(A,{key:0,name:"PaperAirplaneIcon",class:"h-5 mr-2"})),T(" "+i(_.value?e.$t("e_invoice.submitting"):e.$t("e_invoice.submit")),1)]),_:1},8,["disabled"])):p("",!0),X.value?(o(),d(t,{key:3,variant:"primary-outline",onClick:G},{default:s(()=>[n(A,{name:"ArrowDownTrayIcon",class:"h-5 mr-2"}),T(" "+i(e.$t("e_invoice.download_xml")),1)]),_:1})):p("",!0)])])]),_:1}),x.value.length>0?(o(),d(E,{key:0},{default:s(()=>[a("div",ft,[a("h3",yt,i(e.$t("e_invoice.submissions")),1),a("div",gt,[a("table",ht,[a("thead",bt,[a("tr",null,[a("th",Bt,i(e.$t("e_invoice.submission_date")),1),a("th",It,i(e.$t("e_invoice.submission_status")),1),a("th",xt,i(e.$t("e_invoice.response")),1),a("th",$t,i(e.$t("general.actions")),1)])]),a("tbody",St,[(o(!0),C(ne,null,pe(x.value,w=>(o(),C("tr",{key:w.id},[a("td",Et,i(z(w.created_at)),1),a("td",kt,[n(Y,{variant:J(w.status)},{default:s(()=>[T(i(w.status),1)]),_:2},1032,["variant"])]),a("td",wt,[w.response_message?(o(),C("div",Ct,i(w.response_message),1)):p("",!0),w.portal_id?(o(),C("div",Dt," Portal ID: "+i(w.portal_id),1)):p("",!0)]),a("td",Tt,[w.status==="FAILED"?(o(),d(t,{key:0,variant:"danger-outline",size:"sm",onClick:ie=>O(w.id)},{default:s(()=>[n(A,{name:"ArrowPathIcon",class:"h-4 mr-1"}),T(" "+i(e.$t("e_invoice.resubmit")),1)]),_:2},1032,["onClick"])):p("",!0)])]))),128))])])])])]),_:1})):((H=c.value.status)==null?void 0:H.toUpperCase())!=="DRAFT"&&x.value.length===0?(o(),d(E,{key:1},{default:s(()=>[a("div",Mt,i(e.$t("e_invoice.no_submissions")),1)]),_:1})):p("",!0)])):(o(),C("div",Xe,[n(E,{class:"max-w-2xl mx-auto"},{default:s(()=>[a("div",Ke,[n(A,{name:"DocumentTextIcon",class:"h-16 w-16 mx-auto text-gray-400 mb-4"}),a("h3",Qe,i(e.$t("e_invoice.no_einvoice")),1),a("p",Ze,i(e.$t("e_invoice.no_einvoice_description")),1),P.value?(o(),d(t,{key:0,variant:"primary",disabled:g.value,onClick:K},{default:s(()=>[g.value?(o(),d(W,{key:1,class:"h-5 mr-2 animate-spin"})):(o(),d(A,{key:0,name:"DocumentPlusIcon",class:"h-5 mr-2"})),T(" "+i(g.value?e.$t("e_invoice.generating"):e.$t("e_invoice.generate")),1)]),_:1},8,["disabled"])):(o(),d(S,{key:1,variant:"info",class:"mt-4"},{default:s(()=>[T(i(e.$t("e_invoice.invoice_must_be_sent")),1)]),_:1}))])]),_:1})]))])),n(He,{onSigned:h})])}}},Nt={class:"text-sm mr-3"},Vt={class:"fixed top-0 left-0 hidden h-full pt-16 pb-[6.4rem] ml-56 bg-white xl:ml-64 w-88 xl:block"},Ft={class:"flex items-center justify-between px-4 pt-8 pb-2 border border-gray-200 border-solid height-full"},Lt={class:"mb-6"},Pt={class:"flex mb-6 ml-3",role:"group","aria-label":"First group"},Gt={class:"px-2 py-1 pb-2 mb-1 mb-2 text-sm border-b border-gray-200 border-solid"},Rt={class:"flex-2"},Ut={class:"mt-1 mb-2 text-xs not-italic font-medium leading-5 text-gray-600"},zt={class:"flex-1 whitespace-nowrap right"},jt={class:"text-sm not-italic font-normal leading-5 text-right text-gray-600 est-date"},qt={key:0,class:"flex justify-center p-4 items-center"},Yt={key:1,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},Ht={class:"flex flex-col min-h-0 overflow-hidden",style:{height:"75vh"}},Ot=["src"],Zt={__name:"View",setup(j){const L=oe(),m=De(),N=Te(),b=_e(),V=Me(),{t:I}=ee.useI18n(),l=D(null),g=ve(),M=D(!1),_=D(!1),c=D(!1),x=D(null),P=D(1),q=D(1),$=D(null),v=ue({orderBy:null,orderByField:null,searchText:null}),X=B(()=>l.value.invoice_number),F=B(()=>v.orderBy==="asc"||v.orderBy==null);B(()=>F.value?I("general.ascending"):I("general.descending"));const K=B(()=>`/invoices/pdf/${l.value.unique_hash}`);B(()=>l.value&&l.value.id?invoice.value.id:null),Z(g,(t,S)=>{t.name==="invoices.view"&&J()});async function R(){b.openDialog({title:I("general.are_you_sure"),message:I("invoices.invoice_mark_as_sent"),yesLabel:I("general.ok"),noLabel:I("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(async t=>{M.value=!1,t&&(await m.markAsSent({id:l.value.id,status:"SENT"}),l.value.status="SENT",M.value=!0),M.value=!1})}async function h(t){L.openModal({title:I("invoices.send_invoice"),componentName:"SendInvoiceModal",id:l.value.id,data:l.value})}async function f(){c.value=!0;try{await m.initiateCpayCheckout(l.value.id)}catch(t){console.error("CPAY checkout error:",t)}finally{c.value=!1}}function U(t){return g.params.id==t}async function G(t,S=!1){if(_.value)return;let E={};v.searchText!==""&&v.searchText!==null&&v.searchText!==void 0&&(E.search=v.searchText),v.orderBy!==null&&v.orderBy!==void 0&&(E.orderBy=v.orderBy),v.orderByField!==null&&v.orderByField!==void 0&&(E.orderByField=v.orderByField),_.value=!0;let Y=await m.fetchInvoices({page:t,...E});_.value=!1,x.value=x.value?x.value:[],x.value=[...x.value,...Y.data.data],P.value=t||1,q.value=Y.data.meta.last_page;let H=x.value.find(w=>w.id==g.params.id);S==!1&&!H&&P.value<q.value&&Object.keys(E).length===0&&G(++P.value),H&&setTimeout(()=>{S==!1&&O()},500)}function O(){const t=document.getElementById(`invoice-${g.params.id}`);t&&(t.scrollIntoView({behavior:"smooth"}),t.classList.add("shake"),z())}function z(){$.value.addEventListener("scroll",t=>{t.target.scrollTop>0&&t.target.scrollTop+t.target.clientHeight>t.target.scrollHeight-200&&P.value<q.value&&G(++P.value,!0)})}async function J(){let t=await m.fetchInvoice(g.params.id);t.data&&(l.value={...t.data.data})}async function e(){x.value=[],G()}function u(){return v.orderBy==="asc"?(v.orderBy="desc",e(),!0):(v.orderBy="asc",e(),!0)}function A(){let t=x.value.findIndex(S=>S.id===l.value.id);x.value[t]&&(x.value[t].status="SENT",l.value.status="SENT")}return G(),J(),e=Ae.debounce(e,500),(t,S)=>{const E=r("BaseButton"),Y=r("router-link"),H=r("BasePageHeader"),w=r("BaseIcon"),ie=r("BaseInput"),te=r("BaseRadio"),ae=r("BaseInputGroup"),se=r("BaseDropdownItem"),ye=r("BaseDropdown"),ge=r("BaseText"),he=r("BaseInvoiceStatusLabel"),be=r("BaseEstimateStatusBadge"),Be=r("BaseFormatMoney"),le=r("BaseTab"),Ie=r("BaseTabGroup"),xe=r("BaseCard"),$e=r("BasePage");return o(),C(ne,null,[n(Ve,{onUpdate:A}),l.value?(o(),d($e,{key:0,class:"xl:pl-96 xl:ml-8"},{default:s(()=>{var re;return[n(H,{title:X.value},{actions:s(()=>{var y;return[a("div",Nt,[l.value.status==="DRAFT"&&k(N).hasAbilities(k(Q).EDIT_INVOICE)?(o(),d(E,{key:0,disabled:M.value,variant:"primary-outline",onClick:R},{default:s(()=>[T(i(t.$t("invoices.mark_as_sent")),1)]),_:1},8,["disabled"])):p("",!0)]),l.value.status==="DRAFT"&&k(N).hasAbilities(k(Q).SEND_INVOICE)?(o(),d(E,{key:0,variant:"primary",class:"text-sm",onClick:h},{default:s(()=>[T(i(t.$t("invoices.send_invoice")),1)]),_:1})):p("",!0),(l.value.status==="SENT"||l.value.status==="VIEWED")&&l.value.status!=="PAID"&&k(N).hasAbilities(k(Q).CREATE_PAYMENT)&&((y=k(V).featureFlags)==null?void 0:y.advanced_payments)===!0?(o(),d(E,{key:1,variant:"primary",class:"mr-3",disabled:c.value,onClick:f},{default:s(()=>[c.value?(o(),d(W,{key:0,class:"h-5 w-5 mr-2 animate-spin"})):p("",!0),T(" "+i(c.value?t.$t("payments.cpay.processing"):t.$t("payments.cpay.pay_now")),1)]),_:1},8,["disabled"])):p("",!0),k(N).hasAbilities(k(Q).CREATE_PAYMENT)?(o(),d(Y,{key:2,to:`/admin/payments/${t.$route.params.id}/create`},{default:s(()=>[l.value.status==="SENT"||l.value.status==="VIEWED"?(o(),d(E,{key:0,variant:"primary"},{default:s(()=>[T(i(t.$t("invoices.record_payment")),1)]),_:1})):p("",!0)]),_:1},8,["to"])):p("",!0),n(Fe,{class:"ml-3",row:l.value,"load-data":G},null,8,["row"])]}),_:1},8,["title"]),a("div",Vt,[a("div",Ft,[a("div",Lt,[n(ie,{modelValue:v.searchText,"onUpdate:modelValue":S[0]||(S[0]=y=>v.searchText=y),placeholder:t.$t("general.search"),type:"text",variant:"gray",onInput:S[1]||(S[1]=y=>e())},{right:s(()=>[n(w,{name:"MagnifyingGlassIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"])]),a("div",Pt,[n(ye,{class:"ml-3",position:"bottom-start"},{activator:s(()=>[n(E,{size:"md",variant:"gray"},{default:s(()=>[n(w,{name:"FunnelIcon"})]),_:1})]),default:s(()=>[a("div",Gt,i(t.$t("general.sort_by")),1),n(se,{class:"flex px-1 py-2 cursor-pointer"},{default:s(()=>[n(ae,{class:"-mt-3 font-normal"},{default:s(()=>[n(te,{id:"filter_invoice_date",modelValue:v.orderByField,"onUpdate:modelValue":[S[2]||(S[2]=y=>v.orderByField=y),e],label:t.$t("reports.invoices.invoice_date"),size:"sm",name:"filter",value:"invoice_date"},null,8,["modelValue","label"])]),_:1})]),_:1}),n(se,{class:"flex px-1 py-2 cursor-pointer"},{default:s(()=>[n(ae,{class:"-mt-3 font-normal"},{default:s(()=>[n(te,{id:"filter_due_date",modelValue:v.orderByField,"onUpdate:modelValue":[S[3]||(S[3]=y=>v.orderByField=y),e],label:t.$t("invoices.due_date"),value:"due_date",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1}),n(se,{class:"flex px-1 py-2 cursor-pointer"},{default:s(()=>[n(ae,{class:"-mt-3 font-normal"},{default:s(()=>[n(te,{id:"filter_invoice_number",modelValue:v.orderByField,"onUpdate:modelValue":[S[4]||(S[4]=y=>v.orderByField=y),e],label:t.$t("invoices.invoice_number"),value:"invoice_number",size:"sm",name:"filter"},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),n(E,{class:"ml-1",size:"md",variant:"gray",onClick:u},{default:s(()=>[F.value?(o(),d(w,{key:0,name:"BarsArrowUpIcon"})):(o(),d(w,{key:1,name:"BarsArrowDownIcon"}))]),_:1})])]),a("div",{ref_key:"invoiceListSection",ref:$,class:"h-full overflow-y-scroll border-l border-gray-200 border-solid base-scroll"},[(o(!0),C(ne,null,pe(x.value,(y,Se)=>(o(),C("div",{key:Se},[y?(o(),d(Y,{key:0,id:"invoice-"+y.id,to:`/admin/invoices/${y.id}/view`,class:Ne(["flex justify-between side-invoice p-4 cursor-pointer hover:bg-gray-100 items-center border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":U(y.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:s(()=>[a("div",Rt,[n(ge,{text:y.customer.name,class:"pr-2 mb-2 text-sm not-italic font-normal leading-5 text-black capitalize truncate"},null,8,["text"]),a("div",Ut,i(y.invoice_number),1),n(be,{status:y.status,class:"px-1 text-xs"},{default:s(()=>[n(he,{status:y.status},null,8,["status"])]),_:2},1032,["status"])]),a("div",zt,[n(Be,{class:"mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900 block",amount:y.total,currency:y.customer.currency},null,8,["amount","currency"]),a("div",jt,i(y.formatted_invoice_date),1)])]),_:2},1032,["id","to","class"])):p("",!0)]))),128)),_.value?(o(),C("div",qt,[n(W,{class:"h-6 m-1 animate-spin text-primary-400"})])):p("",!0),!((re=x.value)!=null&&re.length)&&!_.value?(o(),C("p",Yt,i(t.$t("invoices.no_matching_invoices")),1)):p("",!0)],512)]),n(xe,{class:"mt-8"},{default:s(()=>[n(Ie,null,{default:s(()=>[n(le,{"tab-panel-container":"py-4 mt-px",title:t.$t("invoices.details")},{default:s(()=>[a("div",Ht,[a("iframe",{src:`${K.value}`,class:"flex-1 border border-gray-400 border-solid bg-white rounded-md frame-style"},null,8,Ot)])]),_:1},8,["title"]),n(le,{"tab-panel-container":"py-4 mt-px",title:t.$t("e_invoice.title")},{default:s(()=>[n(At,{invoice:l.value},null,8,["invoice"])]),_:1},8,["title"])]),_:1})]),_:1})]}),_:1})):p("",!0)],64)}}};export{Zt as default};
