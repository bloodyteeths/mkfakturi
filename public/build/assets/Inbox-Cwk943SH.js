import{a6 as M,s as q,a3 as z,v as A,k as H,K as v,w as t,r as o,n as N,o as h,a,c as R,l as u,q as c,t as r,M as V}from"./main-DpDYmbyp.js";import{u as j}from"./bills-CCdNmJ3C.js";const G=(g=!1)=>(g?window.pinia.defineStore:M)({id:"billsInbox",state:()=>({drafts:[],totalDrafts:0,isFetching:!1}),actions:{fetchDraftBills(i={}){this.isFetching=!0;const m={...i,status:"DRAFT"};return new Promise((_,B)=>{q.get("/bills",{params:m}).then(n=>{var b,p;this.drafts=n.data.data,this.totalDrafts=((b=n.data.meta)==null?void 0:b.bill_total_count)??((p=n.data.meta)==null?void 0:p.total)??this.drafts.length,this.isFetching=!1,_(n)}).catch(n=>{this.isFetching=!1,z(n),B(n)})})}}})(),K={key:1,class:"relative table-container"},O={__name:"Inbox",setup(g){const{t:d}=A.useI18n(),i=G(),m=j(),_=N(),B=[{key:"bill_date",label:d("bills.bill_date")},{key:"bill_number",label:d("bills.bill_number")},{key:"supplier",label:d("bills.supplier")},{key:"total",label:d("bills.total")},{key:"actions",label:"",sortable:!1,tdClass:"text-right"}];function n(e){const k={page:(e==null?void 0:e.page)??1,limit:(e==null?void 0:e.limit)??10};i.fetchDraftBills(k)}function b(e){_.push(`/admin/bills/${e}/view`)}function p(e){m.markAsCompleted(e).then(()=>{n({page:1,limit:10})})}function $(e){m.deleteBills([e]).then(()=>{n({page:1,limit:10})})}function D(e){_.push(`/admin/expenses/create?source=bill&bill_id=${e}`)}return H(()=>{n({page:1,limit:10})}),(e,k)=>{const y=o("BaseBreadcrumbItem"),C=o("BaseBreadcrumb"),F=o("BasePageHeader"),x=o("BaseEmptyPlaceholder"),I=o("router-link"),S=o("BaseFormatMoney"),w=o("BaseButton"),f=o("BaseDropdownItem"),P=o("BaseDropdown"),E=o("BaseTable"),T=o("BasePage");return h(),v(T,null,{default:t(()=>[a(F,{title:e.$t("bills.inbox_title")},{default:t(()=>[a(C,null,{default:t(()=>[a(y,{title:e.$t("general.home"),to:"dashboard"},null,8,["title"]),a(y,{title:e.$t("bills.inbox_title"),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),!u(i).totalDrafts&&!u(i).isFetching?(h(),v(x,{key:0,title:e.$t("bills.inbox_empty"),description:e.$t("bills.inbox_empty_description")},null,8,["title","description"])):(h(),R("div",K,[a(E,{data:u(i).drafts,columns:B,meta:{total:u(i).totalDrafts},loading:u(i).isFetching,onGetData:n},{"cell-bill_date":t(({row:l})=>[c(r(l.data.formatted_bill_date),1)]),"cell-bill_number":t(({row:l})=>[a(I,{to:{path:`/admin/bills/${l.data.id}/view`},class:"font-medium text-primary-500"},{default:t(()=>[c(r(l.data.bill_number),1)]),_:2},1032,["to"])]),"cell-supplier":t(({row:l})=>{var s;return[c(r(((s=l.data.supplier)==null?void 0:s.name)||"-"),1)]}),"cell-total":t(({row:l})=>[a(S,{amount:l.data.total,currency:l.data.currency},null,8,["amount","currency"])]),"cell-actions":t(({row:l})=>[a(P,null,{button:t(s=>[a(w,{variant:"tertiary",size:"xs",class:V(s.class)},{default:t(()=>[c(r(e.$t("general.actions")),1)]),_:2},1032,["class"])]),default:t(()=>[a(f,{onClick:s=>b(l.data.id)},{default:t(()=>[c(r(e.$t("general.view")),1)]),_:2},1032,["onClick"]),a(f,{onClick:s=>p(l.data.id)},{default:t(()=>[c(r(e.$t("bills.approve")),1)]),_:2},1032,["onClick"]),a(f,{onClick:s=>D(l.data.id)},{default:t(()=>[c(r(e.$t("bills.convert_to_expense")),1)]),_:2},1032,["onClick"]),a(f,{onClick:s=>$(l.data.id)},{default:t(()=>[c(r(e.$t("general.delete")),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["data","meta","loading"])]))]),_:1})}}};export{O as default};
