import{u as T,e as I,k as R,K as x,w as c,bA as E,n as L,o,a as l,c as i,bB as U,L as g,l as a,ar as f,q as u,bF as y,b as t,aq as V,at as _,t as m,Q as v,R as w,aw as b,m as j,M as O}from"./main-Ds_umSNN.js";import{u as Y}from"./console-B5ycCkMY.js";const q={key:0,class:"text-center py-12"},H={key:1,class:"space-y-8"},K={class:"flex items-center justify-between mb-4"},Q={class:"flex items-center space-x-3"},W={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},G={class:"p-6"},J={class:"flex items-center space-x-3 mb-4"},X=["src","alt"],Z={key:1,class:"h-12 w-12 rounded-lg bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center"},ee={class:"flex-1 min-w-0"},te={class:"font-semibold text-gray-900 truncate"},se={class:"text-sm text-blue-600 font-medium"},oe={key:0,class:"text-sm text-gray-600 mb-3"},ne={class:"flex justify-between items-center pt-3 border-t border-gray-100"},ae={class:"text-sm text-gray-500"},ie={class:"flex gap-2"},re={key:1,class:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"},le={key:0},de={class:"flex items-center justify-between mb-4"},ce={class:"flex items-center space-x-3"},me={key:0,class:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6"},ue={class:"p-6"},ge={class:"flex items-center space-x-3 mb-4"},ye=["src","alt"],xe={key:1,class:"h-12 w-12 rounded-lg bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center"},fe={class:"flex-1 min-w-0"},pe={class:"font-semibold text-gray-900 truncate"},_e={class:"mb-3 space-y-2"},he={class:"flex justify-between items-center text-sm"},ve={class:"font-semibold text-orange-600"},we={class:"flex justify-between items-center text-sm"},be={class:"pt-3 border-t border-gray-100"},ke={key:1,class:"text-center py-12 bg-orange-50 rounded-lg border-2 border-dashed border-orange-300"},Ce={key:1},Se={class:"flex items-center justify-between mb-4"},Ne={class:"flex items-center space-x-3"},$e={key:0,class:"space-y-4"},Ie={class:"p-6"},je={class:"flex items-start justify-between"},ze={class:"flex-1"},Pe={class:"flex items-center space-x-3 mb-3"},De={class:"h-12 w-12 rounded-lg bg-gradient-to-br from-yellow-400 to-yellow-600 flex items-center justify-center"},Fe={class:"font-semibold text-gray-900"},Me={class:"text-sm text-gray-600"},Ae={class:"mb-3 space-y-2"},Be={class:"text-sm text-gray-600"},Te={key:0,class:"text-sm"},Re={key:0,class:"ml-2 text-xs text-red-600 font-semibold uppercase"},Ee={key:0,class:"mb-4"},Le={class:"flex flex-wrap gap-1 mt-2"},Ue={class:"flex flex-col gap-2 ml-4"},Ve={key:1,class:"text-center py-12 bg-yellow-50 rounded-lg border-2 border-dashed border-yellow-300"},Oe={key:2,class:"text-center py-16"},Ke={__name:"ConsoleHome",setup(Ye){const r=Y(),z=L(),p=T(),P=I(!1),h=I(null);R(async()=>{await r.fetchCompanies()});const k=async n=>{try{await r.switchCompany(n.id),window.location.href="/admin/dashboard"}catch(e){console.error("Failed to switch company:",e),p.showNotification({type:"error",message:"Failed to switch company. Please try again."})}},D=n=>{z.push({name:"partner.commissions",query:{company_id:n.id}})},C=async(n,e)=>{var s,d;h.value=n;try{await r.respondToInvitation(n,e),p.showNotification({type:"success",message:e==="accept"?"Invitation accepted successfully! You now have access to this company.":"Invitation declined."})}catch($){console.error("Failed to respond to invitation:",$),p.showNotification({type:"error",message:((d=(s=$.response)==null?void 0:s.data)==null?void 0:d.message)||"Failed to process invitation response."})}finally{h.value=null}},F=async n=>{var e,s;if(confirm(`Are you sure you want to remove access to "${n.name}"? The company can re-invite you later if needed.`))try{await axios.delete(`/invitations/companies/${n.id}/unlink`),p.showNotification({type:"success",message:"Successfully removed access to company"}),await r.fetchCompanies()}catch(d){console.error("Failed to unlink company:",d),p.showNotification({type:"error",message:((s=(e=d.response)==null?void 0:e.data)==null?void 0:s.message)||"Failed to remove company access"})}},M=n=>{try{const e=typeof n=="string"?JSON.parse(n):n;return Array.isArray(e)?e:[]}catch{return[]}},A=n=>{if(!n)return 0;try{const e=typeof n=="string"?JSON.parse(n):n;return Array.isArray(e)?e.length:0}catch{return 0}},S=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",B=n=>n?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(n/100):"$0.00",N=n=>{if(!n)return!1;const e=new Date(n),d=Math.ceil((e-new Date)/(1e3*60*60*24));return d<=3&&d>=0};return(n,e)=>(o(),x(E,null,{default:c(()=>[l(U,{title:"Partner Console"},{actions:c(()=>[a(r).hasMultipleCompanies?(o(),x(f,{key:0,variant:"white",onClick:e[0]||(e[0]=s=>P.value=!0)},{left:c(()=>[l(a(y),{class:"h-5 w-5"})]),default:c(()=>[e[1]||(e[1]=u(" Switch Company ",-1))]),_:1,__:[1]})):g("",!0)]),_:1}),a(r).isLoading?(o(),i("div",q,[l(V,{class:"mx-auto"}),e[2]||(e[2]=t("p",{class:"mt-2 text-sm text-gray-500"},"Loading companies...",-1))])):(o(),i("div",H,[t("section",null,[t("div",K,[t("div",Q,[e[3]||(e[3]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Companies I Manage",-1)),l(_,{variant:"primary",size:"sm"},{default:c(()=>[u(m(a(r).totalManaged),1)]),_:1})])]),a(r).managedCompanies.length>0?(o(),i("div",W,[(o(!0),i(v,null,w(a(r).managedCompanies,s=>(o(),x(b,{key:s.id,class:"cursor-pointer hover:shadow-lg transition-all duration-200 border-l-4 border-l-blue-500",onClick:d=>k(s)},{default:c(()=>[t("div",G,[t("div",J,[s.logo?(o(),i("img",{key:0,src:s.logo,alt:s.name,class:"h-12 w-12 rounded-lg object-cover"},null,8,X)):(o(),i("div",Z,[l(a(y),{class:"h-6 w-6 text-white"})])),t("div",ee,[t("h3",te,m(s.name),1),t("p",se,m(s.commission_rate||0)+"% commission ",1)]),s.is_primary?(o(),x(_,{key:2,variant:"success",size:"sm"},{default:c(()=>e[4]||(e[4]=[u(" Primary ",-1)])),_:1,__:[4]})):g("",!0)]),s.address?(o(),i("div",oe,m(s.address.city)+", "+m(s.address.country),1)):g("",!0),t("div",ne,[t("span",ae,m(A(s.permissions))+" permissions ",1),t("div",ie,[l(f,{size:"sm",variant:"danger-outline",onClick:j(d=>F(s),["stop"])},{default:c(()=>e[5]||(e[5]=[u(" Delete ",-1)])),_:2,__:[5]},1032,["onClick"]),l(f,{size:"sm",variant:"primary",onClick:j(d=>k(s),["stop"])},{default:c(()=>e[6]||(e[6]=[u(" Manage ",-1)])),_:2,__:[6]},1032,["onClick"])])])])]),_:2},1032,["onClick"]))),128))])):(o(),i("div",re,[l(a(y),{class:"mx-auto h-12 w-12 text-gray-400"}),e[7]||(e[7]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No companies assigned",-1)),e[8]||(e[8]=t("p",{class:"mt-1 text-sm text-gray-500"}," You don't have management access to any companies yet. ",-1))]))]),a(r).referredCompanies.length>0||a(r).totalReferred>0?(o(),i("section",le,[t("div",de,[t("div",ce,[e[9]||(e[9]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Companies I Referred",-1)),l(_,{variant:"warning",size:"sm"},{default:c(()=>[u(m(a(r).totalReferred),1)]),_:1})])]),a(r).referredCompanies.length>0?(o(),i("div",me,[(o(!0),i(v,null,w(a(r).referredCompanies,s=>(o(),x(b,{key:s.id,class:"border-l-4 border-l-orange-500 hover:shadow-md transition-shadow duration-200"},{default:c(()=>[t("div",ue,[t("div",ge,[s.logo?(o(),i("img",{key:0,src:s.logo,alt:s.name,class:"h-12 w-12 rounded-lg object-cover"},null,8,ye)):(o(),i("div",xe,[l(a(y),{class:"h-6 w-6 text-white"})])),t("div",fe,[t("h3",pe,m(s.name),1),e[10]||(e[10]=t("p",{class:"text-xs text-gray-500 uppercase tracking-wide"},"Referral Only",-1))])]),t("div",_e,[t("div",he,[e[11]||(e[11]=t("span",{class:"text-gray-600"},"Total Commissions:",-1)),t("span",ve,m(B(s.total_commissions||0)),1)]),t("div",we,[e[12]||(e[12]=t("span",{class:"text-gray-600"},"Status:",-1)),l(_,{variant:s.subscription_status==="active"?"success":"default",size:"sm"},{default:c(()=>[u(m(s.subscription_status||"Unknown"),1)]),_:2},1032,["variant"])])]),t("div",be,[l(f,{size:"sm",variant:"warning-outline",class:"w-full",onClick:d=>D(s)},{default:c(()=>e[13]||(e[13]=[u(" View Commissions ",-1)])),_:2,__:[13]},1032,["onClick"])])])]),_:2},1024))),128))])):(o(),i("div",ke,[l(a(y),{class:"mx-auto h-12 w-12 text-orange-400"}),e[14]||(e[14]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No referral tracking yet",-1)),e[15]||(e[15]=t("p",{class:"mt-1 text-sm text-gray-500"}," Companies you refer will appear here for commission tracking. ",-1))]))])):g("",!0),a(r).pendingInvitations.length>0||a(r).totalPending>0?(o(),i("section",Ce,[t("div",Se,[t("div",Ne,[e[16]||(e[16]=t("h2",{class:"text-xl font-semibold text-gray-900"},"Pending Invitations",-1)),l(_,{variant:"danger",size:"sm"},{default:c(()=>[u(m(a(r).totalPending),1)]),_:1})])]),a(r).pendingInvitations.length>0?(o(),i("div",$e,[(o(!0),i(v,null,w(a(r).pendingInvitations,s=>(o(),x(b,{key:s.id,class:"border-l-4 border-l-yellow-500 hover:shadow-md transition-shadow duration-200"},{default:c(()=>[t("div",Ie,[t("div",je,[t("div",ze,[t("div",Pe,[t("div",De,[l(a(y),{class:"h-6 w-6 text-white"})]),t("div",null,[t("h3",Fe,m(s.company_name),1),t("p",Me," Invited by "+m(s.inviter_name||"Company Admin"),1)])]),t("div",Ae,[t("div",Be,[e[17]||(e[17]=t("span",{class:"font-medium"},"Invited:",-1)),u(" "+m(S(s.invited_at)),1)]),s.expires_at?(o(),i("div",Te,[e[18]||(e[18]=t("span",{class:"font-medium text-gray-600"},"Expires:",-1)),t("span",{class:O(N(s.expires_at)?"text-red-600 font-semibold":"text-gray-600")},m(S(s.expires_at)),3),N(s.expires_at)?(o(),i("span",Re," Expiring Soon! ")):g("",!0)])):g("",!0)]),s.permissions?(o(),i("div",Ee,[e[19]||(e[19]=t("span",{class:"text-xs font-medium text-gray-700 uppercase tracking-wide"},"Permissions Offered:",-1)),t("div",Le,[(o(!0),i(v,null,w(M(s.permissions),d=>(o(),i("span",{key:d,class:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-md"},m(d),1))),128))])])):g("",!0)]),t("div",Ue,[l(f,{variant:"primary",size:"sm",onClick:d=>C(s.id,"accept"),loading:h.value===s.id},{default:c(()=>e[20]||(e[20]=[u(" Accept ",-1)])),_:2,__:[20]},1032,["onClick","loading"]),l(f,{variant:"danger-outline",size:"sm",onClick:d=>C(s.id,"decline"),loading:h.value===s.id},{default:c(()=>e[21]||(e[21]=[u(" Decline ",-1)])),_:2,__:[21]},1032,["onClick","loading"])])])])]),_:2},1024))),128))])):(o(),i("div",Ve,[l(a(y),{class:"mx-auto h-12 w-12 text-yellow-400"}),e[22]||(e[22]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No pending invitations",-1)),e[23]||(e[23]=t("p",{class:"mt-1 text-sm text-gray-500"}," You don't have any pending company invitations at this time. ",-1))]))])):g("",!0),a(r).managedCompanies.length===0&&a(r).referredCompanies.length===0&&a(r).pendingInvitations.length===0?(o(),i("div",Oe,[l(a(y),{class:"mx-auto h-16 w-16 text-gray-400"}),e[24]||(e[24]=t("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"Welcome to the Partner Console",-1)),e[25]||(e[25]=t("p",{class:"mt-2 text-sm text-gray-500 max-w-md mx-auto"}," You don't have any companies assigned yet. Contact your administrator to get access to company accounts or wait for company invitations. ",-1))])):g("",!0)]))]),_:1}))}};export{Ke as default};
